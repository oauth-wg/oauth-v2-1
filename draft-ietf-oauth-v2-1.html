<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The OAuth 2.1 Authorization Framework</title>
<meta content="Dick Hardt" name="author">
<meta content="Aaron Parecki" name="author">
<meta content="Torsten Lodderstedt" name="author">
<meta content="
       The OAuth 2.1 authorization framework enables an
application to obtain limited access to a protected resource, either on
behalf of a resource owner by orchestrating an approval interaction
between the resource owner and an authorization service, or by allowing the
application to obtain access on its own behalf.  This
specification replaces and obsoletes the OAuth 2.0 Authorization
Framework described in RFC 6749 and the Bearer Token Usage in RFC 6750. 
    " name="description">
<meta content="xml2rfc 3.19.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-oauth-v2-1-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.19.0
    Python 3.11.6
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 4.1.0
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 68.2.2
    six 1.16.0
    wcwidth 0.2.12
-->
<link href="draft-ietf-oauth-v2-1.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">The OAuth 2.1 Authorization Framework</td>
<td class="right">January 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hardt, et al.</td>
<td class="center">Expires 12 July 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">OAuth Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-oauth-v2-1-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-01-09" class="published">9 January 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-07-12">12 July 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Hardt</div>
<div class="org">Hellō</div>
</div>
<div class="author">
      <div class="author-name">A. Parecki</div>
<div class="org">Okta</div>
</div>
<div class="author">
      <div class="author-name">T. Lodderstedt</div>
<div class="org">yes.com</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The OAuth 2.1 Authorization Framework</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The OAuth 2.1 authorization framework enables an
application to obtain limited access to a protected resource, either on
behalf of a resource owner by orchestrating an approval interaction
between the resource owner and an authorization service, or by allowing the
application to obtain access on its own behalf.  This
specification replaces and obsoletes the OAuth 2.0 Authorization
Framework described in RFC 6749 and the Bearer Token Usage in RFC 6750.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    OAuth Working Group mailing list (oauth@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/oauth/">https://mailarchive.ietf.org/arch/browse/oauth/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/oauth-wg/oauth-v2-1">https://github.com/oauth-wg/oauth-v2-1</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 12 July 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-roles" class="internal xref">Roles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-protocol-flow" class="internal xref">Protocol Flow</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-authorization-grant" class="internal xref">Authorization Grant</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3.2.1">
                    <p id="section-toc.1-1.1.2.3.2.1.1" class="keepWithNext"><a href="#section-1.3.1" class="auto internal xref">1.3.1</a>.  <a href="#name-authorization-code" class="internal xref">Authorization Code</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3.2.2">
                    <p id="section-toc.1-1.1.2.3.2.2.1"><a href="#section-1.3.2" class="auto internal xref">1.3.2</a>.  <a href="#name-refresh-token" class="internal xref">Refresh Token</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3.2.3">
                    <p id="section-toc.1-1.1.2.3.2.3.1"><a href="#section-1.3.3" class="auto internal xref">1.3.3</a>.  <a href="#name-client-credentials" class="internal xref">Client Credentials</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-access-token" class="internal xref">Access Token</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.1">
                    <p id="section-toc.1-1.1.2.4.2.1.1"><a href="#section-1.4.1" class="auto internal xref">1.4.1</a>.  <a href="#name-access-token-scope" class="internal xref">Access Token Scope</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.2">
                    <p id="section-toc.1-1.1.2.4.2.2.1"><a href="#section-1.4.2" class="auto internal xref">1.4.2</a>.  <a href="#name-bearer-tokens" class="internal xref">Bearer Tokens</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.3">
                    <p id="section-toc.1-1.1.2.4.2.3.1"><a href="#section-1.4.3" class="auto internal xref">1.4.3</a>.  <a href="#name-sender-constrained-access-t" class="internal xref">Sender-Constrained Access Tokens</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="auto internal xref">1.5</a>.  <a href="#name-communication-security" class="internal xref">Communication security</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6">
                <p id="section-toc.1-1.1.2.6.1"><a href="#section-1.6" class="auto internal xref">1.6</a>.  <a href="#name-http-redirections" class="internal xref">HTTP Redirections</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.7">
                <p id="section-toc.1-1.1.2.7.1"><a href="#section-1.7" class="auto internal xref">1.7</a>.  <a href="#name-interoperability" class="internal xref">Interoperability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.8">
                <p id="section-toc.1-1.1.2.8.1"><a href="#section-1.8" class="auto internal xref">1.8</a>.  <a href="#name-compatibility-with-oauth-20" class="internal xref">Compatibility with OAuth 2.0</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.9">
                <p id="section-toc.1-1.1.2.9.1"><a href="#section-1.9" class="auto internal xref">1.9</a>.  <a href="#name-notational-conventions" class="internal xref">Notational Conventions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-client-registration" class="internal xref">Client Registration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-client-types" class="internal xref">Client Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-client-identifier" class="internal xref">Client Identifier</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-client-redirection-endpoint" class="internal xref">Client Redirection Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="auto internal xref">2.3.1</a>.  <a href="#name-registration-requirements" class="internal xref">Registration Requirements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="auto internal xref">2.3.2</a>.  <a href="#name-multiple-redirect-uris" class="internal xref">Multiple Redirect URIs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.3">
                    <p id="section-toc.1-1.2.2.3.2.3.1"><a href="#section-2.3.3" class="auto internal xref">2.3.3</a>.  <a href="#name-preventing-csrf-attacks" class="internal xref">Preventing CSRF Attacks</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.4">
                    <p id="section-toc.1-1.2.2.3.2.4.1"><a href="#section-2.3.4" class="auto internal xref">2.3.4</a>.  <a href="#name-preventing-mix-up-attacks" class="internal xref">Preventing Mix-Up Attacks</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.5">
                    <p id="section-toc.1-1.2.2.3.2.5.1"><a href="#section-2.3.5" class="auto internal xref">2.3.5</a>.  <a href="#name-invalid-endpoint" class="internal xref">Invalid Endpoint</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.6">
                    <p id="section-toc.1-1.2.2.3.2.6.1"><a href="#section-2.3.6" class="auto internal xref">2.3.6</a>.  <a href="#name-endpoint-content" class="internal xref">Endpoint Content</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-client-authentication" class="internal xref">Client Authentication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.1">
                    <p id="section-toc.1-1.2.2.4.2.1.1"><a href="#section-2.4.1" class="auto internal xref">2.4.1</a>.  <a href="#name-client-secret" class="internal xref">Client Secret</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.2">
                    <p id="section-toc.1-1.2.2.4.2.2.1"><a href="#section-2.4.2" class="auto internal xref">2.4.2</a>.  <a href="#name-other-authentication-method" class="internal xref">Other Authentication Methods</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="auto internal xref">2.5</a>.  <a href="#name-unregistered-clients" class="internal xref">Unregistered Clients</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-protocol-endpoints" class="internal xref">Protocol Endpoints</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-authorization-endpoint" class="internal xref">Authorization Endpoint</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-token-endpoint" class="internal xref">Token Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-client-authentication-2" class="internal xref">Client Authentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-token-request" class="internal xref">Token Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="auto internal xref">3.2.3</a>.  <a href="#name-token-response" class="internal xref">Token Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.4">
                    <p id="section-toc.1-1.3.2.2.2.4.1"><a href="#section-3.2.4" class="auto internal xref">3.2.4</a>.  <a href="#name-error-response" class="internal xref">Error Response</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-grant-types" class="internal xref">Grant Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-authorization-code-grant" class="internal xref">Authorization Code Grant</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-authorization-request" class="internal xref">Authorization Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-authorization-response" class="internal xref">Authorization Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="auto internal xref">4.1.3</a>.  <a href="#name-token-endpoint-extension" class="internal xref">Token Endpoint Extension</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-client-credentials-grant" class="internal xref">Client Credentials Grant</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-token-endpoint-extension-2" class="internal xref">Token Endpoint Extension</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-refresh-token-grant" class="internal xref">Refresh Token Grant</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-token-endpoint-extension-3" class="internal xref">Token Endpoint Extension</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="auto internal xref">4.3.2</a>.  <a href="#name-refresh-token-response" class="internal xref">Refresh Token Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a href="#section-4.3.3" class="auto internal xref">4.3.3</a>.  <a href="#name-refresh-token-recommendatio" class="internal xref">Refresh Token Recommendations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-extension-grants" class="internal xref">Extension Grants</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-resource-requests" class="internal xref">Resource Requests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-bearer-token-requests" class="internal xref">Bearer Token Requests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-authorization-request-heade" class="internal xref">Authorization Request Header Field</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-form-encoded-content-parame" class="internal xref">Form-Encoded Content Parameter</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-access-token-validation" class="internal xref">Access Token Validation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-error-response-3" class="internal xref">Error Response</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="auto internal xref">5.3.1</a>.  <a href="#name-the-www-authenticate-respon" class="internal xref">The WWW-Authenticate Response Header Field</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="auto internal xref">5.3.2</a>.  <a href="#name-error-codes" class="internal xref">Error Codes</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-extensibility" class="internal xref">Extensibility</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-defining-access-token-types" class="internal xref">Defining Access Token Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-registered-access-token-typ" class="internal xref">Registered Access Token Types</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-vendor-specific-access-toke" class="internal xref">Vendor-Specific Access Token Types</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-defining-new-endpoint-param" class="internal xref">Defining New Endpoint Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-defining-new-authorization-" class="internal xref">Defining New Authorization Grant Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-defining-new-authorization-e" class="internal xref">Defining New Authorization Endpoint Response Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-defining-additional-error-c" class="internal xref">Defining Additional Error Codes</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-access-token-security-consi" class="internal xref">Access Token Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="auto internal xref">7.1.1</a>.  <a href="#name-security-threats" class="internal xref">Security Threats</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.2">
                    <p id="section-toc.1-1.7.2.1.2.2.1"><a href="#section-7.1.2" class="auto internal xref">7.1.2</a>.  <a href="#name-threat-mitigation" class="internal xref">Threat Mitigation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.3">
                    <p id="section-toc.1-1.7.2.1.2.3.1"><a href="#section-7.1.3" class="auto internal xref">7.1.3</a>.  <a href="#name-summary-of-recommendations" class="internal xref">Summary of Recommendations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.4">
                    <p id="section-toc.1-1.7.2.1.2.4.1"><a href="#section-7.1.4" class="auto internal xref">7.1.4</a>.  <a href="#name-access-token-privilege-rest" class="internal xref">Access Token Privilege Restriction</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-client-authentication-3" class="internal xref">Client Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-client-impersonation" class="internal xref">Client Impersonation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="auto internal xref">7.3.1</a>.  <a href="#name-impersonation-of-native-app" class="internal xref">Impersonation of Native Apps</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="auto internal xref">7.3.2</a>.  <a href="#name-access-token-privilege-restr" class="internal xref">Access Token Privilege Restriction</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-client-impersonating-resour" class="internal xref">Client Impersonating Resource Owner</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-authorization-code-security" class="internal xref">Authorization Code Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.1">
                    <p id="section-toc.1-1.7.2.5.2.1.1"><a href="#section-7.5.1" class="auto internal xref">7.5.1</a>.  <a href="#name-authorization-code-injectio" class="internal xref">Authorization Code Injection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.2">
                    <p id="section-toc.1-1.7.2.5.2.2.1"><a href="#section-7.5.2" class="auto internal xref">7.5.2</a>.  <a href="#name-countermeasures" class="internal xref">Countermeasures</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.3">
                    <p id="section-toc.1-1.7.2.5.2.3.1"><a href="#section-7.5.3" class="auto internal xref">7.5.3</a>.  <a href="#name-reuse-of-authorization-code" class="internal xref">Reuse of Authorization Codes</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.4">
                    <p id="section-toc.1-1.7.2.5.2.4.1"><a href="#section-7.5.4" class="auto internal xref">7.5.4</a>.  <a href="#name-http-307-redirect" class="internal xref">HTTP 307 Redirect</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-ensuring-endpoint-authentic" class="internal xref">Ensuring Endpoint Authenticity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="auto internal xref">7.7</a>.  <a href="#name-credentials-guessing-attack" class="internal xref">Credentials-Guessing Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8">
                <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="auto internal xref">7.8</a>.  <a href="#name-phishing-attacks" class="internal xref">Phishing Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.9">
                <p id="section-toc.1-1.7.2.9.1"><a href="#section-7.9" class="auto internal xref">7.9</a>.  <a href="#name-cross-site-request-forgery" class="internal xref">Cross-Site Request Forgery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.10">
                <p id="section-toc.1-1.7.2.10.1"><a href="#section-7.10" class="auto internal xref">7.10</a>. <a href="#name-clickjacking" class="internal xref">Clickjacking</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.11">
                <p id="section-toc.1-1.7.2.11.1"><a href="#section-7.11" class="auto internal xref">7.11</a>. <a href="#name-code-injection-and-input-va" class="internal xref">Code Injection and Input Validation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.12">
                <p id="section-toc.1-1.7.2.12.1"><a href="#section-7.12" class="auto internal xref">7.12</a>. <a href="#name-open-redirection" class="internal xref">Open Redirection</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.12.2.1">
                    <p id="section-toc.1-1.7.2.12.2.1.1"><a href="#section-7.12.1" class="auto internal xref">7.12.1</a>.  <a href="#name-client-as-open-redirector" class="internal xref">Client as Open Redirector</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.12.2.2">
                    <p id="section-toc.1-1.7.2.12.2.2.1"><a href="#section-7.12.2" class="auto internal xref">7.12.2</a>.  <a href="#name-authorization-server-as-ope" class="internal xref">Authorization Server as Open Redirector</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.13">
                <p id="section-toc.1-1.7.2.13.1"><a href="#section-7.13" class="auto internal xref">7.13</a>. <a href="#name-authorization-server-mix-up" class="internal xref">Authorization Server Mix-Up Mitigation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.13.2.1">
                    <p id="section-toc.1-1.7.2.13.2.1.1"><a href="#section-7.13.1" class="auto internal xref">7.13.1</a>.  <a href="#name-mix-up-defense-via-issuer-i" class="internal xref">Mix-Up Defense via Issuer Identification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.13.2.2">
                    <p id="section-toc.1-1.7.2.13.2.2.1"><a href="#section-7.13.2" class="auto internal xref">7.13.2</a>.  <a href="#name-mix-up-defense-via-distinct" class="internal xref">Mix-Up Defense via Distinct Redirect URIs</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-native-applications" class="internal xref">Native Applications</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-registration-of-native-app-" class="internal xref">Registration of Native App Clients</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a href="#section-8.1.1" class="auto internal xref">8.1.1</a>.  <a href="#name-client-authentication-of-na" class="internal xref">Client Authentication of Native Apps</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-using-inter-app-uri-communi" class="internal xref">Using Inter-App URI Communication for OAuth in Native Apps</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-initiating-the-authorizatio" class="internal xref">Initiating the Authorization Request from a Native App</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-receiving-the-authorization" class="internal xref">Receiving the Authorization Response in a Native App</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.1">
                    <p id="section-toc.1-1.8.2.4.2.1.1"><a href="#section-8.4.1" class="auto internal xref">8.4.1</a>.  <a href="#name-claimed-https-scheme-uri-re" class="internal xref">Claimed "https" Scheme URI Redirection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.2">
                    <p id="section-toc.1-1.8.2.4.2.2.1"><a href="#section-8.4.2" class="auto internal xref">8.4.2</a>.  <a href="#name-loopback-interface-redirect" class="internal xref">Loopback Interface Redirection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.3">
                    <p id="section-toc.1-1.8.2.4.2.3.1"><a href="#section-8.4.3" class="auto internal xref">8.4.3</a>.  <a href="#name-private-use-uri-scheme-redi" class="internal xref">Private-Use URI Scheme Redirection</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-security-considerations-in-" class="internal xref">Security Considerations in Native Apps</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5.2.1">
                    <p id="section-toc.1-1.8.2.5.2.1.1"><a href="#section-8.5.1" class="auto internal xref">8.5.1</a>.  <a href="#name-embedded-user-agents-in-nat" class="internal xref">Embedded User Agents in Native Apps</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5.2.2">
                    <p id="section-toc.1-1.8.2.5.2.2.1"><a href="#section-8.5.2" class="auto internal xref">8.5.2</a>.  <a href="#name-fake-external-user-agents-i" class="internal xref">Fake External User-Agents in Native Apps</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5.2.3">
                    <p id="section-toc.1-1.8.2.5.2.3.1"><a href="#section-8.5.3" class="auto internal xref">8.5.3</a>.  <a href="#name-malicious-external-user-age" class="internal xref">Malicious External User-Agents in Native Apps</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5.2.4">
                    <p id="section-toc.1-1.8.2.5.2.4.1"><a href="#section-8.5.4" class="auto internal xref">8.5.4</a>.  <a href="#name-loopback-redirect-considera" class="internal xref">Loopback Redirect Considerations in Native Apps</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-browser-based-apps" class="internal xref">Browser-Based Apps</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-differences-from-oauth-20" class="internal xref">Differences from OAuth 2.0</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-removal-of-the-oauth-20-imp" class="internal xref">Removal of the OAuth 2.0 Implicit grant</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-redirect-uri-parameter-in-t" class="internal xref">Redirect URI Parameter in Token Request</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-augmented-backus-naur-form-" class="internal xref">Augmented Backus-Naur Form (ABNF) Syntax</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-client_id-syntax" class="internal xref">"client_id" Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-client_secret-syntax" class="internal xref">"client_secret" Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-response_type-syntax" class="internal xref">"response_type" Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-scope-syntax" class="internal xref">"scope" Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.5">
                <p id="section-toc.1-1.13.2.5.1"><a href="#appendix-A.5" class="auto internal xref">A.5</a>.  <a href="#name-state-syntax" class="internal xref">"state" Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.6">
                <p id="section-toc.1-1.13.2.6.1"><a href="#appendix-A.6" class="auto internal xref">A.6</a>.  <a href="#name-redirect_uri-syntax" class="internal xref">"redirect_uri" Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.7">
                <p id="section-toc.1-1.13.2.7.1"><a href="#appendix-A.7" class="auto internal xref">A.7</a>.  <a href="#name-error-syntax" class="internal xref">"error" Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.8">
                <p id="section-toc.1-1.13.2.8.1"><a href="#appendix-A.8" class="auto internal xref">A.8</a>.  <a href="#name-error_description-syntax" class="internal xref">"error_description" Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.9">
                <p id="section-toc.1-1.13.2.9.1"><a href="#appendix-A.9" class="auto internal xref">A.9</a>.  <a href="#name-error_uri-syntax" class="internal xref">"error_uri" Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.10">
                <p id="section-toc.1-1.13.2.10.1"><a href="#appendix-A.10" class="auto internal xref">A.10</a>. <a href="#name-grant_type-syntax" class="internal xref">"grant_type" Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.11">
                <p id="section-toc.1-1.13.2.11.1"><a href="#appendix-A.11" class="auto internal xref">A.11</a>. <a href="#name-code-syntax" class="internal xref">"code" Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.12">
                <p id="section-toc.1-1.13.2.12.1"><a href="#appendix-A.12" class="auto internal xref">A.12</a>. <a href="#name-access_token-syntax" class="internal xref">"access_token" Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.13">
                <p id="section-toc.1-1.13.2.13.1"><a href="#appendix-A.13" class="auto internal xref">A.13</a>. <a href="#name-token_type-syntax" class="internal xref">"token_type" Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.14">
                <p id="section-toc.1-1.13.2.14.1"><a href="#appendix-A.14" class="auto internal xref">A.14</a>. <a href="#name-expires_in-syntax" class="internal xref">"expires_in" Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.15">
                <p id="section-toc.1-1.13.2.15.1"><a href="#appendix-A.15" class="auto internal xref">A.15</a>. <a href="#name-refresh_token-syntax" class="internal xref">"refresh_token" Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.16">
                <p id="section-toc.1-1.13.2.16.1"><a href="#appendix-A.16" class="auto internal xref">A.16</a>. <a href="#name-endpoint-parameter-syntax" class="internal xref">Endpoint Parameter Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.17">
                <p id="section-toc.1-1.13.2.17.1"><a href="#appendix-A.17" class="auto internal xref">A.17</a>. <a href="#name-code_verifier-syntax" class="internal xref">"code_verifier" Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.18">
                <p id="section-toc.1-1.13.2.18.1"><a href="#appendix-A.18" class="auto internal xref">A.18</a>. <a href="#name-code_challenge-syntax" class="internal xref">"code_challenge" Syntax</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-use-of-application-x-www-fo" class="internal xref">Use of application/x-www-form-urlencoded Media Type</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-extensions" class="internal xref">Extensions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-E" class="auto internal xref">Appendix E</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-F" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">OAuth introduces an authorization layer to the client-server authentication model
by separating the role of the client from that of the resource
owner. In OAuth, the client requests access to resources controlled
by the resource owner and hosted by the resource server.
Instead of using the resource owner's credentials to access protected
resources, the client obtains an access token - a credential representing
a specific set of access attributes such as scope and lifetime. Access
tokens are issued to clients by an authorization server with the approval
of the resource owner. The client uses the access token to access the
protected resources hosted by the resource server.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">In the older, more limited client-server authentication model, the client
requests an access-restricted resource (protected resource) on the
server by authenticating to the server using the resource owner's
credentials.  In order to provide applications access to
restricted resources, the resource owner shares their credentials with
the application.  This creates several problems and limitations:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">
          <p id="section-1-3.1.1">Applications are required to store the resource
owner's credentials for future use, typically a password in
clear-text.<a href="#section-1-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.2">
          <p id="section-1-3.2.1">Servers are required to support password authentication, despite
the security weaknesses inherent in passwords.<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.3">
          <p id="section-1-3.3.1">Applications gain overly broad access to the resource
owner's protected resources, leaving resource owners without any
ability to restrict duration or access to a limited subset of
resources.<a href="#section-1-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.4">
          <p id="section-1-3.4.1">Resource owners often reuse passwords with other unrelated
services, despite best security practices. This password reuse means
a vulnerability or exposure in one service may have security
implications in completely unrelated services.<a href="#section-1-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.5">
          <p id="section-1-3.5.1">Resource owners cannot revoke access to an individual application
without revoking access to all third parties, and must do so by
changing their password.<a href="#section-1-3.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.6">
          <p id="section-1-3.6.1">Compromise of any application results in compromise of
the end-user's password and all of the data protected by that
password.<a href="#section-1-3.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-4">With OAuth, an end-user (resource owner) can grant a printing
service (client) access to their protected photos stored at a photo-
sharing service (resource server), without sharing their username and
password with the printing service.  Instead, they authenticate
directly with a server trusted by the photo-sharing service
(authorization server), which issues the printing service delegation-
specific credentials (access token).<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">This separation of concerns also provides the ability to use more advanced
user authentication methods such as multi-factor authentication and even
passwordless authentication, without any modification to the applications.
With all user authentication logic handled by the authorization server,
applications don't need to be concerned with the specifics of implementing
any particular authentication mechanism. This provides the ability for the
authorization server to manage the user authentication policies and
even change them in the future without coordinating the changes with applications.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">The authorization layer can also simplify how a resource server determines
if a request is authorized. Traditionally, after authenticating the client,
each resource server would evaluate policies to compute if the client is authorized
on each API call. In a distributed system, the policies need to be synchronized
to all the resource servers, or the resource server must call a central policy
server to process each request. In OAuth, evaluation of the policies is performed
only when a new access token is created by the authorization server. If the
authorized access is represented in the access token, the resource server no longer
needs to evaluate the policies, and only needs to validate the access token.
This simplification applies when the application is acting on behalf of a resource
owner, or on behalf of itself.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">OAuth is an authorization protocol, and is not an authentication protocol. The
access token represents the authorization granted to the client. It is a common
practice for the client to present the access token to a proprietary API which
returns a user identifier for the resource owner, and then using the result of
the API as a proxy for authenticating the user. This practice is not part of
the OAuth standard or security considerations, and may not have been considered
by the resource owner. Implementors should carefully consult the documentation
of the resource server before adopting this practice.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">This specification is designed for use with HTTP (<span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>).  The
use of OAuth over any protocol other than HTTP is out of scope.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">Since the publication of the OAuth 2.0 Authorization Framework (<span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>)
in October 2012, it has been updated by OAuth 2.0 for Native Apps (<span>[<a href="#RFC8252" class="cite xref">RFC8252</a>]</span>),
OAuth Security Best Current Practice (<span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span>),
and OAuth 2.0 for Browser-Based Apps (<span>[<a href="#I-D.ietf-oauth-browser-based-apps" class="cite xref">I-D.ietf-oauth-browser-based-apps</a>]</span>).
The OAuth 2.0 Authorization Framework: Bearer Token Usage (<span>[<a href="#RFC6750" class="cite xref">RFC6750</a>]</span>)
has also been updated with (<span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span>). This
Standards Track specification consolidates the information in all of these
documents and removes features that have been found to be insecure
in <span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span>.<a href="#section-1-9" class="pilcrow">¶</a></p>
<div id="roles">
<section id="section-1.1">
        <h3 id="name-roles">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-roles" class="section-name selfRef">Roles</a>
        </h3>
<p id="section-1.1-1">OAuth defines four roles:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-2">
          <dt id="section-1.1-2.1">"resource owner":</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.2">
            <p id="section-1.1-2.2.1">An entity capable of granting access to a protected resource.
When the resource owner is a person, it is referred to as an
end-user. This is sometimes abbreviated as "RO".<a href="#section-1.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.3">"resource server":</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.4">
            <p id="section-1.1-2.4.1">The server hosting the protected resources, capable of accepting
and responding to protected resource requests using access tokens.
The resource server is often accessible via an API.
This is sometimes abbreviated as "RS".<a href="#section-1.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.5">"client":</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.6">
            <p id="section-1.1-2.6.1">An application making protected resource requests on behalf of the
resource owner and with its authorization.  The term "client" does
not imply any particular implementation characteristics (e.g.,
whether the application executes on a server, a desktop, or other
devices).<a href="#section-1.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.7">"authorization server":</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.8">
            <p id="section-1.1-2.8.1">The server issuing access tokens to the client after successfully
authenticating the resource owner and obtaining authorization.
This is sometimes abbreviated as "AS".<a href="#section-1.1-2.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.1-3">The interaction between the authorization server and resource server
is beyond the scope of this specification, however several extensions have
been defined to provide an option for interoperability between resource
servers and authorization servers.  The authorization server
may be the same server as the resource server or a separate entity.
A single authorization server may issue access tokens accepted by
multiple resource servers.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol-flow">
<section id="section-1.2">
        <h3 id="name-protocol-flow">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-protocol-flow" class="section-name selfRef">Protocol Flow</a>
        </h3>
<span id="name-abstract-protocol-flow"></span><div id="fig-protocol-flow">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-1.2-1.1">
<pre>
     +--------+                               +---------------+
     |        |--(1)- Authorization Request -&gt;|   Resource    |
     |        |                               |     Owner     |
     |        |&lt;-(2)-- Authorization Grant ---|               |
     |        |                               +---------------+
     |        |
     |        |                               +---------------+
     |        |--(3)-- Authorization Grant --&gt;| Authorization |
     | Client |                               |     Server    |
     |        |&lt;-(4)----- Access Token -------|               |
     |        |                               +---------------+
     |        |
     |        |                               +---------------+
     |        |--(5)----- Access Token ------&gt;|    Resource   |
     |        |                               |     Server    |
     |        |&lt;-(6)--- Protected Resource ---|               |
     +--------+                               +---------------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-abstract-protocol-flow" class="selfRef">Abstract Protocol Flow</a>
          </figcaption></figure>
</div>
<p id="section-1.2-2">The abstract OAuth 2.1 flow illustrated in <a href="#fig-protocol-flow" class="auto internal xref">Figure 1</a> describes the
interaction between the four roles and includes the following steps:<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.2-3">
<li id="section-1.2-3.1">
            <p id="section-1.2-3.1.1">The client requests authorization from the resource owner.  The
authorization request can be made directly to the resource owner
(as shown), or preferably indirectly via the authorization
server as an intermediary.<a href="#section-1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-3.2">
            <p id="section-1.2-3.2.1">The client receives an authorization grant, which is a
credential representing the resource owner's authorization,
expressed using one of the authorization grant types defined in this
specification or using an extension grant type.  The
authorization grant type depends on the method used by the
client to request authorization and the types supported by the
authorization server.<a href="#section-1.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-3.3">
            <p id="section-1.2-3.3.1">The client requests an access token by authenticating with the
authorization server and presenting the authorization grant.<a href="#section-1.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-3.4">
            <p id="section-1.2-3.4.1">The authorization server authenticates the client and validates
the authorization grant, and if valid, issues an access token.<a href="#section-1.2-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-3.5">
            <p id="section-1.2-3.5.1">The client requests the protected resource from the resource
server and authenticates by presenting the access token.<a href="#section-1.2-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-3.6">
            <p id="section-1.2-3.6.1">The resource server validates the access token, and if valid,
serves the request.<a href="#section-1.2-3.6.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-1.2-4">The preferred method for the client to obtain an authorization grant
from the resource owner (depicted in steps (1) and (2)) is to use the
authorization server as an intermediary, which is illustrated in
<a href="#fig-authorization-code-flow" class="auto internal xref">Figure 3</a> in <a href="#authorization-code-grant" class="auto internal xref">Section 4.1</a>.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-grant">
<section id="section-1.3">
        <h3 id="name-authorization-grant">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-authorization-grant" class="section-name selfRef">Authorization Grant</a>
        </h3>
<p id="section-1.3-1">An authorization grant represents the resource
owner's authorization (to access its protected resources) used by the
client to obtain an access token.  This specification defines three
grant types -- authorization code, refresh token,
and client credentials -- as well as an extensibility
mechanism for defining additional types.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<div id="authorization-code">
<section id="section-1.3.1">
          <h4 id="name-authorization-code">
<a href="#section-1.3.1" class="section-number selfRef">1.3.1. </a><a href="#name-authorization-code" class="section-name selfRef">Authorization Code</a>
          </h4>
<p id="section-1.3.1-1">An authorization code is a temporary credential used to obtain an access token.
Instead of the client
requesting authorization directly from the resource owner, the client
directs the resource owner to an authorization server (via its
user agent) which in turn directs the
resource owner back to the client with the authorization code.
The client can then exchange the authorization code for an access token.<a href="#section-1.3.1-1" class="pilcrow">¶</a></p>
<p id="section-1.3.1-2">Before directing the resource owner back to the client with the
authorization code, the authorization server authenticates the
resource owner, and may request the resource owner's consent or otherwise
inform them of the client's request. Because the resource owner
only authenticates with the authorization server, the resource
owner's credentials are never shared with the client, and the client
does not need to have knowledge of any additional authentication steps
such as multi-factor authentication or delegated accounts.<a href="#section-1.3.1-2" class="pilcrow">¶</a></p>
<p id="section-1.3.1-3">The authorization code provides a few important security benefits,
such as the ability to authenticate the client, as well as the
transmission of the access token directly to the client without
passing it through the resource owner's user agent and potentially
exposing it to others, including the resource owner.<a href="#section-1.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="refresh-token">
<section id="section-1.3.2">
          <h4 id="name-refresh-token">
<a href="#section-1.3.2" class="section-number selfRef">1.3.2. </a><a href="#name-refresh-token" class="section-name selfRef">Refresh Token</a>
          </h4>
<p id="section-1.3.2-1">Refresh tokens are credentials used to obtain access tokens.  Refresh
tokens may be issued to the client by the authorization server and are
used to obtain a new access token when the current access token
becomes invalid or expires, or to obtain additional access tokens
with identical or narrower scope (access tokens may have a shorter
lifetime and fewer privileges than authorized by the resource
owner).  Issuing a refresh token is optional at the discretion of the
authorization server, and may be issued based on properties of the client,
properties of the request, policies within the authorization server, or
any other criteria.  If the authorization server issues a refresh
token, it is included when issuing an access token (i.e., step (2) in
<a href="#fig-refresh-token-flow" class="auto internal xref">Figure 2</a>).<a href="#section-1.3.2-1" class="pilcrow">¶</a></p>
<p id="section-1.3.2-2">A refresh token is a string representing the authorization granted to
the client by the resource owner.  The string is considered opaque to
the client. The refresh token may be an identifier used to retrieve the
authorization information or may encode this information into the
string itself. Unlike access tokens, refresh tokens are
intended for use only with authorization servers and are never sent
to resource servers.<a href="#section-1.3.2-2" class="pilcrow">¶</a></p>
<span id="name-refreshing-an-expired-acces"></span><div id="fig-refresh-token-flow">
<figure id="figure-2">
            <div class="alignLeft art-text artwork" id="section-1.3.2-3.1">
<pre>
+--------+                                           +---------------+
|        |--(1)------- Authorization Grant ---------&gt;|               |
|        |                                           |               |
|        |&lt;-(2)----------- Access Token -------------|               |
|        |               &amp; Refresh Token             |               |
|        |                                           |               |
|        |                            +----------+   |               |
|        |--(3)---- Access Token ----&gt;|          |   |               |
|        |                            |          |   |               |
|        |&lt;-(4)- Protected Resource --| Resource |   | Authorization |
| Client |                            |  Server  |   |     Server    |
|        |--(5)---- Access Token ----&gt;|          |   |               |
|        |                            |          |   |               |
|        |&lt;-(6)- Invalid Token Error -|          |   |               |
|        |                            +----------+   |               |
|        |                                           |               |
|        |--(7)----------- Refresh Token -----------&gt;|               |
|        |                                           |               |
|        |&lt;-(8)----------- Access Token -------------|               |
+--------+           &amp; Optional Refresh Token        +---------------+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-refreshing-an-expired-acces" class="selfRef">Refreshing an Expired Access Token</a>
            </figcaption></figure>
</div>
<p id="section-1.3.2-4">The flow illustrated in <a href="#fig-refresh-token-flow" class="auto internal xref">Figure 2</a> includes the following steps:<a href="#section-1.3.2-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.3.2-5">
<li id="section-1.3.2-5.1">
              <p id="section-1.3.2-5.1.1">The client requests an access token by authenticating with the
authorization server and presenting an authorization grant.<a href="#section-1.3.2-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.3.2-5.2">
              <p id="section-1.3.2-5.2.1">The authorization server authenticates the client and validates
the authorization grant, and if valid, issues an access token
and optionally a refresh token.<a href="#section-1.3.2-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.3.2-5.3">
              <p id="section-1.3.2-5.3.1">The client makes a protected resource request to the resource
server by presenting the access token.<a href="#section-1.3.2-5.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.3.2-5.4">
              <p id="section-1.3.2-5.4.1">The resource server validates the access token, and if valid,
serves the request.<a href="#section-1.3.2-5.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.3.2-5.5">
              <p id="section-1.3.2-5.5.1">Steps (3) and (4) repeat until the access token expires.  If the
client knows the access token expired, it skips to step (7);
otherwise, it makes another protected resource request.<a href="#section-1.3.2-5.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.3.2-5.6">
              <p id="section-1.3.2-5.6.1">Since the access token is invalid, the resource server returns
an invalid token error.<a href="#section-1.3.2-5.6.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.3.2-5.7">
              <p id="section-1.3.2-5.7.1">The client requests a new access token by presenting the refresh token
and providing client authentication if it has been issued credentials. The
client authentication requirements are based on the client type
and on the authorization server policies.<a href="#section-1.3.2-5.7.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.3.2-5.8">
              <p id="section-1.3.2-5.8.1">The authorization server authenticates the client and validates
the refresh token, and if valid, issues a new access token (and,
optionally, a new refresh token).<a href="#section-1.3.2-5.8.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="client-credentials">
<section id="section-1.3.3">
          <h4 id="name-client-credentials">
<a href="#section-1.3.3" class="section-number selfRef">1.3.3. </a><a href="#name-client-credentials" class="section-name selfRef">Client Credentials</a>
          </h4>
<p id="section-1.3.3-1">The client credentials or other forms of client authentication
(e.g. a private key used to sign a JWT, as described in <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>)
can be used as an authorization grant when the authorization scope is
limited to the protected resources under the control of the client,
or to protected resources previously arranged with the authorization
server.  Client credentials are used when the client is requesting
access to protected resources based on an authorization previously
arranged with the authorization server.<a href="#section-1.3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="access-tokens">
<section id="section-1.4">
        <h3 id="name-access-token">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-access-token" class="section-name selfRef">Access Token</a>
        </h3>
<p id="section-1.4-1">Access tokens are credentials used to access protected resources.  An
access token is a string representing an authorization issued to the
client.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<p id="section-1.4-2">The string is considered opaque to the client, even if it has
a structure. The client MUST NOT expect to be able to parse the access
token value. The authorization server is not required to use a
consistent access token encoding or format other than what is
expected by the resource server.<a href="#section-1.4-2" class="pilcrow">¶</a></p>
<p id="section-1.4-3">Access tokens represent specific scopes and durations of access, granted by the
resource owner, and enforced by the resource server and authorization server.<a href="#section-1.4-3" class="pilcrow">¶</a></p>
<p id="section-1.4-4">Depending on the authorization server implementation,
the token string may be used by the resource server to retrieve the authorization information,
or the token may self-contain the authorization information in a verifiable
manner (i.e., a token string consisting of a signed data payload). One example
of a token retrieval mechanism is Token Introspection <span>[<a href="#RFC7662" class="cite xref">RFC7662</a>]</span>, in which the
RS calls an endpoint on the AS to validate the token presented by the client.
One example of a structured token format is JWT Profile for Access Tokens <span>[<a href="#RFC9068" class="cite xref">RFC9068</a>]</span>,
a method of encoding and signing access token data as a JSON Web Token <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-1.4-4" class="pilcrow">¶</a></p>
<p id="section-1.4-5">Additional authentication credentials, which are beyond
the scope of this specification, may be required in order for the
client to use an access token. This is typically referred to as a sender-constrained
access token, such as DPoP <span>[<a href="#RFC9449" class="cite xref">RFC9449</a>]</span> and
Mutual TLS Certificate-Bound Access Tokens <span>[<a href="#RFC8705" class="cite xref">RFC8705</a>]</span>.<a href="#section-1.4-5" class="pilcrow">¶</a></p>
<p id="section-1.4-6">The access token provides an abstraction layer, replacing different
authorization constructs (e.g., username and password) with a single
token understood by the resource server.  This abstraction enables
issuing access tokens more restrictive than the authorization grant
used to obtain them, as well as removing the resource server's need
to understand a wide range of authentication methods.<a href="#section-1.4-6" class="pilcrow">¶</a></p>
<p id="section-1.4-7">Access tokens can have different formats, structures, and methods of
utilization (e.g., cryptographic properties) based on the resource
server security requirements.  Access token attributes and the
methods used to access protected resources may be extended beyond
what is described in this specification.<a href="#section-1.4-7" class="pilcrow">¶</a></p>
<p id="section-1.4-8">Access tokens (as well as any confidential access token
attributes) MUST be kept confidential in transit and storage, and
only shared among the authorization server, the resource servers the
access token is valid for, and the client to which the access token is
issued.<a href="#section-1.4-8" class="pilcrow">¶</a></p>
<p id="section-1.4-9">The authorization server MUST ensure that access tokens cannot be
generated, modified, or guessed to produce valid access tokens by
unauthorized parties.<a href="#section-1.4-9" class="pilcrow">¶</a></p>
<div id="access-token-scope">
<section id="section-1.4.1">
          <h4 id="name-access-token-scope">
<a href="#section-1.4.1" class="section-number selfRef">1.4.1. </a><a href="#name-access-token-scope" class="section-name selfRef">Access Token Scope</a>
          </h4>
<p id="section-1.4.1-1">Access tokens are intended to be issued to clients with less privileges
than the user granting the access has. This is known as a limited "scope"
access token. The authorization server and resource server can use this
scope mechanism to limit what types of resources or level of access a particular client
can have. For example, a client may only need "read" access to a user's
resources, but doesn't need to update resources, so the client can request
the read-only scope defined by the authorization server, and obtain
an access token that cannot be used to update resources. This requires
coordination between the authorization server and resource server. The
authorization server provides the client the ability to request specific
scopes, and associates those scopes with the access token issued to the client.
The resource server is then responsible for enforcing scopes when presented
with a limited-scope access token.<a href="#section-1.4.1-1" class="pilcrow">¶</a></p>
<p id="section-1.4.1-2">To request a limited-scope access token, the client uses the <code>scope</code>
request parameter at the authorization or token endpoints, depending on
the grant type used. In turn, the authorization server uses the <code>scope</code>
response parameter to inform the client of the scope of the access token issued.<a href="#section-1.4.1-2" class="pilcrow">¶</a></p>
<p id="section-1.4.1-3">The value of the scope parameter is expressed as a list of space-
delimited, case-sensitive strings.  The strings are defined by the
authorization server.  If the value contains multiple space-delimited
strings, their order does not matter, and each string adds an
additional access range to the requested scope.<a href="#section-1.4.1-3" class="pilcrow">¶</a></p>
<div class="lang-abnf sourcecode" id="section-1.4.1-4">
<pre>
    scope       = scope-token *( SP scope-token )
    scope-token = 1*( %x21 / %x23-5B / %x5D-7E )
</pre><a href="#section-1.4.1-4" class="pilcrow">¶</a>
</div>
<p id="section-1.4.1-5">The authorization server MAY fully or partially ignore the scope
requested by the client, based on the authorization server policy or
the resource owner's instructions.  If the issued access token scope
is different from the one requested by the client, the authorization
server MUST include the <code>scope</code> response parameter in the token response
(<a href="#token-response" class="auto internal xref">Section 3.2.3</a>) to inform the client of the actual scope granted.<a href="#section-1.4.1-5" class="pilcrow">¶</a></p>
<p id="section-1.4.1-6">If the client omits the scope parameter when requesting
authorization, the authorization server MUST either process the
request using a pre-defined default value or fail the request
indicating an invalid scope.  The authorization server SHOULD
document its scope requirements and default value (if defined).<a href="#section-1.4.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bearer-tokens">
<section id="section-1.4.2">
          <h4 id="name-bearer-tokens">
<a href="#section-1.4.2" class="section-number selfRef">1.4.2. </a><a href="#name-bearer-tokens" class="section-name selfRef">Bearer Tokens</a>
          </h4>
<p id="section-1.4.2-1">A Bearer Token is a security token with the property that any party
in possession of the token (a "bearer") can use the token in any way
that any other party in possession of it can.  Using a Bearer Token
does not require a bearer to prove possession of cryptographic key material
(proof-of-possession).<a href="#section-1.4.2-1" class="pilcrow">¶</a></p>
<p id="section-1.4.2-2">Bearer Tokens may be enhanced with proof-of-possession specifications such
as DPoP <span>[<a href="#RFC9449" class="cite xref">RFC9449</a>]</span> and mTLS <span>[<a href="#RFC8705" class="cite xref">RFC8705</a>]</span> to provide proof-of-possession characteristics.<a href="#section-1.4.2-2" class="pilcrow">¶</a></p>
<p id="section-1.4.2-3">To protect against access token disclosure, the
communication interaction between the client and the resource server
MUST utilize confidentiality and integrity protection as described in
<a href="#communication-security" class="auto internal xref">Section 1.5</a>.<a href="#section-1.4.2-3" class="pilcrow">¶</a></p>
<p id="section-1.4.2-4">There is no requirement on the particular structure or format of a bearer token. If a bearer token is a reference to authorization information, such references MUST be infeasible for an attacker to guess, such as using a sufficiently long cryptographically random string. If a bearer token uses an encoding mechanism to contain the authorization information in the token itself, the access token MUST use integrity protection sufficient to prevent the token from being modified. One example of an encoding and signing mechanism for access tokens is described in JSON Web Token Profile for Access Tokens <span>[<a href="#RFC9068" class="cite xref">RFC9068</a>]</span>.<a href="#section-1.4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sender-constrained-tokens">
<section id="section-1.4.3">
          <h4 id="name-sender-constrained-access-t">
<a href="#section-1.4.3" class="section-number selfRef">1.4.3. </a><a href="#name-sender-constrained-access-t" class="section-name selfRef">Sender-Constrained Access Tokens</a>
          </h4>
<p id="section-1.4.3-1">A sender-constrained access token binds the use of an
access token to a specific sender.  This sender is obliged to
demonstrate knowledge of a certain secret as prerequisite for the
acceptance of that access token at the recipient (e.g., a resource server).<a href="#section-1.4.3-1" class="pilcrow">¶</a></p>
<p id="section-1.4.3-2">Authorization and resource servers SHOULD use mechanisms for
sender-constraining access tokens, such as OAuth Demonstration of Proof of Possession (DPoP) <span>[<a href="#RFC9449" class="cite xref">RFC9449</a>]</span>
or Mutual TLS for OAuth 2.0 <span>[<a href="#RFC8705" class="cite xref">RFC8705</a>]</span>.
See <span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span> Section 4.10.1, to prevent misuse of stolen and leaked access tokens.<a href="#section-1.4.3-2" class="pilcrow">¶</a></p>
<p id="section-1.4.3-3">It is RECOMMENDED to use end-to-end TLS between the client and the
resource server. If TLS traffic needs to be terminated at an intermediary,
refer to Section 4.13 of <span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span> for further security advice.<a href="#section-1.4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="communication-security">
<section id="section-1.5">
        <h3 id="name-communication-security">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-communication-security" class="section-name selfRef">Communication security</a>
        </h3>
<p id="section-1.5-1">Implementations MUST use a mechanism to provide communication
authentication, integrity and confidentiality such as
Transport-Layer Security <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>,
to protect the exchange of clear-text credentials and tokens
either in the content or in header fields
from eavesdropping, tampering, and message forgery
(eg. see <a href="#client-secret" class="auto internal xref">Section 2.4.1</a>, <a href="#authorization_codes" class="auto internal xref">Section 7.5.1</a>, <a href="#token-endpoint" class="auto internal xref">Section 3.2</a>, and <a href="#bearer-tokens" class="auto internal xref">Section 1.4.2</a>).<a href="#section-1.5-1" class="pilcrow">¶</a></p>
<p id="section-1.5-2">OAuth URLs MUST use the <code>https</code> scheme
except for loopback interface redirect URIs,
which MAY use the <code>http</code> scheme.
When using <code>https</code>, TLS certificates MUST be checked
according to <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>.
At the time of this writing,
TLS version 1.3 <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> is the most recent version.<a href="#section-1.5-2" class="pilcrow">¶</a></p>
<p id="section-1.5-3">Implementations MAY also support additional transport-layer security
mechanisms that meet their security requirements.<a href="#section-1.5-3" class="pilcrow">¶</a></p>
<p id="section-1.5-4">The identification of the TLS versions and algorithms
is outside the scope of this specification.
Refer to <span>[<a href="#BCP195" class="cite xref">BCP195</a>]</span> for up to date recommendations on
transport layer security, and to the relevant specifications
for certificate validation and other security considerations.<a href="#section-1.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="http-redirections">
<section id="section-1.6">
        <h3 id="name-http-redirections">
<a href="#section-1.6" class="section-number selfRef">1.6. </a><a href="#name-http-redirections" class="section-name selfRef">HTTP Redirections</a>
        </h3>
<p id="section-1.6-1">This specification makes extensive use of HTTP redirections, in which
the client or the authorization server directs the resource owner's
user agent to another destination.  While the examples in this
specification show the use of the HTTP 302 status code, any other
method available via the user agent to accomplish this redirection,
with the exception of HTTP 307, is allowed and is considered to be an
implementation detail. See <a href="#redirect_307" class="auto internal xref">Section 7.5.4</a> for details.<a href="#section-1.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="interoperability">
<section id="section-1.7">
        <h3 id="name-interoperability">
<a href="#section-1.7" class="section-number selfRef">1.7. </a><a href="#name-interoperability" class="section-name selfRef">Interoperability</a>
        </h3>
<p id="section-1.7-1">OAuth 2.1 provides a rich authorization framework with well-defined
security properties.<a href="#section-1.7-1" class="pilcrow">¶</a></p>
<p id="section-1.7-2">This specification leaves a few required components partially or fully
undefined (e.g., client registration, authorization server capabilities,
endpoint discovery).  Some of these behaviors are defined in optional
extensions which implementations can choose to use, such as:<a href="#section-1.7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7-3.1">
            <p id="section-1.7-3.1.1"><span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>: Authorization Server Metadata, defining an endpoint clients can use to look up the information needed to interact with a particular OAuth server<a href="#section-1.7-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.2">
            <p id="section-1.7-3.2.1"><span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span>: Dynamic Client Registration, providing a mechanism for programmatically registering clients with an authorization server<a href="#section-1.7-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.3">
            <p id="section-1.7-3.3.1"><span>[<a href="#RFC7592" class="cite xref">RFC7592</a>]</span>: Dynamic Client Management, providing a mechanism for updating dynamically registered client information<a href="#section-1.7-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.4">
            <p id="section-1.7-3.4.1"><span>[<a href="#RFC7662" class="cite xref">RFC7662</a>]</span>: Token Introspection, defining a mechanism for resource servers to obtain information about access tokens<a href="#section-1.7-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.7-4">Please refer to <a href="#extensions" class="auto internal xref">Appendix C</a> for a list of current known extensions at
the time of this publication.<a href="#section-1.7-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compatibility-with-oauth-20">
<section id="section-1.8">
        <h3 id="name-compatibility-with-oauth-20">
<a href="#section-1.8" class="section-number selfRef">1.8. </a><a href="#name-compatibility-with-oauth-20" class="section-name selfRef">Compatibility with OAuth 2.0</a>
        </h3>
<p id="section-1.8-1">OAuth 2.1 is compatible with OAuth 2.0 with the extensions and restrictions
from known best current practices applied. Specifically, features not specified
in OAuth 2.0 core, such as PKCE, are required in OAuth 2.1. Additionally,
some features available in OAuth 2.0, such as the Implicit or Resource Owner Credentials
grant types, are not specified in OAuth 2.1. Furthermore, some behaviors
allowed in OAuth 2.0 are restricted in OAuth 2.1, such as the strict string
matching of redirect URIs required by OAuth 2.1.<a href="#section-1.8-1" class="pilcrow">¶</a></p>
<p id="section-1.8-2">See <a href="#oauth-2-0-differences" class="auto internal xref">Section 10</a> for more details on the differences from OAuth 2.0.<a href="#section-1.8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notational-conventions">
<section id="section-1.9">
        <h3 id="name-notational-conventions">
<a href="#section-1.9" class="section-number selfRef">1.9. </a><a href="#name-notational-conventions" class="section-name selfRef">Notational Conventions</a>
        </h3>
<p id="section-1.9-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.9-1" class="pilcrow">¶</a></p>
<p id="section-1.9-2">This specification uses the Augmented Backus-Naur Form (ABNF)
notation of <span>[<a href="#RFC5234" class="cite xref">RFC5234</a>]</span>.  Additionally, the rule URI-reference is
included from "Uniform Resource Identifier (URI): Generic Syntax"
<span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>.<a href="#section-1.9-2" class="pilcrow">¶</a></p>
<p id="section-1.9-3">Certain security-related terms are to be understood in the sense
defined in <span>[<a href="#RFC4949" class="cite xref">RFC4949</a>]</span>.  These terms include, but are not limited to,
"attack", "authentication", "authorization", "certificate",
"confidentiality", "credential", "encryption", "identity", "sign",
"signature", "trust", "validate", and "verify".<a href="#section-1.9-3" class="pilcrow">¶</a></p>
<p id="section-1.9-4">The term "content" is to be interpreted as described in Section 6.4 of <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>.<a href="#section-1.9-4" class="pilcrow">¶</a></p>
<p id="section-1.9-5">The term "user agent" is to be interpreted as described in Section 3.5 of <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>.<a href="#section-1.9-5" class="pilcrow">¶</a></p>
<p id="section-1.9-6">Unless otherwise noted, all the protocol parameter names and values
are case sensitive.<a href="#section-1.9-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="client-registration">
<section id="section-2">
      <h2 id="name-client-registration">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-client-registration" class="section-name selfRef">Client Registration</a>
      </h2>
<p id="section-2-1">Before initiating the protocol, the client must establish its registration with the
authorization server. The means through which the client registers
with the authorization server are beyond the scope of this
specification but typically involve the client developer manually registering
the client at the authorization server's website after creating an account and agreeing
to the service's Terms of Service, or by using Dynamic Client Registration (<span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span>).<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Client registration does not require a direct interaction between the
client and the authorization server.  When supported by the
authorization server, registration can rely on other means for
establishing trust and obtaining the required client properties
(e.g., redirect URI, client type).  For example, registration can
be accomplished using a self-issued or third-party-issued assertion,
or by the authorization server performing client discovery using a
trusted channel.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">When registering a client, the client developer SHALL:<a href="#section-2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-4.1">
          <p id="section-2-4.1.1">specify the client type as described in <a href="#client-types" class="auto internal xref">Section 2.1</a>,<a href="#section-2-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.2">
          <p id="section-2-4.2.1">provide client details needed by the grant type in use,
such as redirect URIs as described in <a href="#redirection-endpoint" class="auto internal xref">Section 2.3</a>, and<a href="#section-2-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.3">
          <p id="section-2-4.3.1">include any other information required by the authorization server
(e.g., application name, website, description, logo image, the
acceptance of legal terms).<a href="#section-2-4.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-5">Dynamic Client Registration (<span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span>) defines a common general data model
for clients that may be used even with manual client registration.<a href="#section-2-5" class="pilcrow">¶</a></p>
<div id="client-types">
<section id="section-2.1">
        <h3 id="name-client-types">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-client-types" class="section-name selfRef">Client Types</a>
        </h3>
<p id="section-2.1-1">OAuth 2.1 defines two client types based on their ability to authenticate securely
with the authorization server.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-2">
          <dt id="section-2.1-2.1">"confidential":</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">Clients that have credentials with the AS are designated as "confidential clients"<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.3">"public":</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.4">
            <p id="section-2.1-2.4.1">Clients without credentials are called "public clients"<a href="#section-2.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.1-3">Any clients with credentials MUST take precautions to prevent leakage and abuse of their credentials.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">Client authentication allows an Authorization Server to ensure it is interacting with a certain client
(identified by its <code>client_id</code>) in an OAuth flow. The Authorization Server might make policy decisions
about things such as whether to prompt the user for consent on every authorization or only the first
based on the confidence that the Authorization Server is actually communicating with the legitimate client.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">Whether and how an Authorization Server validates the identity of a client or the party
providing/operating this client is out of scope of this specification.
Authorization servers SHOULD consider the level of confidence in a client's identity
when deciding whether they allow a client access to more sensitive resources and operations
such as the Client Credentials grant type and how often to prompt the user for consent.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6">A single <code>client_id</code> SHOULD NOT be treated as more than one type of client.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.1-7">This specification has been designed around the following client profiles:<a href="#section-2.1-7" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-8">
          <dt id="section-2.1-8.1">"web application":</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-8.2">
            <p id="section-2.1-8.2.1">A web application is a client running on a web
server. Resource owners access the client via an HTML user
interface rendered in a user agent on the device used by the
resource owner.  The client credentials as well as any access
tokens issued to the client are stored on the web server and are
not exposed to or accessible by the resource owner.<a href="#section-2.1-8.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-8.3">"browser-based application":</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-8.4">
            <p id="section-2.1-8.4.1">A browser-based application is a client in which the
client code is downloaded from a web server and executes within a
user agent (e.g., web browser) on the device used by the resource
owner.  Protocol data and credentials are easily accessible (and
often visible) to the resource owner. If such applications wish to use
client credentials, it is recommended to utilize the
backend for frontend pattern. Since such applications
reside within the user agent, they can make seamless use of the
user agent capabilities when requesting authorization.<a href="#section-2.1-8.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-8.5">"native application":</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-8.6">
            <p id="section-2.1-8.6.1">A native application is a client installed and executed on
the device used by the resource owner.  Protocol data and
credentials are accessible to the resource owner.  It is assumed
that any client authentication credentials included in the
application can be extracted. Dynamically
issued access tokens and refresh tokens can
receive an acceptable level of protection.  On some platforms, these credentials
are protected from other applications residing on the same
device. If such applications wish to use
client credentials, it is recommended to utilize the
backend for frontend pattern, or issue the credentials at runtime
using Dynamic Client Registration (<span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span>).<a href="#section-2.1-8.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="client-identifier">
<section id="section-2.2">
        <h3 id="name-client-identifier">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-client-identifier" class="section-name selfRef">Client Identifier</a>
        </h3>
<p id="section-2.2-1">Every client is identified in the context of an authorization server
by a client identifier -- a unique string representing the registration
information provided by the client. While the Authorization Server typically
issues the client identifier itself, it may also serve clients whose client identifier
was created by a party other than the Authorization Server. The client identifier is not a
secret; it is exposed to the resource owner and MUST NOT be used
alone for client authentication.  The client identifier is unique in the
context of an authorization server.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">The client identifier is an opaque string whose size is left undefined by this
specification.  The client should avoid making assumptions about the
identifier size.  The authorization server SHOULD document the size
of any identifier it issues.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">If the authorization server supports clients with client identifiers issued by
parties other than the authorization server, the authorization server SHOULD
take precautions to avoid clients impersonating resource owners as described
in <a href="#client-impersonating-resource-owner" class="auto internal xref">Section 7.4</a>.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="redirection-endpoint">
<section id="section-2.3">
        <h3 id="name-client-redirection-endpoint">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-client-redirection-endpoint" class="section-name selfRef">Client Redirection Endpoint</a>
        </h3>
<p id="section-2.3-1">The client redirection endpoint (also referred to as "redirect endpoint")
is the URI of the client that the authorization server redirects the user
agent back to after completing its interaction with the resource owner.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">The authorization server redirects the user agent to one of the
client's redirection endpoints previously established with the
authorization server during the client registration process.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">The redirect URI MUST be an absolute URI as defined by
<span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span> Section 4.3.  The redirect URI MAY include an
"application/x-www-form-urlencoded" formatted query
component (<span>[<a href="#WHATWG.URL" class="cite xref">WHATWG.URL</a>]</span>), which MUST be retained when adding
additional query parameters. The redirect URI MUST NOT include a
fragment component.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<div id="registration-requirements">
<section id="section-2.3.1">
          <h4 id="name-registration-requirements">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-registration-requirements" class="section-name selfRef">Registration Requirements</a>
          </h4>
<p id="section-2.3.1-1">Authorization servers MUST require clients to register their complete
redirect URI (including the path component). Authorization servers
MUST reject authorization requests that specify a redirect URI that
doesn't exactly match one that was registered, with an exception for
loopback redirects, where an exact match is required except for the
port URI component, see <a href="#authorization-request" class="auto internal xref">Section 4.1.1</a> for details.<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-2.3.1-2">The authorization server MAY allow the client to register multiple
redirect URIs.<a href="#section-2.3.1-2" class="pilcrow">¶</a></p>
<p id="section-2.3.1-3">Registration may happen out of band, such as a manual step of configuring
the client information at the authorization server, or may happen at
runtime, such as in the initial POST in Pushed Authorization Requests <span>[<a href="#RFC9126" class="cite xref">RFC9126</a>]</span>.<a href="#section-2.3.1-3" class="pilcrow">¶</a></p>
<p id="section-2.3.1-4">For private-use URI scheme-based redirect URIs, authorization servers
SHOULD enforce the requirement in <a href="#private-use-uri-scheme" class="auto internal xref">Section 8.4.3</a> that clients use
schemes that are reverse domain name based.  At a minimum, any
private-use URI scheme that doesn't contain a period character (<code>.</code>)
SHOULD be rejected.<a href="#section-2.3.1-4" class="pilcrow">¶</a></p>
<p id="section-2.3.1-5">In addition to the collision-resistant properties,
this can help to prove ownership in the event of a dispute where two apps
claim the same private-use URI scheme (where one app is acting
maliciously).  For example, if two apps claimed <code>com.example.app</code>,
the owner of <code>example.com</code> could petition the app store operator to
remove the counterfeit app.  Such a petition is harder to prove if a
generic URI scheme was used.<a href="#section-2.3.1-5" class="pilcrow">¶</a></p>
<p id="section-2.3.1-6">Clients MUST NOT expose URLs that forward the user's browser to
arbitrary URIs obtained from a query parameter ("open redirector"), as
described in <a href="#open-redirectors" class="auto internal xref">Section 7.12</a>. Open redirectors can enable
exfiltration of authorization codes and access tokens.<a href="#section-2.3.1-6" class="pilcrow">¶</a></p>
<p id="section-2.3.1-7">The client MAY use the <code>state</code> request parameter to achieve per-request
customization if needed rather than varying the redirect URI per request.<a href="#section-2.3.1-7" class="pilcrow">¶</a></p>
<p id="section-2.3.1-8">Without requiring registration of redirect URIs, attackers can
use the authorization endpoint as an open redirector as
described in <a href="#open-redirectors" class="auto internal xref">Section 7.12</a>.<a href="#section-2.3.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multiple-redirect-uris">
<section id="section-2.3.2">
          <h4 id="name-multiple-redirect-uris">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-multiple-redirect-uris" class="section-name selfRef">Multiple Redirect URIs</a>
          </h4>
<p id="section-2.3.2-1">If multiple redirect URIs have been registered to a client, the client MUST
include a redirect URI with the authorization request using the
<code>redirect_uri</code> request parameter (<a href="#authorization-request" class="auto internal xref">Section 4.1.1</a>).
If only a single redirect URI has been registered to a client,
the <code>redirect_uri</code> request parameter is optional.<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="preventing-csrf-attacks">
<section id="section-2.3.3">
          <h4 id="name-preventing-csrf-attacks">
<a href="#section-2.3.3" class="section-number selfRef">2.3.3. </a><a href="#name-preventing-csrf-attacks" class="section-name selfRef">Preventing CSRF Attacks</a>
          </h4>
<p id="section-2.3.3-1">Clients MUST prevent Cross-Site Request Forgery (CSRF) attacks. In this
context, CSRF refers to requests to the redirection endpoint that do
not originate at the authorization server, but a malicious third party
(see Section 4.4.1.8. of <span>[<a href="#RFC6819" class="cite xref">RFC6819</a>]</span> for details). Clients that have
ensured that the authorization server supports the <code>code_challenge</code> parameter MAY
rely on the CSRF protection provided by that mechanism. In OpenID Connect flows,
validating the <code>nonce</code> parameter provides CSRF protection. Otherwise, one-time
use CSRF tokens carried in the <code>state</code> parameter that are securely
bound to the user agent MUST be used for CSRF protection (see
<a href="#csrf_countermeasures" class="auto internal xref">Section 7.9</a>).<a href="#section-2.3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="preventing-mix-up-attacks">
<section id="section-2.3.4">
          <h4 id="name-preventing-mix-up-attacks">
<a href="#section-2.3.4" class="section-number selfRef">2.3.4. </a><a href="#name-preventing-mix-up-attacks" class="section-name selfRef">Preventing Mix-Up Attacks</a>
          </h4>
<p id="section-2.3.4-1">When an OAuth client can only interact with one authorization server, a mix-up defense is not required. In scenarios where an OAuth client interacts with two or more authorization servers, however, clients MUST prevent mix-up attacks.
In order to prevent mix-up attacks, clients MUST only process redirect responses of the issuer they sent the respective request to and from the same user agent this authorization request was initiated with.<a href="#section-2.3.4-1" class="pilcrow">¶</a></p>
<p id="section-2.3.4-2">See <a href="#mix-up" class="auto internal xref">Section 7.13</a> for a detailed description of two different defenses against mix-up attacks.<a href="#section-2.3.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="invalid-endpoint">
<section id="section-2.3.5">
          <h4 id="name-invalid-endpoint">
<a href="#section-2.3.5" class="section-number selfRef">2.3.5. </a><a href="#name-invalid-endpoint" class="section-name selfRef">Invalid Endpoint</a>
          </h4>
<p id="section-2.3.5-1">If an authorization request fails validation due to a missing,
invalid, or mismatching redirect URI, the authorization server
SHOULD inform the resource owner of the error and MUST NOT
automatically redirect the user agent to the invalid redirect URI.<a href="#section-2.3.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="endpoint-content">
<section id="section-2.3.6">
          <h4 id="name-endpoint-content">
<a href="#section-2.3.6" class="section-number selfRef">2.3.6. </a><a href="#name-endpoint-content" class="section-name selfRef">Endpoint Content</a>
          </h4>
<p id="section-2.3.6-1">The redirection request to the client's endpoint typically results in
an HTML document response, processed by the user agent.  If the HTML
response is served directly as the result of the redirection request,
any script included in the HTML document will execute with full
access to the redirect URI and the artifacts (e.g. authorization code)
it contains. Additionally, the request URL containing the authorization code
may be sent in the HTTP Referer header to any embedded images, stylesheets
and other elements loaded in the page.<a href="#section-2.3.6-1" class="pilcrow">¶</a></p>
<p id="section-2.3.6-2">The client SHOULD NOT include any third-party scripts (e.g., third-
party analytics, social plug-ins, ad networks) in the redirect URI
endpoint response.  Instead, it SHOULD extract the artifacts from
the URI and redirect the user agent again to another endpoint without
exposing the artifacts (in the URI or elsewhere).  If third-party
scripts are included, the client MUST ensure that its own scripts
(used to extract and remove the credentials from the URI) will
execute first.<a href="#section-2.3.6-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="client-authentication">
<section id="section-2.4">
        <h3 id="name-client-authentication">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-client-authentication" class="section-name selfRef">Client Authentication</a>
        </h3>
<p id="section-2.4-1">The authorization server MUST only rely on client authentication if the
process of issuance/registration and distribution of the underlying
credentials ensures their confidentiality.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">If the client is confidential, the authorization server MAY accept any
form of client authentication meeting its security requirements
(e.g., password, public/private key pair).<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.4-3">It is RECOMMENDED to use asymmetric (public-key based) methods for
client authentication such as mTLS <span>[<a href="#RFC8705" class="cite xref">RFC8705</a>]</span> or using signed JWTs
("Private Key JWT") in accordance with <span>[<a href="#RFC7521" class="cite xref">RFC7521</a>]</span> and <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>
(in <span>[<a href="#OpenID" class="cite xref">OpenID</a>]</span> defined as the client authentication method <code>private_key_jwt</code>).
When such methods for client authentication are used, authorization
servers do not need to store sensitive symmetric keys, making these
methods more robust against a number of attacks.<a href="#section-2.4-3" class="pilcrow">¶</a></p>
<p id="section-2.4-4">When client authentication is not possible, the authorization server
SHOULD employ other means to validate the client's identity -- for
example, by requiring the registration of the client redirect URI
or enlisting the resource owner to confirm identity.  A valid
redirect URI is not sufficient to verify the client's identity
when asking for resource owner authorization but can be used to
prevent delivering credentials to a counterfeit client after
obtaining resource owner authorization.<a href="#section-2.4-4" class="pilcrow">¶</a></p>
<p id="section-2.4-5">The client MUST NOT use more than one authentication method in each
request to prevent a conflict of which authentication mechanism is
authoritative for the request.<a href="#section-2.4-5" class="pilcrow">¶</a></p>
<p id="section-2.4-6">The authorization server MUST consider the security implications of
interacting with unauthenticated clients and take measures to limit
the potential exposure of tokens issued to such clients,
(e.g., limiting the lifetime of refresh tokens).<a href="#section-2.4-6" class="pilcrow">¶</a></p>
<p id="section-2.4-7">The privileges an authorization server associates with a certain
client identity MUST depend on the assessment of the overall process
for client identification and client credential lifecycle management.
See <a href="#security-client-authentication" class="auto internal xref">Section 7.2</a> for additional details.<a href="#section-2.4-7" class="pilcrow">¶</a></p>
<div id="client-secret">
<section id="section-2.4.1">
          <h4 id="name-client-secret">
<a href="#section-2.4.1" class="section-number selfRef">2.4.1. </a><a href="#name-client-secret" class="section-name selfRef">Client Secret</a>
          </h4>
<p id="section-2.4.1-1">Clients in possession of a client secret, sometimes known as a client password,
MAY use the HTTP Basic
authentication scheme as defined in Section 11 of <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span> to authenticate with
the authorization server.  The client identifier is encoded using the
<code>application/x-www-form-urlencoded</code> encoding algorithm per
<a href="#application-x-www-form-urlencoded" class="auto internal xref">Appendix B</a>, and the encoded value is used as the username; the client
secret is encoded using the same algorithm and used as the
password.  The authorization server MUST support the HTTP Basic
authentication scheme for authenticating clients that were issued a
client secret.<a href="#section-2.4.1-1" class="pilcrow">¶</a></p>
<p id="section-2.4.1-2">For example (with extra line breaks for display purposes only):<a href="#section-2.4.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.4.1-3">
<pre>
Authorization: Basic czZCaGRSa3F0Mzo3RmpmcDBaQnIxS3REUmJuZlZkbUl3
</pre><a href="#section-2.4.1-3" class="pilcrow">¶</a>
</div>
<p id="section-2.4.1-4">In addition to that, the authorization server MAY support including the
client credentials in the request content using the following
parameters:<a href="#section-2.4.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.4.1-5">
            <dt id="section-2.4.1-5.1">"client_id":</dt>
            <dd style="margin-left: 1.5em" id="section-2.4.1-5.2">
              <p id="section-2.4.1-5.2.1">REQUIRED.  The client identifier issued to the client during
the registration process described by <a href="#client-identifier" class="auto internal xref">Section 2.2</a>.<a href="#section-2.4.1-5.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-2.4.1-5.3">"client_secret":</dt>
            <dd style="margin-left: 1.5em" id="section-2.4.1-5.4">
              <p id="section-2.4.1-5.4.1">REQUIRED.  The client secret.<a href="#section-2.4.1-5.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-2.4.1-6">Including the client credentials in the request content using the two
parameters is NOT RECOMMENDED and SHOULD be limited to clients unable
to directly utilize the HTTP Basic authentication scheme (or other
password-based HTTP authentication schemes).  The parameters can only
be transmitted in the request content and MUST NOT be included in the
request URI.<a href="#section-2.4.1-6" class="pilcrow">¶</a></p>
<p id="section-2.4.1-7">For example, a request to refresh an access token (<a href="#refreshing-an-access-token" class="auto internal xref">Section 4.3</a>) using
the content parameters (with extra line breaks for display purposes
only):<a href="#section-2.4.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.4.1-8">
<pre>
POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&amp;refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
&amp;client_id=s6BhdRkqt3&amp;client_secret=7Fjfp0ZBr1KtDRbnfVdmIw
</pre><a href="#section-2.4.1-8" class="pilcrow">¶</a>
</div>
<p id="section-2.4.1-9">Since this client authentication method involves a password, the
authorization server MUST protect any endpoint utilizing it against
brute force attacks.<a href="#section-2.4.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="other-authentication-methods">
<section id="section-2.4.2">
          <h4 id="name-other-authentication-method">
<a href="#section-2.4.2" class="section-number selfRef">2.4.2. </a><a href="#name-other-authentication-method" class="section-name selfRef">Other Authentication Methods</a>
          </h4>
<p id="section-2.4.2-1">The authorization server MAY support any suitable authentication
scheme matching its security requirements.  When using other
authentication methods, the authorization server MUST define a
mapping between the client identifier (registration record) and
authentication scheme.<a href="#section-2.4.2-1" class="pilcrow">¶</a></p>
<p id="section-2.4.2-2">Some additional authentication methods such as mTLS <span>[<a href="#RFC8705" class="cite xref">RFC8705</a>]</span>
and Private Key JWT <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span> are defined in the
"<a href="https://www.iana.org/assignments/oauth-parameters/oauth-parameters.xhtml#token-endpoint-auth-method">OAuth Token Endpoint Authentication Methods</a>" registry,
and may be useful as generic client authentication methods beyond
the specific use of protecting the token endpoint.<a href="#section-2.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="unregistered-clients">
<section id="section-2.5">
        <h3 id="name-unregistered-clients">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-unregistered-clients" class="section-name selfRef">Unregistered Clients</a>
        </h3>
<p id="section-2.5-1">This specification does not require that clients be registered with
the authorization server.
However, the use of unregistered clients is beyond the scope of this
specification and requires additional security analysis and review of
its interoperability impact.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="protocol-endpoints">
<section id="section-3">
      <h2 id="name-protocol-endpoints">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-protocol-endpoints" class="section-name selfRef">Protocol Endpoints</a>
      </h2>
<p id="section-3-1">The authorization process utilizes two authorization server endpoints
(HTTP resources):<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">
          <p id="section-3-2.1.1">Authorization endpoint - used by the client to obtain
authorization from the resource owner via user agent redirection.<a href="#section-3-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.2">
          <p id="section-3-2.2.1">Token endpoint - used by the client to exchange an authorization
grant for an access token, typically with client authentication.<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-3">As well as one client endpoint:<a href="#section-3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-4.1">
          <p id="section-3-4.1.1">Redirection endpoint - used by the authorization server to return
responses containing authorization credentials to the client via
the resource owner user agent.<a href="#section-3-4.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-5">Not every authorization grant type utilizes both endpoints.
Extension grant types MAY define additional endpoints as needed.<a href="#section-3-5" class="pilcrow">¶</a></p>
<div id="authorization-endpoint">
<section id="section-3.1">
        <h3 id="name-authorization-endpoint">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-authorization-endpoint" class="section-name selfRef">Authorization Endpoint</a>
        </h3>
<p id="section-3.1-1">The authorization endpoint is used to interact with the resource
owner and obtain an authorization grant.  The authorization server
MUST first authenticate the resource owner.  The way in
which the authorization server authenticates the resource owner
(e.g., username and password login, passkey, federated login, or by using an established session)
is beyond the scope of this specification.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The means through which the client obtains the URL of the
authorization endpoint are beyond the scope of this specification,
but the URL is typically provided in the service documentation,
or in the authorization server's metadata document (<span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>).<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">The authorization endpoint URL MUST NOT include a fragment component,
and MAY include an "application/x-www-form-urlencoded" formatted
query component <span>[<a href="#WHATWG.URL" class="cite xref">WHATWG.URL</a>]</span>, which MUST be retained when adding
additional query parameters.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">The authorization server MUST support the use of the HTTP <code>GET</code>
method Section 9.3.1 of <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span> for the authorization endpoint and MAY support
the <code>POST</code> method (Section 9.3.3 of <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>) as well.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">The authorization server MUST ignore unrecognized request parameters sent to the authorization endpoint.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">Request and response parameters
defined by this specification MUST NOT be included more than once.
Parameters sent without a value MUST be treated as if they were
omitted from the request.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1-7">An authorization server that redirects a request potentially containing
user credentials MUST avoid forwarding these user credentials accidentally
(see <a href="#redirect_307" class="auto internal xref">Section 7.5.4</a> for details).<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1-8">Cross-Origin Resource Sharing (also known as CORS) <span>[<a href="#WHATWG.CORS" class="cite xref">WHATWG.CORS</a>]</span> MUST NOT be
supported at the Authorization Endpoint as the client does not access this
endpoint directly, instead the client redirects the user agent to it.<a href="#section-3.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-endpoint">
<section id="section-3.2">
        <h3 id="name-token-endpoint">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-token-endpoint" class="section-name selfRef">Token Endpoint</a>
        </h3>
<p id="section-3.2-1">The token endpoint is used by the client to obtain an access token using
a grant such as those described in <a href="#obtaining-authorization" class="auto internal xref">Section 4</a> and
<a href="#refreshing-an-access-token" class="auto internal xref">Section 4.3</a>.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The means through which the client obtains the URL of the token
endpoint are beyond the scope of this specification, but the URL
is typically provided in the service documentation and configured during
development of the client, or provided in the authorization server's metadata
document (<span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>) and fetched programmatically at runtime.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">The token endpoint URL MUST NOT include a fragment component,
and MAY include an <code>application/x-www-form-urlencoded</code> formatted
query component (<span>[<a href="#WHATWG.URL" class="cite xref">WHATWG.URL</a>]</span>).<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">The client MUST use the HTTP <code>POST</code> method when making requests to the token endpoint.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">The authorization server MUST ignore unrecognized request parameters sent to the token endpoint.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">Parameters sent without a value MUST be treated as if they were
omitted from the request. Request and response parameters
defined by this specification MUST NOT be included more than once.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<p id="section-3.2-7">Authorization servers that wish to support browser-based applications
(applications running exclusively in client-side JavaScript without
access to a supporting backend server) will need to ensure the token endpoint
supports the necessary CORS (<span>[<a href="#WHATWG.CORS" class="cite xref">WHATWG.CORS</a>]</span>) headers to allow the responses
to be visible to the application.
If the authorization server provides additional endpoints to the application, such
as metadata URLs, dynamic client registration, revocation, introspection, discovery or
user info endpoints, these endpoints may also be accessed by the browser-based
application, and will also need to have the CORS headers defined to allow access.
See <span>[<a href="#I-D.ietf-oauth-browser-based-apps" class="cite xref">I-D.ietf-oauth-browser-based-apps</a>]</span> for further details.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<div id="token-endpoint-client-authentication">
<section id="section-3.2.1">
          <h4 id="name-client-authentication-2">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-client-authentication-2" class="section-name selfRef">Client Authentication</a>
          </h4>
<p id="section-3.2.1-1">Confidential clients MUST
authenticate with the authorization server as described in
<a href="#client-authentication" class="auto internal xref">Section 2.4</a> when making requests to the token endpoint.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">Client authentication is used for:<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-3.1">
              <p id="section-3.2.1-3.1.1">Enforcing the binding of refresh tokens and authorization codes to
the client they were issued to.  Client authentication adds an
additional layer of security when an authorization code is transmitted
to the redirection endpoint over an insecure channel.<a href="#section-3.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.1-3.2">
              <p id="section-3.2.1-3.2.1">Recovering from a compromised client by disabling the client or
changing its credentials, thus preventing an attacker from abusing
stolen refresh tokens.  Changing a single set of client
credentials is significantly faster than revoking an entire set of
refresh tokens.<a href="#section-3.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.1-3.3">
              <p id="section-3.2.1-3.3.1">Implementing authentication management best practices, which
require periodic credential rotation.  Rotation of an entire set
of refresh tokens can be challenging, while rotation of a single
set of client credentials is significantly easier.<a href="#section-3.2.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="token-request">
<section id="section-3.2.2">
          <h4 id="name-token-request">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-token-request" class="section-name selfRef">Token Request</a>
          </h4>
<p id="section-3.2.2-1">The client makes a request to the token endpoint by sending the
following parameters using the <code>application/x-www-form-urlencoded</code>
format per <a href="#application-x-www-form-urlencoded" class="auto internal xref">Appendix B</a> with a character encoding of UTF-8 in the HTTP
request content:<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2.2-2">
            <dt id="section-3.2.2-2.1">"client_id":</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-2.2">
              <p id="section-3.2.2-2.2.1">REQUIRED, if the client is not authenticating with the
authorization server as described in <a href="#token-endpoint-client-authentication" class="auto internal xref">Section 3.2.1</a>.<a href="#section-3.2.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-2.3">"grant_type":</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-2.4">
              <p id="section-3.2.2-2.4.1">REQUIRED.  Identifier of the grant type the client uses with the particular token request.
This specification defines the values <code>authorization_code</code>, <code>refresh_token</code>, and <code>client_credentials</code>.
The grant type determines the further parameters required or supported by the token request. The
details of those grant types are defined below.<a href="#section-3.2.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.2-3">Confidential clients MUST authenticate with the authorization
server as described in <a href="#token-endpoint-client-authentication" class="auto internal xref">Section 3.2.1</a>.<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2.2-4">For example, the client makes the following HTTP request
(with extra line breaks for display purposes only):<a href="#section-3.2.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.2-5">
<pre>
POST /token HTTP/1.1
Host: server.example.com
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&amp;code=SplxlOBeZQQYbYS6WxSbIA
&amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb
&amp;code_verifier=3641a2d12d66101249cdf7a79c000c1f8c05d2aafcf14bf146497bed
</pre><a href="#section-3.2.2-5" class="pilcrow">¶</a>
</div>
<p id="section-3.2.2-6">The authorization server MUST:<a href="#section-3.2.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-7.1">
              <p id="section-3.2.2-7.1.1">require client authentication for confidential clients
(or clients with other authentication requirements),<a href="#section-3.2.2-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.2-7.2">
              <p id="section-3.2.2-7.2.1">authenticate the client if client authentication is included<a href="#section-3.2.2-7.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.2.2-8">Further grant type specific processing rules apply and are specified with the respective
grant type.<a href="#section-3.2.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-response">
<section id="section-3.2.3">
          <h4 id="name-token-response">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-token-response" class="section-name selfRef">Token Response</a>
          </h4>
<p id="section-3.2.3-1">If the access token request is valid and authorized, the
authorization server issues an access token and optional refresh
token.<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
<p id="section-3.2.3-2">If the request client
authentication failed or is invalid, the authorization server returns
an error response as described in <a href="#token-error-response" class="auto internal xref">Section 3.2.4</a>.<a href="#section-3.2.3-2" class="pilcrow">¶</a></p>
<p id="section-3.2.3-3">The authorization server issues an access token and optional refresh
token by creating an HTTP response content using the <code>application/json</code>
media type as defined by <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> with the following parameters
and an HTTP 200 (OK) status code:<a href="#section-3.2.3-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2.3-4">
            <dt id="section-3.2.3-4.1">"access_token":</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.3-4.2">
              <p id="section-3.2.3-4.2.1">REQUIRED.  The access token issued by the authorization server.<a href="#section-3.2.3-4.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-4.3">"token_type":</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.3-4.4">
              <p id="section-3.2.3-4.4.1">REQUIRED.  The type of the access token issued as described in
<a href="#access-tokens" class="auto internal xref">Section 1.4</a>.  Value is case insensitive.<a href="#section-3.2.3-4.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-4.5">"expires_in":</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.3-4.6">
              <p id="section-3.2.3-4.6.1">RECOMMENDED.  The lifetime in seconds of the access token.  For
example, the value <code>3600</code> denotes that the access token will
expire in one hour from the time the response was generated.
If omitted, the authorization server SHOULD provide the
expiration time via other means or document the default value.<a href="#section-3.2.3-4.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-4.7">"scope":</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.3-4.8">
              <p id="section-3.2.3-4.8.1">RECOMMENDED, if identical to the scope requested by the client;
otherwise, REQUIRED.  The scope of the access token as
described by <a href="#access-token-scope" class="auto internal xref">Section 1.4.1</a>.<a href="#section-3.2.3-4.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-4.9">"refresh_token":</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.3-4.10">
              <p id="section-3.2.3-4.10.1">OPTIONAL.  The refresh token, which can be used to obtain new
access tokens based on the grant passed in the corresponding
token request.<a href="#section-3.2.3-4.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.3-5">Authorization servers SHOULD determine, based on a risk assessment
and their own policies, whether to issue refresh tokens to a certain client.  If the
authorization server decides not to issue refresh tokens, the client
MAY obtain new access tokens by starting the OAuth flow over, for example
initiating a new authorization code request.  In such a case, the authorization
server may utilize cookies and persistent grants to optimize the user
experience.<a href="#section-3.2.3-5" class="pilcrow">¶</a></p>
<p id="section-3.2.3-6">If refresh tokens are issued, those refresh tokens MUST be bound to
the scope and resource servers as consented by the resource owner.
This is to prevent privilege escalation by the legitimate client and
reduce the impact of refresh token leakage.<a href="#section-3.2.3-6" class="pilcrow">¶</a></p>
<p id="section-3.2.3-7">The parameters are serialized into a JavaScript Object Notation (JSON)
structure by adding each parameter at the highest structure level.
Parameter names and string values are included as JSON strings.
Numerical values are included as JSON numbers.  The order of
parameters does not matter and can vary.<a href="#section-3.2.3-7" class="pilcrow">¶</a></p>
<p id="section-3.2.3-8">The authorization server MUST include the HTTP <code>Cache-Control</code>
response header field (see Section 5.2 of <span>[<a href="#RFC9111" class="cite xref">RFC9111</a>]</span>) with a value of <code>no-store</code> in any
response containing tokens, credentials, or other sensitive
information.<a href="#section-3.2.3-8" class="pilcrow">¶</a></p>
<p id="section-3.2.3-9">For example:<a href="#section-3.2.3-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.3-10">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "access_token":"2YotnFZFEjr1zCsicMWpAA",
  "token_type":"Bearer",
  "expires_in":3600,
  "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",
  "example_parameter":"example_value"
}
</pre><a href="#section-3.2.3-10" class="pilcrow">¶</a>
</div>
<p id="section-3.2.3-11">The client MUST ignore unrecognized value names in the response.  The
sizes of tokens and other values received from the authorization
server are left undefined.  The client should avoid making
assumptions about value sizes.  The authorization server SHOULD
document the size of any value it issues.<a href="#section-3.2.3-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-error-response">
<section id="section-3.2.4">
          <h4 id="name-error-response">
<a href="#section-3.2.4" class="section-number selfRef">3.2.4. </a><a href="#name-error-response" class="section-name selfRef">Error Response</a>
          </h4>
<p id="section-3.2.4-1">The authorization server responds with an HTTP 400 (Bad Request)
status code (unless specified otherwise) and includes the following
parameters with the response:<a href="#section-3.2.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2.4-2">
            <dt id="section-3.2.4-2.1">"error":</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.4-2.2">
              <p id="section-3.2.4-2.2.1">REQUIRED.  A single ASCII <span>[<a href="#USASCII" class="cite xref">USASCII</a>]</span> error code from the following:<a href="#section-3.2.4-2.2.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2.4-2.2.2">
                <dt id="section-3.2.4-2.2.2.1">"invalid_request":</dt>
                <dd style="margin-left: 1.5em" id="section-3.2.4-2.2.2.2">
                  <p id="section-3.2.4-2.2.2.2.1">The request is missing a required parameter, includes an
unsupported parameter value (other than grant type),
repeats a parameter, includes multiple credentials,
utilizes more than one mechanism for authenticating the
client, contains a <code>code_verifier</code> although no
<code>code_challenge</code> was sent in the authorization request,
or is otherwise malformed.<a href="#section-3.2.4-2.2.2.2.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-3.2.4-2.2.2.3">"invalid_client":</dt>
                <dd style="margin-left: 1.5em" id="section-3.2.4-2.2.2.4">
                  <p id="section-3.2.4-2.2.2.4.1">Client authentication failed (e.g., unknown client, no
client authentication included, or unsupported
authentication method).  The authorization server MAY
return an HTTP 401 (Unauthorized) status code to indicate
which HTTP authentication schemes are supported.  If the
client attempted to authenticate via the <code>Authorization</code>
request header field, the authorization server MUST
respond with an HTTP 401 (Unauthorized) status code and
include the <code>WWW-Authenticate</code> response header field
matching the authentication scheme used by the client.<a href="#section-3.2.4-2.2.2.4.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-3.2.4-2.2.2.5">"invalid_grant":</dt>
                <dd style="margin-left: 1.5em" id="section-3.2.4-2.2.2.6">
                  <p id="section-3.2.4-2.2.2.6.1">The provided authorization grant (e.g., authorization
code, resource owner credentials) or refresh token is
invalid, expired, revoked, does not match the redirect
URI used in the authorization request, or was issued to
another client.<a href="#section-3.2.4-2.2.2.6.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-3.2.4-2.2.2.7">"unauthorized_client":</dt>
                <dd style="margin-left: 1.5em" id="section-3.2.4-2.2.2.8">
                  <p id="section-3.2.4-2.2.2.8.1">The authenticated client is not authorized to use this
authorization grant type.<a href="#section-3.2.4-2.2.2.8.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-3.2.4-2.2.2.9">"unsupported_grant_type":</dt>
                <dd style="margin-left: 1.5em" id="section-3.2.4-2.2.2.10">
                  <p id="section-3.2.4-2.2.2.10.1">The authorization grant type is not supported by the
authorization server.<a href="#section-3.2.4-2.2.2.10.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-3.2.4-2.2.2.11">"invalid_scope":</dt>
                <dd style="margin-left: 1.5em" id="section-3.2.4-2.2.2.12">
                  <p id="section-3.2.4-2.2.2.12.1">The requested scope is invalid, unknown, malformed, or
exceeds the scope granted by the resource owner.<a href="#section-3.2.4-2.2.2.12.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<p id="section-3.2.4-2.2.3">Values for the <code>error</code> parameter MUST NOT include characters
outside the set %x20-21 / %x23-5B / %x5D-7E.<a href="#section-3.2.4-2.2.3" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.4-2.3">"error_description":</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.4-2.4">
              <p id="section-3.2.4-2.4.1">OPTIONAL.  Human-readable ASCII <span>[<a href="#USASCII" class="cite xref">USASCII</a>]</span> text providing
additional information, used to assist the client developer in
understanding the error that occurred.
Values for the <code>error_description</code> parameter MUST NOT include
characters outside the set %x20-21 / %x23-5B / %x5D-7E.<a href="#section-3.2.4-2.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.4-2.5">"error_uri":</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.4-2.6">
              <p id="section-3.2.4-2.6.1">OPTIONAL.  A URI identifying a human-readable web page with
information about the error, used to provide the client
developer with additional information about the error.
Values for the <code>error_uri</code> parameter MUST conform to the
URI-reference syntax and thus MUST NOT include characters
outside the set %x21 / %x23-5B / %x5D-7E.<a href="#section-3.2.4-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.4-3">The parameters are included in the content of the HTTP response
using the <code>application/json</code> media type as defined by <span>[<a href="#RFC7159" class="cite xref">RFC7159</a>]</span>.  The
parameters are serialized into a JSON structure by adding each
parameter at the highest structure level.  Parameter names and string
values are included as JSON strings.  Numerical values are included
as JSON numbers.  The order of parameters does not matter and can
vary.<a href="#section-3.2.4-3" class="pilcrow">¶</a></p>
<p id="section-3.2.4-4">For example:<a href="#section-3.2.4-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.4-5">
<pre>
HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
 "error":"invalid_request"
}
</pre><a href="#section-3.2.4-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="obtaining-authorization">
<section id="section-4">
      <h2 id="name-grant-types">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-grant-types" class="section-name selfRef">Grant Types</a>
      </h2>
<p id="section-4-1">To request an access token, the client obtains authorization from the
resource owner. This specification defines the following authorization grant types:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">authorization code<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.2">
          <p id="section-4-2.2.1">client credentials, and<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.3">
          <p id="section-4-2.3.1">refresh token<a href="#section-4-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-3">It also provides an extension mechanism for defining additional grant types.<a href="#section-4-3" class="pilcrow">¶</a></p>
<div id="authorization-code-grant">
<section id="section-4.1">
        <h3 id="name-authorization-code-grant">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-authorization-code-grant" class="section-name selfRef">Authorization Code Grant</a>
        </h3>
<p id="section-4.1-1">The authorization code grant type is used to obtain both access
tokens and refresh tokens.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">The grant type uses the additional authorization endpoint to let the authorization server
interact with the resource owner in order to get consent for resource access.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">Since this is a redirect-based flow, the client must be capable of
initiating the flow with the resource owner's user agent (typically a web
browser) and capable of being redirected back to from the authorization server.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<span id="name-authorization-code-flow"></span><div id="fig-authorization-code-flow">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-4.1-4.1">
<pre>
 +----------+
 | Resource |
 |   Owner  |
 +----------+
       ^
       |
       |
 +-----|----+          Client Identifier      +---------------+
 | .---+---------(1)-- &amp; Redirect URI -------&gt;|               |
 | |   |    |                                 |               |
 | |   '---------(2)-- User authenticates ---&gt;|               |
 | | User-  |                                 | Authorization |
 | | Agent  |                                 |     Server    |
 | |        |                                 |               |
 | |    .--------(3)-- Authorization Code ---&lt;|               |
 +-|----|---+                                 +---------------+
   |    |                                         ^      v
   |    |                                         |      |
   ^    v                                         |      |
 +---------+                                      |      |
 |         |&gt;---(4)-- Authorization Code ---------'      |
 |  Client |          &amp; Redirect URI                     |
 |         |                                             |
 |         |&lt;---(5)----- Access Token -------------------'
 +---------+       (w/ Optional Refresh Token)
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-authorization-code-flow" class="selfRef">Authorization Code Flow</a>
          </figcaption></figure>
</div>
<p id="section-4.1-5">The flow illustrated in <a href="#fig-authorization-code-flow" class="auto internal xref">Figure 3</a> includes the following steps:<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">(1)  The client initiates the flow by directing the resource owner's
     user agent to the authorization endpoint.  The client includes
     its client identifier, code challenge (derived from a generated code verifier),
     optional requested scope, optional local state, and a
     redirect URI to which the authorization server will send the
     user agent back once access is granted (or denied).<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">(2)  The authorization server authenticates the resource owner (via
     the user agent) and establishes whether the resource owner
     grants or denies the client's access request.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">(3)  Assuming the resource owner grants access, the authorization
     server redirects the user agent back to the client using the
     redirect URI provided earlier (in the request or during
     client registration).  The redirect URI includes an
     authorization code and any local state provided by the client
     earlier.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1-9">(4)  The client requests an access token from the authorization
     server's token endpoint by including the authorization code
     received in the previous step, and including its code verifier.
     When making the request, the
     client authenticates with the authorization server if it can.  The client
     includes the redirect URI used to obtain the authorization
     code for verification.<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1-10">(5)  The authorization server authenticates the client when possible, validates the
     authorization code, validates the code verifier, and ensures that the redirect URI
     received matches the URI used to redirect the client in
     step (3).  If valid, the authorization server responds back with
     an access token and, optionally, a refresh token.<a href="#section-4.1-10" class="pilcrow">¶</a></p>
<div id="authorization-request">
<section id="section-4.1.1">
          <h4 id="name-authorization-request">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-authorization-request" class="section-name selfRef">Authorization Request</a>
          </h4>
<p id="section-4.1.1-1">To begin the authorization request, the client builds the authorization
request URI by adding parameters to the authorization server's
authorization endpoint URI. The client will eventually redirect the user agent
to this URI to initiate the request.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">Clients use a unique secret per authorization request to protect against authorization code
injection and CSRF attacks. The client first generates this secret, which it can
use at the time of redeeming the authorization code to prove that the client using the
authorization code is the same client that requested it.<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.1-3">The client constructs the request URI by adding the following
parameters to the query component of the authorization endpoint URI
using the <code>application/x-www-form-urlencoded</code> format, per <a href="#application-x-www-form-urlencoded" class="auto internal xref">Appendix B</a>:<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1.1-4">
            <dt id="section-4.1.1-4.1">"response_type":</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-4.2">
              <p id="section-4.1.1-4.2.1">REQUIRED.  The authorization endpoint supports different sets of request and response
pameters. The client determines the type of flow by using a certain <code>response_type</code>
value. This specification defines the value <code>code</code>, which must be used to signal that
the client wants to use the authorization code flow.<a href="#section-4.1.1-4.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.1.1-5">Extension response types MAY contain a space-delimited (%x20) list of
values, where the order of values does not matter (e.g., response
type <code>a b</code> is the same as <code>b a</code>).  The meaning of such composite
response types is defined by their respective specifications.<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1.1-6">Some extension response types are defined by (<span>[<a href="#OpenID" class="cite xref">OpenID</a>]</span>).<a href="#section-4.1.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1.1-7">If an authorization request is missing the <code>response_type</code> parameter,
or if the response type is not understood, the authorization server
MUST return an error response as described in <a href="#authorization-code-error-response" class="auto internal xref">Section 4.1.2.1</a>.<a href="#section-4.1.1-7" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1.1-8">
            <dt id="section-4.1.1-8.1">"client_id":</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-8.2">
              <p id="section-4.1.1-8.2.1">REQUIRED.  The client identifier as described in <a href="#client-identifier" class="auto internal xref">Section 2.2</a>.<a href="#section-4.1.1-8.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-8.3">"code_challenge":</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-8.4">
              <p id="section-4.1.1-8.4.1">REQUIRED or RECOMMENDED (see <a href="#authorization_codes" class="auto internal xref">Section 7.5.1</a>).  Code challenge.<a href="#section-4.1.1-8.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-8.5">"code_challenge_method":</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-8.6">
              <p id="section-4.1.1-8.6.1">OPTIONAL, defaults to <code>plain</code> if not present in the request.  Code
verifier transformation method is <code>S256</code> or <code>plain</code>.<a href="#section-4.1.1-8.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-8.7">"redirect_uri":</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-8.8">
              <p id="section-4.1.1-8.8.1">OPTIONAL if only one redirect URI is registered for this client.
REQUIRED if multiple redirict URIs are registered for this client.
See <a href="#multiple-redirect-uris" class="auto internal xref">Section 2.3.2</a>.<a href="#section-4.1.1-8.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-8.9">"scope":</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-8.10">
              <p id="section-4.1.1-8.10.1">OPTIONAL.  The scope of the access request as described by
<a href="#access-token-scope" class="auto internal xref">Section 1.4.1</a>.<a href="#section-4.1.1-8.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-8.11">"state":</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-8.12">
              <p id="section-4.1.1-8.12.1">OPTIONAL.  An opaque value used by the client to maintain
state between the request and callback.  The authorization
server includes this value when redirecting the user agent back
to the client.<a href="#section-4.1.1-8.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.1.1-9">The <code>code_verifier</code> is a unique high-entropy cryptographically random string generated
for each authorization request, using the unreserved characters <code>[A-Z] / [a-z] / [0-9] / "-" / "." / "_" / "~"</code>,
with a minimum length of 43 characters and a maximum length of 128 characters.<a href="#section-4.1.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1.1-10">The client stores the <code>code_verifier</code> temporarily, and calculates the
<code>code_challenge</code> which it uses in the authorization request.<a href="#section-4.1.1-10" class="pilcrow">¶</a></p>
<p id="section-4.1.1-11">ABNF for <code>code_verifier</code> is as follows.<a href="#section-4.1.1-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-12">
<pre>
code-verifier = 43*128unreserved
unreserved = ALPHA / DIGIT / "-" / "." / "_" / "~"
ALPHA = %x41-5A / %x61-7A
DIGIT = %x30-39
</pre><a href="#section-4.1.1-12" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-13">Clients SHOULD use code challenge methods that
do not expose the <code>code_verifier</code> in the authorization request.
Otherwise, attackers that can read the authorization request (cf.
Attacker A4 in <span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span>) can break the security provided
by this mechanism. Currently, <code>S256</code> is the only such method.<a href="#section-4.1.1-13" class="pilcrow">¶</a></p>
<p id="section-4.1.1-14">NOTE: The code verifier SHOULD have enough entropy to make it
impractical to guess the value.  It is RECOMMENDED that the output of
a suitable random number generator be used to create a 32-octet
sequence.  The octet sequence is then base64url-encoded to produce a
43-octet URL-safe string to use as the code verifier.<a href="#section-4.1.1-14" class="pilcrow">¶</a></p>
<p id="section-4.1.1-15">The client then creates a <code>code_challenge</code> derived from the code
verifier by using one of the following transformations on the code
verifier:<a href="#section-4.1.1-15" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-16">
<pre>
S256
  code_challenge = BASE64URL-ENCODE(SHA256(ASCII(code_verifier)))

plain
  code_challenge = code_verifier
</pre><a href="#section-4.1.1-16" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-17">If the client is capable of using <code>S256</code>, it MUST use <code>S256</code>, as
<code>S256</code> is Mandatory To Implement (MTI) on the server.  Clients are
permitted to use <code>plain</code> only if they cannot support <code>S256</code> for some
technical reason, for example constrained environments that do not have
a hashing function available, and know via out-of-band configuration or via
Authorization Server Metadata (<span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>) that the server supports <code>plain</code>.<a href="#section-4.1.1-17" class="pilcrow">¶</a></p>
<p id="section-4.1.1-18">ABNF for <code>code_challenge</code> is as follows.<a href="#section-4.1.1-18" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-19">
<pre>
code-challenge = 43*128unreserved
unreserved = ALPHA / DIGIT / "-" / "." / "_" / "~"
ALPHA = %x41-5A / %x61-7A
DIGIT = %x30-39
</pre><a href="#section-4.1.1-19" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-20">The properties <code>code_challenge</code> and <code>code_verifier</code> are adopted from the OAuth 2.0 extension
known as "Proof-Key for Code Exchange", or PKCE (<span>[<a href="#RFC7636" class="cite xref">RFC7636</a>]</span>) where this technique
was originally developed.<a href="#section-4.1.1-20" class="pilcrow">¶</a></p>
<p id="section-4.1.1-21">Authorization servers MUST support the <code>code_challenge</code> and <code>code_verifier</code> parameters.<a href="#section-4.1.1-21" class="pilcrow">¶</a></p>
<p id="section-4.1.1-22">Clients MUST use <code>code_challenge</code> and <code>code_verifier</code> and
authorization servers MUST enforce their use except under the conditions
described in <a href="#authorization_codes" class="auto internal xref">Section 7.5.1</a>. In this case, using and enforcing
<code>code_challenge</code> and <code>code_verifier</code> as described in the following is still
RECOMMENDED.<a href="#section-4.1.1-22" class="pilcrow">¶</a></p>
<p id="section-4.1.1-23">The <code>state</code> and <code>scope</code> parameters SHOULD NOT include sensitive
client or resource owner information in plain text, as they can be
transmitted over insecure channels or stored insecurely.<a href="#section-4.1.1-23" class="pilcrow">¶</a></p>
<p id="section-4.1.1-24">The client directs the resource owner to the constructed URI using an
HTTP redirection, or by other means available to it via the user agent.<a href="#section-4.1.1-24" class="pilcrow">¶</a></p>
<p id="section-4.1.1-25">For example, the client directs the user agent to make the following
HTTP request (with extra line breaks for display purposes
only):<a href="#section-4.1.1-25" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-26">
<pre>
GET /authorize?response_type=code&amp;client_id=s6BhdRkqt3&amp;state=xyz
    &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb
    &amp;code_challenge=6fdkQaPm51l13DSukcAH3Mdx7_ntecHYd1vi3n0hMZY
    &amp;code_challenge_method=S256 HTTP/1.1
Host: server.example.com
</pre><a href="#section-4.1.1-26" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-27">The authorization server validates the request to ensure that all
required parameters are present and valid.<a href="#section-4.1.1-27" class="pilcrow">¶</a></p>
<p id="section-4.1.1-28">In particular, the authorization server MUST validate the <code>redirect_uri</code>
in the request if present, ensuring that it matches one of the registered
redirect URIs previously established during client registration (<a href="#client-registration" class="auto internal xref">Section 2</a>).
When comparing the two URIs the authorization server MUST ensure that the
two URIs are equal, see <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>, Section 6.2.1, Simple String Comparison, for details.<a href="#section-4.1.1-28" class="pilcrow">¶</a></p>
<p id="section-4.1.1-29">If the request is valid,
the authorization server authenticates the resource owner and obtains
an authorization decision (by asking the resource owner or by
establishing approval via other means).<a href="#section-4.1.1-29" class="pilcrow">¶</a></p>
<p id="section-4.1.1-30">When a decision is established, the authorization server directs the
user agent to the provided client redirect URI using an HTTP
redirection response, or by other means available to it via the
user agent.<a href="#section-4.1.1-30" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-response">
<section id="section-4.1.2">
          <h4 id="name-authorization-response">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-authorization-response" class="section-name selfRef">Authorization Response</a>
          </h4>
<p id="section-4.1.2-1">If the resource owner grants the access request, the authorization
server issues an authorization code and delivers it to the client by
adding the following parameters to the query component of the
redirect URI using the <code>application/x-www-form-urlencoded</code> format,
per <a href="#application-x-www-form-urlencoded" class="auto internal xref">Appendix B</a>:<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1.2-2">
            <dt id="section-4.1.2-2.1">"code":</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.2-2.2">
              <p id="section-4.1.2-2.2.1">REQUIRED.  The authorization code is generated by the
authorization server and opaque to the client.  The authorization code MUST expire
shortly after it is issued to mitigate the risk of leaks.  A
maximum authorization code lifetime of 10 minutes is
RECOMMENDED. The authorization code is bound to
the client identifier, code challenge and redirect URI.<a href="#section-4.1.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.2-2.3">"state":</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.2-2.4">
              <p id="section-4.1.2-2.4.1">REQUIRED if the <code>state</code> parameter was present in the client
authorization request.  The exact value received from the
client.<a href="#section-4.1.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.2-2.5">"iss":</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.2-2.6">
              <p id="section-4.1.2-2.6.1">OPTIONAL. The identifier of the authorization server which the
client can use to prevent mix-up attacks, if the client interacts
with more than one authorization server. See <a href="#mix-up" class="auto internal xref">Section 7.13</a> and <span>[<a href="#RFC9207" class="cite xref">RFC9207</a>]</span> for
additional details on when this parameter is necessary, and how the
client can use it to prevent mix-up attacks.<a href="#section-4.1.2-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.1.2-3">For example, the authorization server redirects the user agent by
sending the following HTTP response:<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.2-4">
<pre>
HTTP/1.1 302 Found
Location: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA
          &amp;state=xyz&amp;iss=https%3A%2F%2Fauthorization-server.example.com
</pre><a href="#section-4.1.2-4" class="pilcrow">¶</a>
</div>
<p id="section-4.1.2-5">The client MUST ignore unrecognized response parameters.  The
authorization code string size is left undefined by this
specification.  The client should avoid making assumptions about code
value sizes.  The authorization server SHOULD document the size of
any value it issues.<a href="#section-4.1.2-5" class="pilcrow">¶</a></p>
<p id="section-4.1.2-6">The authorization server MUST associate the <code>code_challenge</code> and
<code>code_challenge_method</code> values with the issued authorization code
so the code challenge can be verified later.<a href="#section-4.1.2-6" class="pilcrow">¶</a></p>
<p id="section-4.1.2-7">The exact method that the server uses to associate the <code>code_challenge</code>
with the issued code is out of scope for this specification. The
code challenge could be stored on the server and associated with the
code there. The <code>code_challenge</code> and <code>code_challenge_method</code> values may
be stored in encrypted form in the code itself, but the server
MUST NOT include the <code>code_challenge</code> value in a response parameter
in a form that entities other than the AS can extract.<a href="#section-4.1.2-7" class="pilcrow">¶</a></p>
<p id="section-4.1.2-8">Clients MUST prevent injection (replay) of authorization codes into the
authorization response by attackers. Using <code>code_challenge</code> and <code>code_verifier</code> prevents injection of authorization codes since the authorization server will reject a token request with a mismatched <code>code_verifier</code>. See <a href="#authorization_codes" class="auto internal xref">Section 7.5.1</a> for more details.<a href="#section-4.1.2-8" class="pilcrow">¶</a></p>
<div id="authorization-code-error-response">
<section id="section-4.1.2.1">
            <h5 id="name-error-response-2">
<a href="#section-4.1.2.1" class="section-number selfRef">4.1.2.1. </a><a href="#name-error-response-2" class="section-name selfRef">Error Response</a>
            </h5>
<p id="section-4.1.2.1-1">If the request fails due to a missing, invalid, or mismatching
redirect URI, or if the client identifier is missing or invalid,
the authorization server SHOULD inform the resource owner of the
error and MUST NOT automatically redirect the user agent to the
invalid redirect URI.<a href="#section-4.1.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2.1-2">An AS MUST reject requests without a <code>code_challenge</code> from public clients,
and MUST reject such requests from other clients unless there is
reasonable assurance that the client mitigates authorization code injection
in other ways. See <a href="#authorization_codes" class="auto internal xref">Section 7.5.1</a> for details.<a href="#section-4.1.2.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2.1-3">If the server does not support the requested <code>code_challenge_method</code> transformation,
the authorization endpoint MUST return the
authorization error response with <code>error</code> value set to
<code>invalid_request</code>.  The <code>error_description</code> or the response of
<code>error_uri</code> SHOULD explain the nature of error, e.g., transform
algorithm not supported.<a href="#section-4.1.2.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.2.1-4">If the resource owner denies the access request or if the request
fails for reasons other than a missing or invalid redirect URI,
the authorization server informs the client by adding the following
parameters to the query component of the redirect URI using the
<code>application/x-www-form-urlencoded</code> format, per <a href="#application-x-www-form-urlencoded" class="auto internal xref">Appendix B</a>:<a href="#section-4.1.2.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1.2.1-5">
              <dt id="section-4.1.2.1-5.1">"error":</dt>
              <dd style="margin-left: 1.5em" id="section-4.1.2.1-5.2">
                <p id="section-4.1.2.1-5.2.1">REQUIRED.  A single ASCII <span>[<a href="#USASCII" class="cite xref">USASCII</a>]</span> error code from the
following:<a href="#section-4.1.2.1-5.2.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1.2.1-5.2.2">
                  <dt id="section-4.1.2.1-5.2.2.1">"invalid_request":</dt>
                  <dd style="margin-left: 1.5em" id="section-4.1.2.1-5.2.2.2">
                    <p id="section-4.1.2.1-5.2.2.2.1">The request is missing a required parameter, includes an
invalid parameter value, includes a parameter more than
once, or is otherwise malformed.<a href="#section-4.1.2.1-5.2.2.2.1" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-4.1.2.1-5.2.2.3">"unauthorized_client":</dt>
                  <dd style="margin-left: 1.5em" id="section-4.1.2.1-5.2.2.4">
                    <p id="section-4.1.2.1-5.2.2.4.1">The client is not authorized to request an authorization
code using this method.<a href="#section-4.1.2.1-5.2.2.4.1" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-4.1.2.1-5.2.2.5">"access_denied":</dt>
                  <dd style="margin-left: 1.5em" id="section-4.1.2.1-5.2.2.6">
                    <p id="section-4.1.2.1-5.2.2.6.1">The resource owner or authorization server denied the
request.<a href="#section-4.1.2.1-5.2.2.6.1" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-4.1.2.1-5.2.2.7">"unsupported_response_type":</dt>
                  <dd style="margin-left: 1.5em" id="section-4.1.2.1-5.2.2.8">
                    <p id="section-4.1.2.1-5.2.2.8.1">The authorization server does not support obtaining an
authorization code using this method.<a href="#section-4.1.2.1-5.2.2.8.1" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-4.1.2.1-5.2.2.9">"invalid_scope":</dt>
                  <dd style="margin-left: 1.5em" id="section-4.1.2.1-5.2.2.10">
                    <p id="section-4.1.2.1-5.2.2.10.1">The requested scope is invalid, unknown, or malformed.<a href="#section-4.1.2.1-5.2.2.10.1" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-4.1.2.1-5.2.2.11">"server_error":</dt>
                  <dd style="margin-left: 1.5em" id="section-4.1.2.1-5.2.2.12">
                    <p id="section-4.1.2.1-5.2.2.12.1">The authorization server encountered an unexpected
condition that prevented it from fulfilling the request.
(This error code is needed because a 500 Internal Server
Error HTTP status code cannot be returned to the client
via an HTTP redirect.)<a href="#section-4.1.2.1-5.2.2.12.1" class="pilcrow">¶</a></p>
</dd>
                  <dd class="break"></dd>
<dt id="section-4.1.2.1-5.2.2.13">"temporarily_unavailable":</dt>
                  <dd style="margin-left: 1.5em" id="section-4.1.2.1-5.2.2.14">
                    <p id="section-4.1.2.1-5.2.2.14.1">The authorization server is currently unable to handle
the request due to a temporary overloading or maintenance
of the server.  (This error code is needed because a 503
Service Unavailable HTTP status code cannot be returned
to the client via an HTTP redirect.)<a href="#section-4.1.2.1-5.2.2.14.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
</dl>
<p id="section-4.1.2.1-5.2.3">Values for the <code>error</code> parameter MUST NOT include characters
outside the set %x20-21 / %x23-5B / %x5D-7E.<a href="#section-4.1.2.1-5.2.3" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-4.1.2.1-5.3">"error_description":</dt>
              <dd style="margin-left: 1.5em" id="section-4.1.2.1-5.4">
                <p id="section-4.1.2.1-5.4.1">OPTIONAL.  Human-readable ASCII <span>[<a href="#USASCII" class="cite xref">USASCII</a>]</span> text providing
additional information, used to assist the client developer in
understanding the error that occurred.
Values for the <code>error_description</code> parameter MUST NOT include
characters outside the set %x20-21 / %x23-5B / %x5D-7E.<a href="#section-4.1.2.1-5.4.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-4.1.2.1-5.5">"error_uri":</dt>
              <dd style="margin-left: 1.5em" id="section-4.1.2.1-5.6">
                <p id="section-4.1.2.1-5.6.1">OPTIONAL.  A URI identifying a human-readable web page with
information about the error, used to provide the client
developer with additional information about the error.
Values for the <code>error_uri</code> parameter MUST conform to the
URI-reference syntax and thus MUST NOT include characters
outside the set %x21 / %x23-5B / %x5D-7E.<a href="#section-4.1.2.1-5.6.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-4.1.2.1-5.7">"state":</dt>
              <dd style="margin-left: 1.5em" id="section-4.1.2.1-5.8">
                <p id="section-4.1.2.1-5.8.1">REQUIRED if a <code>state</code> parameter was present in the client
authorization request.  The exact value received from the
client.<a href="#section-4.1.2.1-5.8.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-4.1.2.1-5.9">"iss":</dt>
              <dd style="margin-left: 1.5em" id="section-4.1.2.1-5.10">
                <p id="section-4.1.2.1-5.10.1">OPTIONAL. The identifier of the authorization server. See
<a href="#authorization-response" class="auto internal xref">Section 4.1.2</a> above for details.<a href="#section-4.1.2.1-5.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-4.1.2.1-6">For example, the authorization server redirects the user agent by
sending the following HTTP response:<a href="#section-4.1.2.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.2.1-7">
<pre>
HTTP/1.1 302 Found
Location: https://client.example.com/cb?error=access_denied
          &amp;state=xyz&amp;iss=https%3A%2F%2Fauthorization-server.example.com
</pre><a href="#section-4.1.2.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="code-token-extension">
<section id="section-4.1.3">
          <h4 id="name-token-endpoint-extension">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-token-endpoint-extension" class="section-name selfRef">Token Endpoint Extension</a>
          </h4>
<p id="section-4.1.3-1">The authorization grant type is identified at the token endpoint with the <code>grant_type</code> value of <code>authorization_code</code>.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3-2">If this value is set, the following additional token request parameters beyond <a href="#token-request" class="auto internal xref">Section 3.2.2</a> are required:<a href="#section-4.1.3-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1.3-3">
            <dt id="section-4.1.3-3.1">"code":</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.3-3.2">
              <p id="section-4.1.3-3.2.1">REQUIRED.  The authorization code received from the
authorization server.<a href="#section-4.1.3-3.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.3-3.3">"code_verifier":</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.3-3.4">
              <p id="section-4.1.3-3.4.1">REQUIRED, if the <code>code_challenge</code> parameter was included in the authorization
request. MUST NOT be used otherwise. The original code verifier string.<a href="#section-4.1.3-3.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.1.3-4">The authorization server MUST return an access token only once for a given authorization code.<a href="#section-4.1.3-4" class="pilcrow">¶</a></p>
<p id="section-4.1.3-5">If a second valid token request is made with the same
authorization code as a previously successful token request,
the authorization server MUST deny the request and SHOULD
revoke (when possible) all access tokens and refresh tokens
previously issued based on that authorization code.
See <a href="#authorization-code-reuse" class="auto internal xref">Section 7.5.3</a> for further details.<a href="#section-4.1.3-5" class="pilcrow">¶</a></p>
<p id="section-4.1.3-6">For example, the client makes the following HTTP request
(with extra line breaks for display purposes only):<a href="#section-4.1.3-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.3-7">
<pre>
POST /token HTTP/1.1
Host: server.example.com
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code
&amp;code=SplxlOBeZQQYbYS6WxSbIA
&amp;code_verifier=3641a2d12d66101249cdf7a79c000c1f8c05d2aafcf14bf146497bed
</pre><a href="#section-4.1.3-7" class="pilcrow">¶</a>
</div>
<p id="section-4.1.3-8">In addition to the processing rules in <a href="#token-request" class="auto internal xref">Section 3.2.2</a>, the authorization server MUST:<a href="#section-4.1.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.3-9.1">
              <p id="section-4.1.3-9.1.1">ensure that the authorization code was issued to the authenticated
confidential client, or if the client is public, ensure that the
code was issued to <code>client_id</code> in the request,<a href="#section-4.1.3-9.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.3-9.2">
              <p id="section-4.1.3-9.2.1">verify that the authorization code is valid,<a href="#section-4.1.3-9.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.3-9.3">
              <p id="section-4.1.3-9.3.1">verify that the <code>code_verifier</code> parameter is present if and only if a
<code>code_challenge</code> parameter was present in the authorization request,<a href="#section-4.1.3-9.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.3-9.4">
              <p id="section-4.1.3-9.4.1">if a <code>code_verifier</code> is present, verify the <code>code_verifier</code> by calculating
the code challenge from the received <code>code_verifier</code> and comparing it with
the previously associated <code>code_challenge</code>, after first transforming it
according to the <code>code_challenge_method</code> method specified by the client, and<a href="#section-4.1.3-9.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.3-9.5">
              <p id="section-4.1.3-9.5.1">If there was no <code>code_challenge</code> in the authorization request associated
with the authorization code in the token request, the authorization server MUST
reject the token request.<a href="#section-4.1.3-9.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.1.3-10">See <a href="#redirect-uri-in-token-request" class="auto internal xref">Section 10.2</a> for details on backwards compatibility
with OAuth 2.0 clients regarding the <code>redirect_uri</code> parameter in the token request.<a href="#section-4.1.3-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="client-credentials-grant">
<section id="section-4.2">
        <h3 id="name-client-credentials-grant">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-client-credentials-grant" class="section-name selfRef">Client Credentials Grant</a>
        </h3>
<p id="section-4.2-1">The client can request an access token using only its client
credentials (or other supported means of authentication) when the
client is requesting access to the protected resources under its
control, or those of another resource owner that have been previously
arranged with the authorization server (the method of which is beyond
the scope of this specification).<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">The client credentials grant type MUST only be used by confidential clients.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<span id="name-client-credentials-grant-2"></span><div id="fig-client-credentials-grant">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-4.2-3.1">
<pre>
     +---------+                                  +---------------+
     |         |                                  |               |
     |         |&gt;--(1)- Client Authentication ---&gt;| Authorization |
     | Client  |                                  |     Server    |
     |         |&lt;--(2)---- Access Token ---------&lt;|               |
     |         |                                  |               |
     +---------+                                  +---------------+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-client-credentials-grant-2" class="selfRef">Client Credentials Grant</a>
          </figcaption></figure>
</div>
<p id="section-4.2-4">The use of the client credentials grant illustrated in <a href="#fig-client-credentials-grant" class="auto internal xref">Figure 4</a> includes the following steps:<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">(1)  The client authenticates with the authorization server and
     requests an access token from the token endpoint.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">(2)  The authorization server authenticates the client, and if valid,
     issues an access token.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<div id="client-credentials-access-token-request">
<section id="section-4.2.1">
          <h4 id="name-token-endpoint-extension-2">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-token-endpoint-extension-2" class="section-name selfRef">Token Endpoint Extension</a>
          </h4>
<p id="section-4.2.1-1">The authorization grant type is identified at the token endpoint with the <code>grant_type</code> value of <code>client_credentials</code>.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">If this value is set, the following additional token request parameters beyond <a href="#token-request" class="auto internal xref">Section 3.2.2</a> are supported:<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.1-3">
            <dt id="section-4.2.1-3.1">"scope":</dt>
            <dd style="margin-left: 1.5em" id="section-4.2.1-3.2">
              <p id="section-4.2.1-3.2.1">OPTIONAL.  The scope of the access request as described by
<a href="#access-token-scope" class="auto internal xref">Section 1.4.1</a>.<a href="#section-4.2.1-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.1-4">For example, the client makes the following HTTP request using
transport-layer security (with extra line breaks for display purposes
only):<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-5">
<pre>
POST /token HTTP/1.1
Host: server.example.com
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
Content-Type: application/x-www-form-urlencoded

grant_type=client_credentials
</pre><a href="#section-4.2.1-5" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-6">The authorization server MUST authenticate the client.<a href="#section-4.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="refreshing-an-access-token">
<section id="section-4.3">
        <h3 id="name-refresh-token-grant">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-refresh-token-grant" class="section-name selfRef">Refresh Token Grant</a>
        </h3>
<p id="section-4.3-1">The refresh token is a credential issued by the authorization server to a client, which can be used
to obtain new (fresh) access tokens based on an existing grant. The client uses this option either because the previous access
token has expired or the client previously obtained an access token with a scope more narrow than
approved by the respective grant and later requires an access token with a different scope
under the same grant.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">Refresh tokens MUST be kept confidential in transit and storage, and
shared only among the authorization server and the client to whom the
refresh tokens were issued.  The authorization server MUST maintain
the binding between a refresh token and the client to whom it was
issued.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">The authorization server MUST verify the binding between the refresh
token and client identity whenever the client identity can be
authenticated.  When client authentication is not possible, the
authorization server SHOULD issue sender-constrained refresh tokens
or use refresh token rotation as described in <a href="#refresh-token-endpoint-extension" class="auto internal xref">Section 4.3.1</a>.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">The authorization server MUST ensure that refresh tokens cannot be
generated, modified, or guessed to produce valid refresh tokens by
unauthorized parties.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<div id="refresh-token-endpoint-extension">
<section id="section-4.3.1">
          <h4 id="name-token-endpoint-extension-3">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-token-endpoint-extension-3" class="section-name selfRef">Token Endpoint Extension</a>
          </h4>
<p id="section-4.3.1-1">The authorization grant type is identified at the token endpoint with the <code>grant_type</code> value of <code>refresh_token</code>.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-2">If this value is set, the following additional parameters beyond <a href="#token-request" class="auto internal xref">Section 3.2.2</a> are required/supported:<a href="#section-4.3.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.1-3">
            <dt id="section-4.3.1-3.1">"refresh_token":</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.1-3.2">
              <p id="section-4.3.1-3.2.1">REQUIRED.  The refresh token issued to the client.<a href="#section-4.3.1-3.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-3.3">"scope":</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.1-3.4">
              <p id="section-4.3.1-3.4.1">OPTIONAL.  The scope of the access request as described by
<a href="#access-token-scope" class="auto internal xref">Section 1.4.1</a>. The requested scope MUST NOT include any scope
not originally granted by the resource owner, and if omitted is
treated as equal to the scope originally granted by the
resource owner.<a href="#section-4.3.1-3.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.3.1-4">Because refresh tokens are typically long-lasting credentials used to
request additional access tokens, the refresh token is bound to the
client to which it was issued. Confidential clients
MUST authenticate with the authorization server as described in
<a href="#token-endpoint-client-authentication" class="auto internal xref">Section 3.2.1</a>.<a href="#section-4.3.1-4" class="pilcrow">¶</a></p>
<p id="section-4.3.1-5">For example, the client makes the following HTTP request using
transport-layer security (with extra line breaks for display purposes
only):<a href="#section-4.3.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.1-6">
<pre>
POST /token HTTP/1.1
Host: server.example.com
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&amp;refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
</pre><a href="#section-4.3.1-6" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1-7">In addition to the processing rules in <a href="#token-request" class="auto internal xref">Section 3.2.2</a>, the authorization server MUST:<a href="#section-4.3.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-8.1">
              <p id="section-4.3.1-8.1.1">if client authentication is included in the request, ensure that the refresh token was issued to the authenticated client, OR if a client_id is included in the request, ensure the refresh token was issued to the matching client<a href="#section-4.3.1-8.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-8.2">
              <p id="section-4.3.1-8.2.1">validate that the grant corresponding to this refresh token is still active<a href="#section-4.3.1-8.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-8.3">
              <p id="section-4.3.1-8.3.1">validate the refresh token<a href="#section-4.3.1-8.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.3.1-9">Authorization servers MUST utilize one of these methods to detect
refresh token replay by malicious actors for public clients:<a href="#section-4.3.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-10.1">
              <p id="section-4.3.1-10.1.1"><em>Sender-constrained refresh tokens:</em> the authorization server
cryptographically binds the refresh token to a certain client
instance, e.g. by utilizing DPoP <span>[<a href="#RFC9449" class="cite xref">RFC9449</a>]</span> or mTLS <span>[<a href="#RFC8705" class="cite xref">RFC8705</a>]</span>.<a href="#section-4.3.1-10.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-10.2">
              <p id="section-4.3.1-10.2.1"><em>Refresh token rotation:</em> the authorization server issues a new
refresh token with every access token refresh response.  The
previous refresh token is invalidated but information about the
relationship is retained by the authorization server.  If a
refresh token is compromised and subsequently used by both the
attacker and the legitimate client, one of them will present an
invalidated refresh token, which will inform the authorization
server of the breach.  The authorization server cannot determine
which party submitted the invalid refresh token, but it will
revoke the active refresh token as well as the access authorization
grant associated with it. This stops the attack at the
cost of forcing the legitimate client to obtain a fresh
authorization grant.<a href="#section-4.3.1-10.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.3.1-11">Implementation note: the grant to which a refresh token belongs
may be encoded into the refresh token itself.  This can enable an
authorization server to efficiently determine the grant to which a
refresh token belongs, and by extension, all refresh tokens that
need to be revoked.  Authorization servers MUST ensure the
integrity of the refresh token value in this case, for example,
using signatures.<a href="#section-4.3.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="refresh-token-response">
<section id="section-4.3.2">
          <h4 id="name-refresh-token-response">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-refresh-token-response" class="section-name selfRef">Refresh Token Response</a>
          </h4>
<p id="section-4.3.2-1">If valid and authorized, the authorization server issues an access
token as described in <a href="#token-response" class="auto internal xref">Section 3.2.3</a>.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2-2">The authorization server MAY issue a new refresh token, in which case
the client MUST discard the old refresh token and replace it with the
new refresh token.<a href="#section-4.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="refresh-token-recommendations">
<section id="section-4.3.3">
          <h4 id="name-refresh-token-recommendatio">
<a href="#section-4.3.3" class="section-number selfRef">4.3.3. </a><a href="#name-refresh-token-recommendatio" class="section-name selfRef">Refresh Token Recommendations</a>
          </h4>
<p id="section-4.3.3-1">The authorization server MAY revoke the old
refresh token after issuing a new refresh token to the client.  If a
new refresh token is issued, the refresh token scope MUST be
identical to that of the refresh token included by the client in the
request.<a href="#section-4.3.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3.3-2">Authorization servers MAY revoke refresh tokens automatically in case
of a security event, such as:<a href="#section-4.3.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.3-3.1">
              <p id="section-4.3.3-3.1.1">password change<a href="#section-4.3.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.3-3.2">
              <p id="section-4.3.3-3.2.1">logout at the authorization server<a href="#section-4.3.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.3.3-4">Refresh tokens SHOULD expire if the client has been inactive for some
time, i.e., the refresh token has not been used to obtain new
access tokens for some time.  The expiration time is at the
discretion of the authorization server.  It might be a global value
or determined based on the client policy or the grant associated with
the refresh token (and its sensitivity).<a href="#section-4.3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="extension-grants">
<section id="section-4.4">
        <h3 id="name-extension-grants">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-extension-grants" class="section-name selfRef">Extension Grants</a>
        </h3>
<p id="section-4.4-1">The client uses an extension grant type by specifying the grant type
using an absolute URI (defined by the authorization server) as the
value of the <code>grant_type</code> parameter of the token endpoint, and by
adding any additional parameters necessary.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">For example, to request an access token using the Device Authorization Grant
as defined by <span>[<a href="#RFC8628" class="cite xref">RFC8628</a>]</span> after the user has authorized the client on a separate device,
the client makes the following HTTP request
(with extra line breaks for display purposes only):<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-3">
<pre>
  POST /token HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded

  grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Adevice_code
  &amp;device_code=GmRhmhcxhwEzkoEqiMEg_DnyEysNkuNhszIySk9eS
  &amp;client_id=C409020731
</pre><a href="#section-4.4-3" class="pilcrow">¶</a>
</div>
<p id="section-4.4-4">If the access token request is valid and authorized, the
authorization server issues an access token and optional refresh
token as described in <a href="#token-response" class="auto internal xref">Section 3.2.3</a>.  If the request failed client
authentication or is invalid, the authorization server returns an
error response as described in <a href="#token-error-response" class="auto internal xref">Section 3.2.4</a>.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="accessing-protected-resources">
<section id="section-5">
      <h2 id="name-resource-requests">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-resource-requests" class="section-name selfRef">Resource Requests</a>
      </h2>
<p id="section-5-1">The client accesses protected resources by presenting an access
token to the resource server.  The resource server MUST validate the
access token and ensure that it has not expired and that its scope
covers the requested resource.  The methods used by the resource
server to validate the access token
are beyond the scope of this specification, but generally involve an
interaction or coordination between the resource server and the
authorization server. For example, when the resource server and
authorization server are colocated or are part of the same system,
they may share a database or other storage; when the two components
are operated independently, they may use Token Introspection <span>[<a href="#RFC7662" class="cite xref">RFC7662</a>]</span>
or a structured access token format such as a JWT <span>[<a href="#RFC9068" class="cite xref">RFC9068</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="bearer-token-requests">
<section id="section-5.1">
        <h3 id="name-bearer-token-requests">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-bearer-token-requests" class="section-name selfRef">Bearer Token Requests</a>
        </h3>
<p id="section-5.1-1">This section defines two methods of sending Bearer tokens in resource
requests to resource servers. Clients MUST use one of the two methods defined below,
and MUST NOT use more than one method to transmit the token in each request.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">In particular, clients MUST NOT send the access token in a URI query parameter,
and resource servers MUST ignore access tokens in a URI query parameter.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div id="authorization-request-header-field">
<section id="section-5.1.1">
          <h4 id="name-authorization-request-heade">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-authorization-request-heade" class="section-name selfRef">Authorization Request Header Field</a>
          </h4>
<p id="section-5.1.1-1">When sending the access token in the <code>Authorization</code> request header
field defined by HTTP/1.1 <span>[<a href="#RFC7235" class="cite xref">RFC7235</a>]</span>, the client uses the <code>Bearer</code>
scheme to transmit the access token.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">For example:<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.1-3">
<pre>
 GET /resource HTTP/1.1
 Host: server.example.com
 Authorization: Bearer mF_9.B5f-4.1JqM
</pre><a href="#section-5.1.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-4">The syntax of the <code>Authorization</code> header field for this scheme
follows the usage of the Basic scheme defined in Section 2 of
<span>[<a href="#RFC2617" class="cite xref">RFC2617</a>]</span>.  Note that, as with Basic, it does not conform to the
generic syntax defined in Section 1.2 of <span>[<a href="#RFC2617" class="cite xref">RFC2617</a>]</span> but is compatible
with the general authentication framework in HTTP 1.1 Authentication
<span>[<a href="#RFC7235" class="cite xref">RFC7235</a>]</span>, although it does not follow the preferred
practice outlined therein in order to reflect existing deployments.
The syntax for Bearer credentials is as follows:<a href="#section-5.1.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.1-5">
<pre>
token68    = 1*( ALPHA / DIGIT /
                 "-" / "." / "_" / "~" / "+" / "/" ) *"="
credentials = "Bearer" 1*SP token68
</pre><a href="#section-5.1.1-5" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-6">Clients SHOULD make authenticated requests with a bearer token using
the <code>Authorization</code> request header field with the <code>Bearer</code> HTTP
authorization scheme.  Resource servers MUST support this method.<a href="#section-5.1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="form-encoded-content-parameter">
<section id="section-5.1.2">
          <h4 id="name-form-encoded-content-parame">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-form-encoded-content-parame" class="section-name selfRef">Form-Encoded Content Parameter</a>
          </h4>
<p id="section-5.1.2-1">When sending the access token in the HTTP request content, the
client adds the access token to the request content using the
<code>access_token</code> parameter.  The client MUST NOT use this method unless
all of the following conditions are met:<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.2-2.1">
              <p id="section-5.1.2-2.1.1">The HTTP request includes the <code>Content-Type</code> header
field set to <code>application/x-www-form-urlencoded</code>.<a href="#section-5.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.2-2.2">
              <p id="section-5.1.2-2.2.1">The content follows the encoding requirements of the
<code>application/x-www-form-urlencoded</code> content-type as defined by
the URL Living Standard <span>[<a href="#WHATWG.URL" class="cite xref">WHATWG.URL</a>]</span>.<a href="#section-5.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.2-2.3">
              <p id="section-5.1.2-2.3.1">The HTTP request content is single-part.<a href="#section-5.1.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.2-2.4">
              <p id="section-5.1.2-2.4.1">The content to be encoded in the request MUST consist entirely
of ASCII <span>[<a href="#USASCII" class="cite xref">USASCII</a>]</span> characters.<a href="#section-5.1.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.2-2.5">
              <p id="section-5.1.2-2.5.1">The HTTP request method is one for which the content has
defined semantics.  In particular, this means that the <code>GET</code>
method MUST NOT be used.<a href="#section-5.1.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.1.2-3">The content MAY include other request-specific parameters, in
which case the <code>access_token</code> parameter MUST be properly separated
from the request-specific parameters using <code>&amp;</code> character(s) (ASCII
code 38).<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
<p id="section-5.1.2-4">For example, the client makes the following HTTP request using
transport-layer security:<a href="#section-5.1.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-5">
<pre>
POST /resource HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

access_token=mF_9.B5f-4.1JqM
</pre><a href="#section-5.1.2-5" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-6">The <code>application/x-www-form-urlencoded</code> method SHOULD NOT be used
except in application contexts where participating clients do not
have access to the <code>Authorization</code> request header field.  Resource
servers MAY support this method.<a href="#section-5.1.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="access-token-validation">
<section id="section-5.2">
        <h3 id="name-access-token-validation">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-access-token-validation" class="section-name selfRef">Access Token Validation</a>
        </h3>
<p id="section-5.2-1">After receiving the access token, the resource server MUST check that
the access token is not yet expired, is authorized to access the requested
resource, was issued with the appropriate scope, and meets other policy
requirements of the resource server to access the protected resource.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Access tokens generally fall into two categories: reference tokens or self-encoded tokens.
Reference tokens can be validated by querying the authorization server or
looking up the token in a token database, whereas self-encoded tokens
contain the authorization information in an encrypted and/or signed string
which can be extracted by the resource server.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">A standardized method to query the authorization server to check the validity
of an access token is defined in Token Introspection (<span>[<a href="#RFC7662" class="cite xref">RFC7662</a>]</span>).<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">A standardized method of encoding information in a token string is
defined in JWT Profile for Access Tokens (<span>[<a href="#RFC9068" class="cite xref">RFC9068</a>]</span>).<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">See <a href="#access-token-security-considerations" class="auto internal xref">Section 7.1</a> for additional considerations
around creating and validating access tokens.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="error-response">
<section id="section-5.3">
        <h3 id="name-error-response-3">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-error-response-3" class="section-name selfRef">Error Response</a>
        </h3>
<p id="section-5.3-1">If a resource access request fails, the resource server SHOULD inform
the client of the error. The details of the error response is determined by the particular token type, such as the
description of Bearer tokens in <a href="#bearer-token-error-codes" class="auto internal xref">Section 5.3.2</a>.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div id="the-www-authenticate-response-header-field">
<section id="section-5.3.1">
          <h4 id="name-the-www-authenticate-respon">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-the-www-authenticate-respon" class="section-name selfRef">The WWW-Authenticate Response Header Field</a>
          </h4>
<p id="section-5.3.1-1">If the protected resource request does not include authentication
credentials or does not contain an access token that enables access
to the protected resource, the resource server MUST include the HTTP
<code>WWW-Authenticate</code> response header field; it MAY include it in
response to other conditions as well.  The <code>WWW-Authenticate</code> header
field uses the framework defined by HTTP/1.1 <span>[<a href="#RFC7235" class="cite xref">RFC7235</a>]</span>.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2">All challenges for this token type MUST use the auth-scheme
value <code>Bearer</code>.  This scheme MUST be followed by one or more
auth-param values.  The auth-param attributes used or defined by this
specification for this token type are as follows.  Other auth-param
attributes MAY be used as well.<a href="#section-5.3.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.3.1-3">
            <dt id="section-5.3.1-3.1">"realm":</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.1-3.2">
              <p id="section-5.3.1-3.2.1">A <code>realm</code> attribute MAY be included to indicate the scope of
protection in the manner described in HTTP/1.1 <span>[<a href="#RFC7235" class="cite xref">RFC7235</a>]</span>.  The
<code>realm</code> attribute MUST NOT appear more than once.<a href="#section-5.3.1-3.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.1-3.3">"scope":</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.1-3.4">
              <p id="section-5.3.1-3.4.1">The <code>scope</code> attribute is defined in <a href="#access-token-scope" class="auto internal xref">Section 1.4.1</a>.  The
<code>scope</code> attribute is a space-delimited list of case-sensitive scope
values indicating the required scope of the access token for
accessing the requested resource. <code>scope</code> values are implementation
defined; there is no centralized registry for them; allowed values
are defined by the authorization server.  The order of <code>scope</code> values
is not significant.  In some cases, the <code>scope</code> value will be used
when requesting a new access token with sufficient scope of access to
utilize the protected resource.  Use of the <code>scope</code> attribute is
OPTIONAL.  The <code>scope</code> attribute MUST NOT appear more than once.  The
<code>scope</code> value is intended for programmatic use and is not meant to be
displayed to end-users.<a href="#section-5.3.1-3.4.1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-3.4.2">Two example scope values follow; these are taken from the OpenID
Connect <span>[<a href="#OpenID.Messages" class="cite xref">OpenID.Messages</a>]</span> and the Open Authentication Technology
Committee (OATC) Online Multimedia Authorization Protocol <span>[<a href="#OMAP" class="cite xref">OMAP</a>]</span>
OAuth 2.0 use cases, respectively:<a href="#section-5.3.1-3.4.2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.1-3.4.3">
<pre>
scope="openid profile email"
scope="urn:example:channel=HBO&amp;urn:example:rating=G,PG-13"
</pre><a href="#section-5.3.1-3.4.3" class="pilcrow">¶</a>
</div>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.1-3.5">"error":</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.1-3.6">
              <p id="section-5.3.1-3.6.1">If the protected resource request included an access token and failed
authentication, the resource server SHOULD include the <code>error</code>
attribute to provide the client with the reason why the access
request was declined.  The parameter value is described in
<a href="#bearer-token-error-codes" class="auto internal xref">Section 5.3.2</a>.<a href="#section-5.3.1-3.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.1-3.7">"error_description":</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.1-3.8">
              <p id="section-5.3.1-3.8.1">The resource server MAY include the
<code>error_description</code> attribute to provide developers a human-readable
explanation that is not meant to be displayed to end-users.<a href="#section-5.3.1-3.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.1-3.9">"error_uri":</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.1-3.10">
              <p id="section-5.3.1-3.10.1">The resource server MAY include the <code>error_uri</code> attribute with an absolute URI
identifying a human-readable web page explaining the error.<a href="#section-5.3.1-3.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.3.1-4">The <code>error</code>, <code>error_description</code>, and <code>error_uri</code> attributes MUST NOT
appear more than once.<a href="#section-5.3.1-4" class="pilcrow">¶</a></p>
<p id="section-5.3.1-5">Values for the <code>scope</code> attribute (specified in <a href="#scope-syntax" class="auto internal xref">Appendix A.4</a>)
MUST NOT include characters outside the set %x21 / %x23-5B
/ %x5D-7E for representing scope values and %x20 for delimiters
between scope values.  Values for the <code>error</code> and <code>error_description</code>
attributes (specified in <a href="#error-syntax" class="auto internal xref">Appendix A.7</a> and <a href="#error-description-syntax" class="auto internal xref">Appendix A.8</a>) MUST
NOT include characters outside the set %x20-21 / %x23-5B / %x5D-7E.
Values for the <code>error_uri</code> attribute (specified in <a href="#error-uri-syntax" class="auto internal xref">Appendix A.9</a> of)
MUST conform to the URI-reference syntax and thus MUST NOT
include characters outside the set %x21 / %x23-5B / %x5D-7E.<a href="#section-5.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bearer-token-error-codes">
<section id="section-5.3.2">
          <h4 id="name-error-codes">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-error-codes" class="section-name selfRef">Error Codes</a>
          </h4>
<p id="section-5.3.2-1">When a request fails, the resource server responds using the
appropriate HTTP status code (typically, 400, 401, 403, or 405) and
includes one of the following error codes in the response:<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.3.2-2">
            <dt id="section-5.3.2-2.1">"invalid_request":</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.2-2.2">
              <p id="section-5.3.2-2.2.1">The request is missing a required parameter, includes an
unsupported parameter or parameter value, repeats the same
parameter, uses more than one method for including an access
token, or is otherwise malformed.  The resource server SHOULD
respond with the HTTP 400 (Bad Request) status code.<a href="#section-5.3.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.2-2.3">"invalid_token":</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.2-2.4">
              <p id="section-5.3.2-2.4.1">The access token provided is expired, revoked, malformed, or
invalid for other reasons.  The resource SHOULD respond with
the HTTP 401 (Unauthorized) status code.  The client MAY
request a new access token and retry the protected resource
request.<a href="#section-5.3.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.2-2.5">"insufficient_scope":</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.2-2.6">
              <p id="section-5.3.2-2.6.1">The request requires higher privileges (scopes) than provided by the
scopes granted to the client and represented by the access token.
The resource server SHOULD respond with the HTTP
403 (Forbidden) status code and MAY include the <code>scope</code>
attribute with the scope necessary to access the protected
resource.<a href="#section-5.3.2-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.3.2-3">Extensions may define additional error codes or specify additional
circumstances in which the above error codes are retured.<a href="#section-5.3.2-3" class="pilcrow">¶</a></p>
<p id="section-5.3.2-4">If the request lacks any authentication information (e.g., the client
was unaware that authentication is necessary or attempted using an
unsupported authentication method), the resource server SHOULD NOT
include an error code or other error information.<a href="#section-5.3.2-4" class="pilcrow">¶</a></p>
<p id="section-5.3.2-5">For example:<a href="#section-5.3.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.2-6">
<pre>
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer realm="example"
</pre><a href="#section-5.3.2-6" class="pilcrow">¶</a>
</div>
<p id="section-5.3.2-7">And in response to a protected resource request with an
authentication attempt using an expired access token:<a href="#section-5.3.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.2-8">
<pre>
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer realm="example",
                  error="invalid_token",
                  error_description="The access token expired"
</pre><a href="#section-5.3.2-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="extensibility">
<section id="section-6">
      <h2 id="name-extensibility">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-extensibility" class="section-name selfRef">Extensibility</a>
      </h2>
<div id="defining-access-token-types">
<section id="section-6.1">
        <h3 id="name-defining-access-token-types">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-defining-access-token-types" class="section-name selfRef">Defining Access Token Types</a>
        </h3>
<p id="section-6.1-1">Access token types can be defined in one of two ways: registered in
the Access Token Types registry (following the procedures in
Section 11.1 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>), or by using a unique absolute URI as its name.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div id="registered-access-token-types">
<section id="section-6.1.1">
          <h4 id="name-registered-access-token-typ">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-registered-access-token-typ" class="section-name selfRef">Registered Access Token Types</a>
          </h4>
<p id="section-6.1.1-1"><span>[<a href="#RFC6750" class="cite xref">RFC6750</a>]</span> establishes a common registry in Section 11.4 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>
for error values to be shared among OAuth token authentication schemes.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">New authentication schemes designed primarily for OAuth token
authentication SHOULD define a mechanism for providing an error
status code to the client, in which the error values allowed are
registered in the error registry established by this specification.<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1.1-3">Such schemes MAY limit the set of valid error codes to a subset of
the registered values.  If the error code is returned using a named
parameter, the parameter name SHOULD be <code>error</code>.<a href="#section-6.1.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1.1-4">Other schemes capable of being used for OAuth token authentication,
but not primarily designed for that purpose, MAY bind their error
values to the registry in the same manner.<a href="#section-6.1.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1.1-5">New authentication schemes MAY choose to also specify the use of the
<code>error_description</code> and <code>error_uri</code> parameters to return error
information in a manner parallel to their usage in this
specification.<a href="#section-6.1.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1.1-6">Type names MUST conform to the
type-name ABNF.  If the type definition includes a new HTTP
authentication scheme, the type name SHOULD be identical to the HTTP
authentication scheme name (as defined by <span>[<a href="#RFC2617" class="cite xref">RFC2617</a>]</span>).  The token type
<code>example</code> is reserved for use in examples.<a href="#section-6.1.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.1-7">
<pre>
type-name  = 1*name-char
name-char  = "-" / "." / "_" / DIGIT / ALPHA
</pre><a href="#section-6.1.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="vendor-specific-access-token-types">
<section id="section-6.1.2">
          <h4 id="name-vendor-specific-access-toke">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-vendor-specific-access-toke" class="section-name selfRef">Vendor-Specific Access Token Types</a>
          </h4>
<p id="section-6.1.2-1">Types utilizing a URI name SHOULD be limited to vendor-specific
implementations that are not commonly applicable, and are specific to
the implementation details of the resource server where they are
used.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2">All other types MUST be registered.<a href="#section-6.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="defining-new-endpoint-parameters">
<section id="section-6.2">
        <h3 id="name-defining-new-endpoint-param">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-defining-new-endpoint-param" class="section-name selfRef">Defining New Endpoint Parameters</a>
        </h3>
<p id="section-6.2-1">New request or response parameters for use with the authorization
endpoint or the token endpoint are defined and registered in the
OAuth Parameters registry following the procedure in Section 11.2 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Parameter names MUST conform to the param-name ABNF, and parameter
values syntax MUST be well-defined (e.g., using ABNF, or a reference
to the syntax of an existing parameter).<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-3">
<pre>
param-name  = 1*name-char
name-char   = "-" / "." / "_" / DIGIT / ALPHA
</pre><a href="#section-6.2-3" class="pilcrow">¶</a>
</div>
<p id="section-6.2-4">Unregistered vendor-specific parameter extensions that are not
commonly applicable and that are specific to the implementation
details of the authorization server where they are used SHOULD
utilize a vendor-specific prefix that is not likely to conflict with
other registered values (e.g., begin with 'companyname_').<a href="#section-6.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="defining-new-authorization-grant-types">
<section id="section-6.3">
        <h3 id="name-defining-new-authorization-">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-defining-new-authorization-" class="section-name selfRef">Defining New Authorization Grant Types</a>
        </h3>
<p id="section-6.3-1">New authorization grant types can be defined by assigning them a
unique absolute URI for use with the <code>grant_type</code> parameter.  If the
extension grant type requires additional token endpoint parameters,
they MUST be registered in the OAuth Parameters registry as described
by Section 11.2 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="new-response-types">
<section id="section-6.4">
        <h3 id="name-defining-new-authorization-e">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-defining-new-authorization-e" class="section-name selfRef">Defining New Authorization Endpoint Response Types</a>
        </h3>
<p id="section-6.4-1">New response types for use with the authorization endpoint are
defined and registered in the Authorization Endpoint Response Types
registry following the procedure in Section 11.3 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.  Response type
names MUST conform to the response-type ABNF.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4-2">
<pre>
response-type  = response-name *( SP response-name )
response-name  = 1*response-char
response-char  = "_" / DIGIT / ALPHA
</pre><a href="#section-6.4-2" class="pilcrow">¶</a>
</div>
<p id="section-6.4-3">If a response type contains one or more space characters (%x20), it
is compared as a space-delimited list of values in which the order of
values does not matter.  Only one order of values can be registered,
which covers all other arrangements of the same set of values.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4">For example, an extension can define and register the <code>code other_token</code>
response type.  Once registered, the same combination cannot be registered
as <code>other_token code</code>, but both values can be used to
denote the same response type.<a href="#section-6.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="defining-additional-error-codes">
<section id="section-6.5">
        <h3 id="name-defining-additional-error-c">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-defining-additional-error-c" class="section-name selfRef">Defining Additional Error Codes</a>
        </h3>
<p id="section-6.5-1">In cases where protocol extensions (i.e., access token types,
extension parameters, or extension grant types) require additional
error codes to be used with the authorization code grant error
response (<a href="#authorization-code-error-response" class="auto internal xref">Section 4.1.2.1</a>), the token error response (<a href="#token-error-response" class="auto internal xref">Section 3.2.4</a>), or the
resource access error response (<a href="#error-response" class="auto internal xref">Section 5.3</a>), such error codes MAY be
defined.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">Extension error codes MUST be registered (following the procedures in
Section 11.4 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>) if the extension they are used in conjunction with is a
registered access token type, a registered endpoint parameter, or an
extension grant type.  Error codes used with unregistered extensions
MAY be registered.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<p id="section-6.5-3">Error codes MUST conform to the error ABNF and SHOULD be prefixed by
an identifying name when possible.  For example, an error identifying
an invalid value set to the extension parameter <code>example</code> SHOULD be
named <code>example_invalid</code>.<a href="#section-6.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.5-4">
<pre>
error      = 1*error-char
error-char = %x20-21 / %x23-5B / %x5D-7E
</pre><a href="#section-6.5-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">As a flexible and extensible framework, OAuth's security
considerations depend on many factors.  The following sections
provide implementers with security guidelines focused on the three
client profiles described in <a href="#client-types" class="auto internal xref">Section 2.1</a>: web application,
browser-based application, and native application.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">A comprehensive OAuth security model and analysis, as well as
background for the protocol design, is provided by
<span>[<a href="#RFC6819" class="cite xref">RFC6819</a>]</span> and <span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span>.<a href="#section-7-2" class="pilcrow">¶</a></p>
<div id="access-token-security-considerations">
<section id="section-7.1">
        <h3 id="name-access-token-security-consi">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-access-token-security-consi" class="section-name selfRef">Access Token Security Considerations</a>
        </h3>
<div id="security-threats">
<section id="section-7.1.1">
          <h4 id="name-security-threats">
<a href="#section-7.1.1" class="section-number selfRef">7.1.1. </a><a href="#name-security-threats" class="section-name selfRef">Security Threats</a>
          </h4>
<p id="section-7.1.1-1">The following list presents several common threats against protocols
utilizing some form of tokens.  This list of threats is based on NIST
Special Publication 800-63 <span>[<a href="#NIST800-63" class="cite xref">NIST800-63</a>]</span>.<a href="#section-7.1.1-1" class="pilcrow">¶</a></p>
<div id="access-token-manufacturemodification">
<section id="section-7.1.1.1">
            <h5 id="name-access-token-manufacture-mo">
<a href="#section-7.1.1.1" class="section-number selfRef">7.1.1.1. </a><a href="#name-access-token-manufacture-mo" class="section-name selfRef">Access token manufacture/modification</a>
            </h5>
<p id="section-7.1.1.1-1">An attacker may generate a bogus
access token or modify the token contents (such as the authentication or
attribute statements) of an existing token, causing the resource
server to grant inappropriate access to the client.  For example,
an attacker may modify the token to extend the validity period; a
malicious client may modify the assertion to gain access to
information that they should not be able to view.<a href="#section-7.1.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="access-token-disclosure">
<section id="section-7.1.1.2">
            <h5 id="name-access-token-disclosure">
<a href="#section-7.1.1.2" class="section-number selfRef">7.1.1.2. </a><a href="#name-access-token-disclosure" class="section-name selfRef">Access token disclosure</a>
            </h5>
<p id="section-7.1.1.2-1">Access tokens may contain authentication and attribute
statements that include sensitive information.<a href="#section-7.1.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="access-token-redirect">
<section id="section-7.1.1.3">
            <h5 id="name-access-token-redirect">
<a href="#section-7.1.1.3" class="section-number selfRef">7.1.1.3. </a><a href="#name-access-token-redirect" class="section-name selfRef">Access token redirect</a>
            </h5>
<p id="section-7.1.1.3-1">An attacker uses an access token generated for consumption
by one resource server to gain access to a different resource
server that mistakenly believes the token to be for it.<a href="#section-7.1.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="access-token-replay">
<section id="section-7.1.1.4">
            <h5 id="name-access-token-replay">
<a href="#section-7.1.1.4" class="section-number selfRef">7.1.1.4. </a><a href="#name-access-token-replay" class="section-name selfRef">Access token replay</a>
            </h5>
<p id="section-7.1.1.4-1">An attacker attempts to use an access token that has already
been used with that resource server in the past.<a href="#section-7.1.1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="threat-mitigation">
<section id="section-7.1.2">
          <h4 id="name-threat-mitigation">
<a href="#section-7.1.2" class="section-number selfRef">7.1.2. </a><a href="#name-threat-mitigation" class="section-name selfRef">Threat Mitigation</a>
          </h4>
<p id="section-7.1.2-1">A large range of threats can be mitigated by protecting the contents
of the access token by using a digital signature.<a href="#section-7.1.2-1" class="pilcrow">¶</a></p>
<p id="section-7.1.2-2">Alternatively, a bearer token can contain a reference to
authorization information, rather than encoding the information
directly.  Using a reference may require an extra interaction between a
resource server and authorization server to resolve the reference to the
authorization information.  The mechanics of such an interaction are
not defined by this specification, but one such mechanism is defined
in Token Introspection <span>[<a href="#RFC7662" class="cite xref">RFC7662</a>]</span>.<a href="#section-7.1.2-2" class="pilcrow">¶</a></p>
<p id="section-7.1.2-3">This document does not specify the encoding or the contents of the
access token; hence, detailed recommendations about the means of
guaranteeing access token integrity protection are outside the scope of this
specification. One example of an encoding and
signing mechanism for access tokens is described in
JSON Web Token Profile for Access Tokens <span>[<a href="#RFC9068" class="cite xref">RFC9068</a>]</span>.<a href="#section-7.1.2-3" class="pilcrow">¶</a></p>
<p id="section-7.1.2-4">To deal with access token redirects, it is important for the authorization
server to include the identity of the intended recipients (the
audience), typically a single resource server (or a list of resource
servers), in the token.  Restricting the use of the token to a
specific scope is also RECOMMENDED.<a href="#section-7.1.2-4" class="pilcrow">¶</a></p>
<p id="section-7.1.2-5">If cookies are transmitted without TLS protection, any
information contained in them is at risk of disclosure.  Therefore,
Bearer tokens MUST NOT be stored in cookies that can be sent in the
clear, as any information in them is at risk of disclosure.
See "HTTP State Management Mechanism" <span>[<a href="#RFC6265" class="cite xref">RFC6265</a>]</span> for security
considerations about cookies.<a href="#section-7.1.2-5" class="pilcrow">¶</a></p>
<p id="section-7.1.2-6">In some deployments, including those utilizing load balancers, the
TLS connection to the resource server terminates prior to the actual
server that provides the resource.  This could leave the token
unprotected between the front-end server where the TLS connection
terminates and the back-end server that provides the resource.  In
such deployments, sufficient measures MUST be employed to ensure
confidentiality of the access token between the front-end and back-end
servers; encryption of the token is one such possible measure.<a href="#section-7.1.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="summary-of-recommendations">
<section id="section-7.1.3">
          <h4 id="name-summary-of-recommendations">
<a href="#section-7.1.3" class="section-number selfRef">7.1.3. </a><a href="#name-summary-of-recommendations" class="section-name selfRef">Summary of Recommendations</a>
          </h4>
<div id="safeguard-bearer-tokens">
<section id="section-7.1.3.1">
            <h5 id="name-safeguard-bearer-tokens">
<a href="#section-7.1.3.1" class="section-number selfRef">7.1.3.1. </a><a href="#name-safeguard-bearer-tokens" class="section-name selfRef">Safeguard bearer tokens</a>
            </h5>
<p id="section-7.1.3.1-1">Client implementations MUST ensure that
bearer tokens are not leaked to unintended parties, as they will
be able to use them to gain access to protected resources.  This
is the primary security consideration when using bearer tokens and
underlies all the more specific recommendations that follow.<a href="#section-7.1.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="validate-tls-certificate-chains">
<section id="section-7.1.3.2">
            <h5 id="name-validate-tls-certificate-ch">
<a href="#section-7.1.3.2" class="section-number selfRef">7.1.3.2. </a><a href="#name-validate-tls-certificate-ch" class="section-name selfRef">Validate TLS certificate chains</a>
            </h5>
<p id="section-7.1.3.2-1">The client MUST validate the TLS
certificate chain when making requests to protected resources.
Failing to do so may enable DNS hijacking attacks to steal the
token and gain unintended access.<a href="#section-7.1.3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="always-use-tls-https">
<section id="section-7.1.3.3">
            <h5 id="name-always-use-tls-https">
<a href="#section-7.1.3.3" class="section-number selfRef">7.1.3.3. </a><a href="#name-always-use-tls-https" class="section-name selfRef">Always use TLS (https)</a>
            </h5>
<p id="section-7.1.3.3-1">Clients MUST always use TLS
(https) or equivalent transport security when making requests with
bearer tokens.  Failing to do so exposes the token to numerous
attacks that could give attackers unintended access.<a href="#section-7.1.3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dont-store-bearer-tokens-in-http-cookies">
<section id="section-7.1.3.4">
            <h5 id="name-dont-store-bearer-tokens-in">
<a href="#section-7.1.3.4" class="section-number selfRef">7.1.3.4. </a><a href="#name-dont-store-bearer-tokens-in" class="section-name selfRef">Don't store bearer tokens in HTTP cookies</a>
            </h5>
<p id="section-7.1.3.4-1">Implementations MUST NOT store
bearer tokens within cookies that can be sent in the clear (which
is the default transmission mode for cookies).  Implementations
that do store bearer tokens in cookies MUST take precautions
against cross-site request forgery.<a href="#section-7.1.3.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issue-short-lived-bearer-tokens">
<section id="section-7.1.3.5">
            <h5 id="name-issue-short-lived-bearer-to">
<a href="#section-7.1.3.5" class="section-number selfRef">7.1.3.5. </a><a href="#name-issue-short-lived-bearer-to" class="section-name selfRef">Issue short-lived bearer tokens</a>
            </h5>
<p id="section-7.1.3.5-1">Authorization servers SHOULD issue
short-lived bearer tokens, particularly when
issuing tokens to clients that run within a web browser or other
environments where information leakage may occur.  Using
short-lived bearer tokens can reduce the impact of them being
leaked.<a href="#section-7.1.3.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issue-scoped-bearer-tokens">
<section id="section-7.1.3.6">
            <h5 id="name-issue-scoped-bearer-tokens">
<a href="#section-7.1.3.6" class="section-number selfRef">7.1.3.6. </a><a href="#name-issue-scoped-bearer-tokens" class="section-name selfRef">Issue scoped bearer tokens</a>
            </h5>
<p id="section-7.1.3.6-1">Authorization servers SHOULD issue bearer tokens
that contain an audience restriction, scoping their use to the
intended relying party or set of relying parties.<a href="#section-7.1.3.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dont-pass-bearer-tokens-in-page-urls">
<section id="section-7.1.3.7">
            <h5 id="name-dont-pass-bearer-tokens-in-">
<a href="#section-7.1.3.7" class="section-number selfRef">7.1.3.7. </a><a href="#name-dont-pass-bearer-tokens-in-" class="section-name selfRef">Don't pass bearer tokens in page URLs</a>
            </h5>
<p id="section-7.1.3.7-1">Bearer tokens MUST NOT be
passed in page URLs (for example, as query string parameters).
Instead, bearer tokens SHOULD be passed in HTTP message headers or
message bodies for which confidentiality measures are taken.
Browsers, web servers, and other software may not adequately
secure URLs in the browser history, web server logs, and other
data structures.  If bearer tokens are passed in page URLs,
attackers might be able to steal them from the history data, logs,
or other unsecured locations.<a href="#section-7.1.3.7-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="access-token-privilege-restriction">
<section id="section-7.1.4">
          <h4 id="name-access-token-privilege-rest">
<a href="#section-7.1.4" class="section-number selfRef">7.1.4. </a><a href="#name-access-token-privilege-rest" class="section-name selfRef">Access Token Privilege Restriction</a>
          </h4>
<p id="section-7.1.4-1">The privileges associated with an access token SHOULD be restricted
to the minimum required for the particular application or use case.
This prevents clients from exceeding the privileges authorized by the
resource owner.  It also prevents users from exceeding their
privileges authorized by the respective security policy.  Privilege
restrictions also help to reduce the impact of access token leakage.<a href="#section-7.1.4-1" class="pilcrow">¶</a></p>
<p id="section-7.1.4-2">In particular, access tokens SHOULD be restricted to certain resource
servers (audience restriction), preferably to a single resource
server.  To put this into effect, the authorization server associates
the access token with certain resource servers and every resource
server is obliged to verify, for every request, whether the access
token sent with that request was meant to be used for that particular
resource server.  If not, the resource server MUST refuse to serve
the respective request.  Clients and authorization servers MAY
utilize the parameters <code>scope</code> or <code>resource</code> as specified in
this document and <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>, respectively, to
determine the resource server they want to access.<a href="#section-7.1.4-2" class="pilcrow">¶</a></p>
<p id="section-7.1.4-3">Additionally, access tokens SHOULD be restricted to certain resources
and actions on resource servers or resources.  To put this into effect,
the authorization server associates the access token with the
respective resource and actions and every resource server is obliged
to verify, for every request, whether the access token sent with that
request was meant to be used for that particular action on the
particular resource.  If not, the resource server must refuse to
serve the respective request.  Clients and authorization servers MAY
utilize the parameter <code>scope</code> and
<code>authorization_details</code> as specified in <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span> to
determine those resources and/or actions.<a href="#section-7.1.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-client-authentication">
<section id="section-7.2">
        <h3 id="name-client-authentication-3">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-client-authentication-3" class="section-name selfRef">Client Authentication</a>
        </h3>
<p id="section-7.2-1">Depending on the overall process of client registration and credential
lifecycle management, this may affect the confidence an authorization
server has in a particular client.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">For example, authentication of a dynamically registered client does not
prove the identity of the client, it only ensures that repeated requests
to the authorization server were made from the same client instance. Such
clients may be limited in terms of which scopes they are allowed to request,
or may have other limitations such as shorter token lifetimes.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">In contrast, if there is a registered application whose developer's identity
was verified, who signed a contract and is issued a client secret
that is only used in a secure backend service, the authorization
server might allow this client to request more sensitive scopes
or to be issued longer-lasting tokens.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-impersonation">
<section id="section-7.3">
        <h3 id="name-client-impersonation">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-client-impersonation" class="section-name selfRef">Client Impersonation</a>
        </h3>
<p id="section-7.3-1">If a confidential client has its credentials stolen,
a malicious client can impersonate the client and obtain access
to protected resources.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">The authorization server SHOULD enforce explicit resource owner
authentication and provide the resource owner with information about
the client and the requested authorization scope and lifetime.  It is
up to the resource owner to review the information in the context of
the current client and to authorize or deny the request.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">The authorization server SHOULD NOT process repeated authorization
requests automatically (without active resource owner interaction)
without authenticating the client or relying on other measures to
ensure that the repeated request comes from the original client and
not an impersonator.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<div id="native-app-client-impersonation">
<section id="section-7.3.1">
          <h4 id="name-impersonation-of-native-app">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-impersonation-of-native-app" class="section-name selfRef">Impersonation of Native Apps</a>
          </h4>
<p id="section-7.3.1-1">As stated above, the authorization
server SHOULD NOT process authorization requests automatically
without user consent or interaction, except when the identity of the
client can be assured.  This includes the case where the user has
previously approved an authorization request for a given client ID --
unless the identity of the client can be proven, the request SHOULD
be processed as if no previous request had been approved.<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
<p id="section-7.3.1-2">Measures such as claimed <code>https</code> scheme redirects MAY be accepted by
authorization servers as identity proof.  Some operating systems may
offer alternative platform-specific identity features that MAY be
accepted, as appropriate.<a href="#section-7.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="access-token-privilege-restriction-1">
<section id="section-7.3.2">
          <h4 id="name-access-token-privilege-restr">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-access-token-privilege-restr" class="section-name selfRef">Access Token Privilege Restriction</a>
          </h4>
<p id="section-7.3.2-1">The client SHOULD request access tokens with the minimal scope
necessary.  The authorization server SHOULD take the client identity
into account when choosing how to honor the requested scope and MAY
issue an access token with fewer scopes than requested.<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
<p id="section-7.3.2-2">The privileges associated with an access token SHOULD be restricted to
the minimum required for the particular application or use case. This
prevents clients from exceeding the privileges authorized by the
resource owner. It also prevents users from exceeding their privileges
authorized by the respective security policy. Privilege restrictions
also help to reduce the impact of access token leakage.<a href="#section-7.3.2-2" class="pilcrow">¶</a></p>
<p id="section-7.3.2-3">In particular, access tokens SHOULD be restricted to certain resource
servers (audience restriction), preferably to a single resource
server. To put this into effect, the authorization server associates
the access token with certain resource servers and every resource
server is obliged to verify, for every request, whether the access
token sent with that request was meant to be used for that particular
resource server. If not, the resource server MUST refuse to serve the
respective request. Clients and authorization servers MAY utilize the
parameters <code>scope</code> or <code>resource</code> as specified in
<span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>, respectively, to determine the
resource server they want to access.<a href="#section-7.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="client-impersonating-resource-owner">
<section id="section-7.4">
        <h3 id="name-client-impersonating-resour">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-client-impersonating-resour" class="section-name selfRef">Client Impersonating Resource Owner</a>
        </h3>
<p id="section-7.4-1">Resource servers may make access control decisions based on the identity of a
resource owner for which an access token was issued, or based on the identity
of a client in the client credentials grant. If both options are possible,
depending on the details of the implementation, a client's identity may be
mistaken for the identity of a resource owner. For example, if a client is able
to choose its own <code>client_id</code> during registration with the authorization server,
a malicious client may set it to a value identifying an end-user (e.g., a <code>sub</code>
value if OpenID Connect is used). If the resource server cannot properly
distinguish between access tokens issued to clients and access tokens issued to
end-users, the client may then be able to access resource of the end-user.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">If the authorization server has a common namespace for client IDs and user
identifiers, causing the resource server to be unable to distinguish an access
token authorized by a resource owner from an access token authorized by a client
itself, authorization servers SHOULD NOT allow clients to influence their <code>client_id</code> or
any other Claim if that can cause confusion with a genuine resource owner. Where
this cannot be avoided, authorization servers MUST provide other means for the
resource server to distinguish between the two types of access tokens.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-code-security-considerations">
<section id="section-7.5">
        <h3 id="name-authorization-code-security">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-authorization-code-security" class="section-name selfRef">Authorization Code Security Considerations</a>
        </h3>
<div id="authorization_codes">
<section id="section-7.5.1">
          <h4 id="name-authorization-code-injectio">
<a href="#section-7.5.1" class="section-number selfRef">7.5.1. </a><a href="#name-authorization-code-injectio" class="section-name selfRef">Authorization Code Injection</a>
          </h4>
<p id="section-7.5.1-1">Authorization code injection is an attack where the client receives an authorization code from the attacker in its redirect URI instead of the authorization code from the legitimate authorization server. Without protections in place, there is no mechanism by which the client can know that the attack has taken place. Authorization code injection can lead to both the attacker obtaining access to a victim's account, as well as a victim accidentally gaining access to the attacker's account.<a href="#section-7.5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="countermeasures">
<section id="section-7.5.2">
          <h4 id="name-countermeasures">
<a href="#section-7.5.2" class="section-number selfRef">7.5.2. </a><a href="#name-countermeasures" class="section-name selfRef">Countermeasures</a>
          </h4>
<p id="section-7.5.2-1">To prevent injection of authorization codes into the client, using <code>code_challenge</code> and
<code>code_verifier</code> is REQUIRED for clients, and authorization servers MUST enforce
their use, unless both of the following criteria are met:<a href="#section-7.5.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.5.2-2.1">
              <p id="section-7.5.2-2.1.1">The client is a confidential client.<a href="#section-7.5.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.5.2-2.2">
              <p id="section-7.5.2-2.2.1">In the specific deployment and the specific request, there is reasonable
assurance by the authorization server that the client implements the OpenID
Connect <code>nonce</code> mechanism properly.<a href="#section-7.5.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-7.5.2-3">In this case, using and enforcing <code>code_challenge</code> and <code>code_verifier</code> is still RECOMMENDED.<a href="#section-7.5.2-3" class="pilcrow">¶</a></p>
<p id="section-7.5.2-4">The <code>code_challenge</code> or OpenID Connect <code>nonce</code> value MUST be
transaction-specific and securely bound to the client and the user agent in
which the transaction was started. If a transaction leads to an error, fresh
values for <code>code_challenge</code> or <code>nonce</code> MUST be chosen.<a href="#section-7.5.2-4" class="pilcrow">¶</a></p>
<p id="section-7.5.2-5">Relying on the client to validate the OpenID Connect <code>nonce</code> parameter
means the authorization server has no way to confirm that the client
has actually protected itself against authorization code injection attacks.
If an attacker is able to inject an authorization code into a client, the
client would still exchange the injected authorization code and obtain tokens, and
would only later reject the ID token after validating the <code>nonce</code> and seeing
that it doesn't match. In contrast, the authorization server enforcing the
<code>code_challenge</code> and <code>code_verifier</code> parameters provides a higher security outcome,
since the authorization server is able to recognize the authorization code
injection attack pre-emtpively and avoid issuing any tokens in the first place.<a href="#section-7.5.2-5" class="pilcrow">¶</a></p>
<p id="section-7.5.2-6">Historic note: Although PKCE <span>[<a href="#RFC7636" class="cite xref">RFC7636</a>]</span>
(where the <code>code_challenge</code> and <code>code_verifier</code> parameters were created)
was originally designed as a mechanism
to protect native apps from authorization code exfiltration attacks,
all kinds of OAuth clients, including web applications and other confidential clients,
are susceptible to authorziation code injection attacks, which are solved by
the <code>code_challenge</code> and <code>code_verifier</code> mechanism.<a href="#section-7.5.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-code-reuse">
<section id="section-7.5.3">
          <h4 id="name-reuse-of-authorization-code">
<a href="#section-7.5.3" class="section-number selfRef">7.5.3. </a><a href="#name-reuse-of-authorization-code" class="section-name selfRef">Reuse of Authorization Codes</a>
          </h4>
<p id="section-7.5.3-1">Several types of attacks are possible if authorization codes are able to be
used more than once.<a href="#section-7.5.3-1" class="pilcrow">¶</a></p>
<p id="section-7.5.3-2">As described in <a href="#code-token-extension" class="auto internal xref">Section 4.1.3</a>, the authorization server must reject
a token request and revoke any issued tokens when receiving a second valid
request with an authorization code that has already been used to
issue an access token. If an attacker is able to exfiltrate an authorization code
and use it before the legitimate client, the attacker will obtain the access token
and the legitimate client will not. Revoking any issued tokens means the attacker's
tokens will then be revoked, stopping the attack from proceeding any further.<a href="#section-7.5.3-2" class="pilcrow">¶</a></p>
<p id="section-7.5.3-3">However, the authorization server should only revoke issued tokens if the
request containing the authorization code is also valid, including any other parameters
such as the <code>code_verifier</code> and client authentication. The authorization server
SHOULD NOT revoke any issued tokens when receiving a replayed authorization code
that contains invalid parameters. If it were to do so, this would create a denial of service
opportunity for an attacker who is able to obtain an authorization code but
unable to obtain the client authentication or <code>code_verifier</code> by sending an invalid
authorization code request before the legitimate client and thereby revoking
the legitimate client's tokens once it makes the valid request.<a href="#section-7.5.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="redirect_307">
<section id="section-7.5.4">
          <h4 id="name-http-307-redirect">
<a href="#section-7.5.4" class="section-number selfRef">7.5.4. </a><a href="#name-http-307-redirect" class="section-name selfRef">HTTP 307 Redirect</a>
          </h4>
<p id="section-7.5.4-1">An authorization server which redirects a request that potentially contains user
credentials MUST NOT use the 307 status code (Section 15.4.8 of <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>) for
redirection.
If an HTTP redirection (and not, for example,
JavaScript) is used for such a request, AS SHOULD use the status
code 303 ("See Other").<a href="#section-7.5.4-1" class="pilcrow">¶</a></p>
<p id="section-7.5.4-2">At the authorization endpoint, a typical protocol flow is that the AS
prompts the user to enter their credentials in a form that is then
submitted (using the POST method) back to the authorization
server.  The AS checks the credentials and, if successful, redirects
the user agent to the client's redirect URI.<a href="#section-7.5.4-2" class="pilcrow">¶</a></p>
<p id="section-7.5.4-3">If the status code 307 were used for redirection, the user agent
would send the user credentials via a POST request to the client.<a href="#section-7.5.4-3" class="pilcrow">¶</a></p>
<p id="section-7.5.4-4">This discloses the sensitive credentials to the client.  If the
relying party is malicious, it can use the credentials to impersonate
the user at the AS.<a href="#section-7.5.4-4" class="pilcrow">¶</a></p>
<p id="section-7.5.4-5">The behavior might be unexpected for developers, but is defined in
Section 15.4.8 of <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>.  This status code does not require the user
agent to rewrite the POST request to a GET request and thereby drop
the form data in the POST request content.<a href="#section-7.5.4-5" class="pilcrow">¶</a></p>
<p id="section-7.5.4-6">In HTTP <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>, only the status code 303
unambigiously enforces rewriting the HTTP POST request to an HTTP GET
request.  For all other status codes, including the popular 302, user
agents can opt not to rewrite POST to GET requests and therefore
reveal the user credentials to the client.  (In practice, however,
most user agents will only show this behaviour for 307 redirects.)<a href="#section-7.5.4-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ensuring-endpoint-authenticity">
<section id="section-7.6">
        <h3 id="name-ensuring-endpoint-authentic">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-ensuring-endpoint-authentic" class="section-name selfRef">Ensuring Endpoint Authenticity</a>
        </h3>
<p id="section-7.6-1">The risk related to man-in-the-middle attacks is mitigated by the
mandatory use of channel security mechanisms such as <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>
for communicating with the Authorization and Token Endpoints.
See <a href="#communication-security" class="auto internal xref">Section 1.5</a> for further details.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credentials-guessing-attacks">
<section id="section-7.7">
        <h3 id="name-credentials-guessing-attack">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-credentials-guessing-attack" class="section-name selfRef">Credentials-Guessing Attacks</a>
        </h3>
<p id="section-7.7-1">The authorization server MUST prevent attackers from guessing access
tokens, authorization codes, refresh tokens, resource owner
passwords, and client credentials.<a href="#section-7.7-1" class="pilcrow">¶</a></p>
<p id="section-7.7-2">The probability of an attacker guessing generated tokens (and other
credentials not intended for handling by end-users) MUST be less than
or equal to 2^(-128) and SHOULD be less than or equal to 2^(-160).<a href="#section-7.7-2" class="pilcrow">¶</a></p>
<p id="section-7.7-3">The authorization server MUST utilize other means to protect
credentials intended for end-user usage.<a href="#section-7.7-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="phishing-attacks">
<section id="section-7.8">
        <h3 id="name-phishing-attacks">
<a href="#section-7.8" class="section-number selfRef">7.8. </a><a href="#name-phishing-attacks" class="section-name selfRef">Phishing Attacks</a>
        </h3>
<p id="section-7.8-1">Wide deployment of this and similar protocols may cause end-users to
become inured to the practice of being redirected to websites where
they are asked to enter their passwords.  If end-users are not
careful to verify the authenticity of these websites before entering
their credentials, it will be possible for attackers to exploit this
practice to steal resource owners' passwords.<a href="#section-7.8-1" class="pilcrow">¶</a></p>
<p id="section-7.8-2">Service providers should attempt to educate end-users about the risks
phishing attacks pose and should provide mechanisms that make it easy
for end-users to confirm the authenticity of their sites.  Client
developers should consider the security implications of how they
interact with the user agent (e.g., external, embedded), and the
ability of the end-user to verify the authenticity of the
authorization server.<a href="#section-7.8-2" class="pilcrow">¶</a></p>
<p id="section-7.8-3">See <a href="#communication-security" class="auto internal xref">Section 1.5</a> for further details
on mitigating the risk of phishing attacks.<a href="#section-7.8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="csrf_countermeasures">
<section id="section-7.9">
        <h3 id="name-cross-site-request-forgery">
<a href="#section-7.9" class="section-number selfRef">7.9. </a><a href="#name-cross-site-request-forgery" class="section-name selfRef">Cross-Site Request Forgery</a>
        </h3>
<p id="section-7.9-1">An attacker might attempt to inject a request to the redirect URI of
the legitimate client on the victim's device, e.g., to cause the
client to access resources under the attacker's control. This is a
variant of an attack known as Cross-Site Request Forgery (CSRF).<a href="#section-7.9-1" class="pilcrow">¶</a></p>
<p id="section-7.9-2">The traditional countermeasure is that clients pass a random value, also
known as a CSRF Token, in the <code>state</code> parameter that links the request to
the redirect URI to the user agent session as described. This
countermeasure is described in detail in <span>[<a href="#RFC6819" class="cite xref">RFC6819</a>]</span>, Section 5.3.5. The
same protection is provided by the <code>code_verifier</code> parameter or the
OpenID Connect <code>nonce</code> value.<a href="#section-7.9-2" class="pilcrow">¶</a></p>
<p id="section-7.9-3">When using <code>code_verifier</code> instead of <code>state</code> or <code>nonce</code> for CSRF protection, it is
important to note that:<a href="#section-7.9-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.9-4.1">
            <p id="section-7.9-4.1.1">Clients MUST ensure that the AS supports the <code>code_challenge_method</code>
intended to be used by the client. If an authorization server does not support the requested method,
<code>state</code> or <code>nonce</code> MUST be used for CSRF protection instead.<a href="#section-7.9-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.9-4.2">
            <p id="section-7.9-4.2.1">If <code>state</code> is used for carrying application state, and integrity of
its contents is a concern, clients MUST protect <code>state</code> against
tampering and swapping. This can be achieved by binding the
contents of state to the browser session and/or signed/encrypted
state values <span>[<a href="#I-D.bradley-oauth-jwt-encoded-state" class="cite xref">I-D.bradley-oauth-jwt-encoded-state</a>]</span>.<a href="#section-7.9-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.9-5">AS therefore MUST provide a way to detect their supported code challenge methods
either via AS metadata according to <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span> or provide a
deployment-specific way to ensure or determine support.<a href="#section-7.9-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="clickjacking">
<section id="section-7.10">
        <h3 id="name-clickjacking">
<a href="#section-7.10" class="section-number selfRef">7.10. </a><a href="#name-clickjacking" class="section-name selfRef">Clickjacking</a>
        </h3>
<p id="section-7.10-1">As described in Section 4.4.1.9 of <span>[<a href="#RFC6819" class="cite xref">RFC6819</a>]</span>, the authorization
request is susceptible to clickjacking attacks, also called user
interface redressing. In such an attack, an attacker embeds the
authorization endpoint user interface in an innocuous context.
A user believing to interact with that context, for example,
clicking on buttons, inadvertently interacts with the authorization
endpoint user interface instead. The opposite can be achieved as
well: A user believing to interact with the authorization endpoint
might inadvertently type a password into an attacker-provided
input field overlaid over the original user interface. Clickjacking
attacks can be designed such that users can hardly notice the attack,
for example using almost invisible iframes overlaid on top of
other elements.<a href="#section-7.10-1" class="pilcrow">¶</a></p>
<p id="section-7.10-2">An attacker can use this vector to obtain the user's authentication
credentials, change the scope of access granted to the client,
and potentially access the user's resources.<a href="#section-7.10-2" class="pilcrow">¶</a></p>
<p id="section-7.10-3">Authorization servers MUST prevent clickjacking attacks. Multiple
countermeasures are described in <span>[<a href="#RFC6819" class="cite xref">RFC6819</a>]</span>, including the use of the
<code>X-Frame-Options</code> HTTP response header field and frame-busting
JavaScript. In addition to those, authorization servers SHOULD also
use Content Security Policy (CSP) level 2 <span>[<a href="#CSP-2" class="cite xref">CSP-2</a>]</span> or greater.<a href="#section-7.10-3" class="pilcrow">¶</a></p>
<p id="section-7.10-4">To be effective, CSP must be used on the authorization endpoint and,
if applicable, other endpoints used to authenticate the user and
authorize the client (e.g., the device authorization endpoint, login
pages, error pages, etc.). This prevents framing by unauthorized
origins in user agents that support CSP. The client MAY permit being
framed by some other origin than the one used in its redirection
endpoint. For this reason, authorization servers SHOULD allow
administrators to configure allowed origins for particular clients
and/or for clients to register these dynamically.<a href="#section-7.10-4" class="pilcrow">¶</a></p>
<p id="section-7.10-5">Using CSP allows authorization servers to specify multiple origins in
a single response header field and to constrain these using flexible
patterns (see <span>[<a href="#CSP-2" class="cite xref">CSP-2</a>]</span> for details). Level 2 of this standard provides
a robust mechanism for protecting against clickjacking by using
policies that restrict the origin of frames (using <code>frame-ancestors</code>)
together with those that restrict the sources of scripts allowed to
execute on an HTML page (by using <code>script-src</code>). A non-normative
example of such a policy is shown in the following listing:<a href="#section-7.10-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.10-6">
<pre>
HTTP/1.1 200 OK
Content-Security-Policy: frame-ancestors https://ext.example.org:8000
Content-Security-Policy: script-src 'self'
X-Frame-Options: ALLOW-FROM https://ext.example.org:8000
...
</pre><a href="#section-7.10-6" class="pilcrow">¶</a>
</div>
<p id="section-7.10-7">Because some user agents do not support <span>[<a href="#CSP-2" class="cite xref">CSP-2</a>]</span>, this technique
SHOULD be combined with others, including those described in
<span>[<a href="#RFC6819" class="cite xref">RFC6819</a>]</span>, unless such legacy user agents are explicitly unsupported
by the authorization server. Even in such cases, additional
countermeasures SHOULD still be employed.<a href="#section-7.10-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="code-injection-and-input-validation">
<section id="section-7.11">
        <h3 id="name-code-injection-and-input-va">
<a href="#section-7.11" class="section-number selfRef">7.11. </a><a href="#name-code-injection-and-input-va" class="section-name selfRef">Code Injection and Input Validation</a>
        </h3>
<p id="section-7.11-1">A code injection attack occurs when an input or otherwise external
variable is used by an application unsanitized and causes
modification to the application logic.  This may allow an attacker to
gain access to the application device or its data, cause denial of
service, or introduce a wide range of malicious side-effects.<a href="#section-7.11-1" class="pilcrow">¶</a></p>
<p id="section-7.11-2">The authorization server and client MUST sanitize (and validate when
possible) any value received -- in particular, the value of the
<code>state</code> and <code>redirect_uri</code> parameters.<a href="#section-7.11-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="open-redirectors">
<section id="section-7.12">
        <h3 id="name-open-redirection">
<a href="#section-7.12" class="section-number selfRef">7.12. </a><a href="#name-open-redirection" class="section-name selfRef">Open Redirection</a>
        </h3>
<p id="section-7.12-1">An open redirector is an endpoint that forwards a user's browser
to an arbitrary URI obtained from a query parameter.
Such endpoints are sometimes implemented, for example, to show a
message before a user is then redirected to an external website,
or to redirect users back to a URL they were intending to visit
before being interrupted, e.g., by a login prompt.<a href="#section-7.12-1" class="pilcrow">¶</a></p>
<p id="section-7.12-2">The following attacks can occur when an AS or client has an open
redirector.<a href="#section-7.12-2" class="pilcrow">¶</a></p>
<div id="open_redirector_on_client">
<section id="section-7.12.1">
          <h4 id="name-client-as-open-redirector">
<a href="#section-7.12.1" class="section-number selfRef">7.12.1. </a><a href="#name-client-as-open-redirector" class="section-name selfRef">Client as Open Redirector</a>
          </h4>
<p id="section-7.12.1-1">Clients MUST NOT expose open redirectors. Attackers may use open
redirectors to produce URLs pointing to the client and utilize them to
exfiltrate authorization codes, as described in
Section 4.1.1 of <span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span>.
Another abuse case is to produce URLs that appear to point to the client.
This might trick users into trusting the URL and follow it in their browser.
This can be abused for phishing.<a href="#section-7.12.1-1" class="pilcrow">¶</a></p>
<p id="section-7.12.1-2">In order to prevent open redirection, clients should only redirect if
the target URLs are whitelisted or if the origin and integrity of a
request can be authenticated. Countermeasures against open redirection
are described by OWASP <span>[<a href="#owasp_redir" class="cite xref">owasp_redir</a>]</span>.<a href="#section-7.12.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-server-as-open-redirector">
<section id="section-7.12.2">
          <h4 id="name-authorization-server-as-ope">
<a href="#section-7.12.2" class="section-number selfRef">7.12.2. </a><a href="#name-authorization-server-as-ope" class="section-name selfRef">Authorization Server as Open Redirector</a>
          </h4>
<p id="section-7.12.2-1">Just as with clients, attackers could try to utilize a user's trust in
the authorization server (and its URL in particular) for performing
phishing attacks. OAuth authorization servers regularly redirect users
to other web sites (the clients), but must do so in a safe way.<a href="#section-7.12.2-1" class="pilcrow">¶</a></p>
<p id="section-7.12.2-2"><a href="#authorization-code-error-response" class="auto internal xref">Section 4.1.2.1</a> already prevents open redirects by
stating that the AS MUST NOT automatically redirect the user agent in case
of an invalid combination of <code>client_id</code> and <code>redirect_uri</code>.<a href="#section-7.12.2-2" class="pilcrow">¶</a></p>
<p id="section-7.12.2-3">However, an attacker could also utilize a correctly registered
redirect URI to perform phishing attacks. The attacker could, for
example, register a client via dynamic client registration <span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span>
and execute one of the following attacks:<a href="#section-7.12.2-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.12.2-4">
<li id="section-7.12.2-4.1">
              <p id="section-7.12.2-4.1.1">Intentionally send an erroneous authorization request, e.g., by
 using an invalid scope value, thus instructing the AS to redirect the
 user-agent to its phishing site.<a href="#section-7.12.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.12.2-4.2">
              <p id="section-7.12.2-4.2.1">Intentionally send a valid authorization request with <code>client_id</code>
 and <code>redirect_uri</code> controlled by the attacker. After the user authenticates,
 the AS prompts the user to provide consent to the request. If the user
 notices an issue with the request and declines the request, the AS still
 redirects the user agent to the phishing site. In this case, the user agent
 will be redirected to the phishing site regardless of the action taken by
 the user.<a href="#section-7.12.2-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.12.2-4.3">
              <p id="section-7.12.2-4.3.1">Intentionally send a valid silent authentication request (<code>prompt=none</code>)
 with <code>client_id</code> and <code>redirect_uri</code> controlled by the attacker. In this case,
 the AS will automatically redirect the user agent to the phishing site.<a href="#section-7.12.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-7.12.2-5">The AS MUST take precautions to prevent these threats. The AS MUST always
authenticate the user first and, with the exception of the silent authentication
use case, prompt the user for credentials when needed, before redirecting the
user. Based on its risk assessment, the AS needs to decide whether it can trust
the redirect URI or not. It could take into account  URI analytics done
internally or through some external service to evaluate the credibility and
trustworthiness content behind the URI, and the source of the redirect URI and
other client data.<a href="#section-7.12.2-5" class="pilcrow">¶</a></p>
<p id="section-7.12.2-6">The AS SHOULD only automatically redirect the user agent if it trusts the
redirect URI.  If the URI is not trusted, the AS MAY inform the user and rely on
the user to make the correct decision.<a href="#section-7.12.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="mix-up">
<section id="section-7.13">
        <h3 id="name-authorization-server-mix-up">
<a href="#section-7.13" class="section-number selfRef">7.13. </a><a href="#name-authorization-server-mix-up" class="section-name selfRef">Authorization Server Mix-Up Mitigation</a>
        </h3>
<p id="section-7.13-1">Mix-up is an attack on scenarios where an OAuth client interacts with
two or more authorization servers and at least one authorization
server is under the control of the attacker. This can be the case,
for example, if the attacker uses dynamic registration to register the
client at his own authorization server or if an authorization server
becomes compromised.<a href="#section-7.13-1" class="pilcrow">¶</a></p>
<p id="section-7.13-2">When an OAuth client can only interact with one authorization server, a mix-up
defense is not required. In scenarios where an OAuth client interacts with two
or more authorization servers, however, clients MUST prevent mix-up attacks. Two
different methods are discussed in the following.<a href="#section-7.13-2" class="pilcrow">¶</a></p>
<p id="section-7.13-3">For both defenses, clients MUST store, for each authorization request, the
issuer they sent the authorization request to, bind this information to the
user agent, and check that the authorization response was received from the
correct issuer. Clients MUST ensure that the subsequent access token request,
if applicable, is sent to the same issuer. The issuer serves, via the associated
metadata, as an abstract identifier for the combination of the authorization
endpoint and token endpoint that are to be used in the flow. If an issuer identifier
is not available, for example, if neither OAuth metadata <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span> nor OpenID
Connect Discovery <span>[<a href="#OpenID.Discovery" class="cite xref">OpenID.Discovery</a>]</span> are used, a different unique identifier
for this tuple or the tuple itself can be used instead. For brevity of presentation,
such a deployment-specific identifier will be subsumed under the issuer (or
issuer identifier) in the following.<a href="#section-7.13-3" class="pilcrow">¶</a></p>
<p id="section-7.13-4">Note: Just storing the authorization server URL is not sufficient to identify
mix-up attacks. An attacker might declare an uncompromised AS's authorization endpoint URL as
"their" AS URL, but declare a token endpoint under their own control.<a href="#section-7.13-4" class="pilcrow">¶</a></p>
<p id="section-7.13-5">See Section 4.4 of <span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span> for a detailed description
of several types of mix-up attacks.<a href="#section-7.13-5" class="pilcrow">¶</a></p>
<div id="mix-up-defense-via-issuer-identification">
<section id="section-7.13.1">
          <h4 id="name-mix-up-defense-via-issuer-i">
<a href="#section-7.13.1" class="section-number selfRef">7.13.1. </a><a href="#name-mix-up-defense-via-issuer-i" class="section-name selfRef">Mix-Up Defense via Issuer Identification</a>
          </h4>
<p id="section-7.13.1-1">This defense requires that the authorization server sends his issuer identifier
in the authorization response to the client. When receiving the authorization
response, the client MUST compare the received issuer identifier to the stored
issuer identifier. If there is a mismatch, the client MUST abort the
interaction.<a href="#section-7.13.1-1" class="pilcrow">¶</a></p>
<p id="section-7.13.1-2">There are different ways this issuer identifier can be transported to the client:<a href="#section-7.13.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.13.1-3.1">
              <p id="section-7.13.1-3.1.1">The issuer information can be transported, for
example, via an optional response parameter <code>iss</code> (see <a href="#authorization-response" class="auto internal xref">Section 4.1.2</a>).<a href="#section-7.13.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.13.1-3.2">
              <p id="section-7.13.1-3.2.1">When OpenID Connect is used and an ID Token is returned in the authorization
response, the client can evaluate the <code>iss</code> claim in the ID Token.<a href="#section-7.13.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-7.13.1-4">In both cases, the <code>iss</code> value MUST be evaluated according to <span>[<a href="#RFC9207" class="cite xref">RFC9207</a>]</span>.<a href="#section-7.13.1-4" class="pilcrow">¶</a></p>
<p id="section-7.13.1-5">While this defense may require using an additional parameter to transport the
issuer information, it is a robust and relatively simple defense against mix-up.<a href="#section-7.13.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mix-up-defense-via-distinct-redirect-uris">
<section id="section-7.13.2">
          <h4 id="name-mix-up-defense-via-distinct">
<a href="#section-7.13.2" class="section-number selfRef">7.13.2. </a><a href="#name-mix-up-defense-via-distinct" class="section-name selfRef">Mix-Up Defense via Distinct Redirect URIs</a>
          </h4>
<p id="section-7.13.2-1">For this defense, clients MUST use a distinct redirect URI for each issuer
they interact with.<a href="#section-7.13.2-1" class="pilcrow">¶</a></p>
<p id="section-7.13.2-2">Clients MUST check that the authorization response was received from the correct
issuer by comparing the distinct redirect URI for the issuer to the URI where
the authorization response was received on. If there is a mismatch, the client
MUST abort the flow.<a href="#section-7.13.2-2" class="pilcrow">¶</a></p>
<p id="section-7.13.2-3">While this defense builds upon existing OAuth functionality, it cannot be used
in scenarios where clients only register once for the use of many different
issuers (as in some open banking schemes) and due to the tight integration with
the client registration, it is harder to deploy automatically.<a href="#section-7.13.2-3" class="pilcrow">¶</a></p>
<p id="section-7.13.2-4">Furthermore, an attacker might be able to circumvent the protection offered by
this defense by registering a new client with the "honest" AS using the redirect
URI that the client assigned to the attacker's AS. The attacker could then run
the attack as described above, replacing the
client ID with the client ID of his newly created client.<a href="#section-7.13.2-4" class="pilcrow">¶</a></p>
<p id="section-7.13.2-5">This defense SHOULD therefore only be used if other options are not available.<a href="#section-7.13.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="native-applications">
<section id="section-8">
      <h2 id="name-native-applications">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-native-applications" class="section-name selfRef">Native Applications</a>
      </h2>
<p id="section-8-1">Native applications are clients installed and executed on the device
used by the resource owner (i.e., desktop application, native mobile
application).  Native applications require special consideration
related to security, platform capabilities, and overall end-user
experience.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The authorization endpoint requires interaction between the client
and the resource owner's user agent. The best current practice is to
perform the OAuth authorization request in an external user agent
(typically the browser) rather than an embedded user agent (such as
one implemented with web-views).<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">The native application can capture the
response from the authorization server using a redirect URI
with a scheme registered with the operating system to invoke the
client as the handler, manual copy-and-paste of the credentials,
running a local web server, installing a user agent extension, or
by providing a redirect URI identifying a server-hosted
resource under the client's control, which in turn makes the
response available to the native application.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">Previously, it was common for native apps to use embedded user agents
(commonly implemented with web-views) for OAuth authorization
requests.  That approach has many drawbacks, including the host app
being able to copy user credentials and cookies as well as the user
needing to authenticate from scratch in each app.  See <a href="#native-apps-embedded-user-agents" class="auto internal xref">Section 8.5.1</a>
for a deeper analysis of the drawbacks of using embedded user agents
for OAuth.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">Native app authorization requests that use the system browser are more
secure and can take advantage of the user's authentication state on the device.
Being able to use the existing authentication session in the browser
enables single sign-on, as users don't need to authenticate to the
authorization server each time they use a new app (unless required by
the authorization server policy).<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">Supporting authorization flows between a native app and the browser
is possible without changing the OAuth protocol itself, as the OAuth
authorization request and response are already defined in terms of
URIs.  This encompasses URIs that can be used for inter-app
communication.  Some OAuth server implementations that assume all
clients are confidential web clients will need to add an
understanding of public native app clients and the types of redirect
URIs they use to support this best practice.<a href="#section-8-6" class="pilcrow">¶</a></p>
<div id="native-app-registration">
<section id="section-8.1">
        <h3 id="name-registration-of-native-app-">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-registration-of-native-app-" class="section-name selfRef">Registration of Native App Clients</a>
        </h3>
<p id="section-8.1-1">Except when using a mechanism like Dynamic Client Registration
<span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span> to provision per-instance secrets, native apps are
classified as public clients, as defined in <a href="#client-types" class="auto internal xref">Section 2.1</a>;
they MUST be registered with the authorization server as
such.  Authorization servers MUST record the client type in the
client registration details in order to identify and process requests
accordingly.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<div id="client-authentication-of-native-apps">
<section id="section-8.1.1">
          <h4 id="name-client-authentication-of-na">
<a href="#section-8.1.1" class="section-number selfRef">8.1.1. </a><a href="#name-client-authentication-of-na" class="section-name selfRef">Client Authentication of Native Apps</a>
          </h4>
<p id="section-8.1.1-1">Secrets that are statically included as part of an app distributed to
multiple users should not be treated as confidential secrets, as one
user may inspect their copy and learn the shared secret.  For this
reason, it is NOT
RECOMMENDED for authorization servers to require client
authentication of public native apps clients using a shared secret,
as this serves little value beyond client identification which is
already provided by the <code>client_id</code> request parameter.<a href="#section-8.1.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1.1-2">Authorization servers that still require a statically included shared
secret for native app clients MUST treat the client as a public
client (as defined in <a href="#client-types" class="auto internal xref">Section 2.1</a>), and not
accept the secret as proof of the client's identity.  Without
additional measures, such clients are subject to client impersonation
(see <a href="#native-app-client-impersonation" class="auto internal xref">Section 7.3.1</a>).<a href="#section-8.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="using-inter-app-uri-communication-for-oauth-in-native-apps">
<section id="section-8.2">
        <h3 id="name-using-inter-app-uri-communi">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-using-inter-app-uri-communi" class="section-name selfRef">Using Inter-App URI Communication for OAuth in Native Apps</a>
        </h3>
<p id="section-8.2-1">Just as URIs are used for OAuth on the web to initiate
the authorization request and return the authorization response to
the requesting website, URIs can be used by native apps to initiate
the authorization request in the device's browser and return the
response to the requesting native app.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">By adopting the same methods used on the web for OAuth, benefits seen
in the web context like the usability of a single sign-on session and
the security of a separate authentication context are likewise gained
in the native app context.  Reusing the same approach also reduces
the implementation complexity and increases interoperability by
relying on standards-based web flows that are not specific to a
particular platform.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">Native apps MUST use an external
user agent to perform OAuth authorization requests.  This is achieved
by opening the authorization request in the browser (detailed in
<a href="#authorization-request-native-app" class="auto internal xref">Section 8.3</a>) and using a redirect URI that will return the
authorization response back to the native app (defined in <a href="#authorization-response-native-app" class="auto internal xref">Section 8.4</a>).<a href="#section-8.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-request-native-app">
<section id="section-8.3">
        <h3 id="name-initiating-the-authorizatio">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-initiating-the-authorizatio" class="section-name selfRef">Initiating the Authorization Request from a Native App</a>
        </h3>
<p id="section-8.3-1">Native apps needing user authorization create an authorization
request URI with the authorization code grant type per <a href="#authorization-code-grant" class="auto internal xref">Section 4.1</a>
using a redirect URI capable of being received by the native app.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">The function of the redirect URI for a native app authorization
request is similar to that of a web-based authorization request.
Rather than returning the authorization response to the OAuth
client's server, the redirect URI used by a native app returns the
response to the app.  Several options for a redirect URI that will
return the authorization response to the native app in different
platforms are documented in <a href="#authorization-response-native-app" class="auto internal xref">Section 8.4</a>.  Any redirect URI that allows
the app to receive the URI and inspect its parameters is viable.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
<p id="section-8.3-3">After constructing the authorization request URI, the app uses
platform-specific APIs to open the URI in an external user agent.
Typically, the external user agent used is the default browser, that
is, the application configured for handling <code>http</code> and <code>https</code> scheme
URIs on the system; however, different browser selection criteria and
other categories of external user agents MAY be used.<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<p id="section-8.3-4">This best practice focuses on the browser as the RECOMMENDED external
user agent for native apps.  An external user agent designed
specifically for user authorization and capable of processing
authorization requests and responses like a browser MAY also be used.
Other external user agents, such as a native app provided by the
authorization server may meet the criteria set out in this best
practice, including using the same redirect URI properties, but
their use is out of scope for this specification.<a href="#section-8.3-4" class="pilcrow">¶</a></p>
<p id="section-8.3-5">Some platforms support a browser feature known as "in-app browser
tabs", where an app can present a tab of the browser within the app
context without switching apps, but still retain key benefits of the
browser such as a shared authentication state and security context.
On platforms where they are supported, it is RECOMMENDED, for
usability reasons, that apps use in-app browser tabs for the
authorization request.<a href="#section-8.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-response-native-app">
<section id="section-8.4">
        <h3 id="name-receiving-the-authorization">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-receiving-the-authorization" class="section-name selfRef">Receiving the Authorization Response in a Native App</a>
        </h3>
<p id="section-8.4-1">There are several redirect URI options available to native apps for
receiving the authorization response from the browser, the
availability and user experience of which varies by platform.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<div id="claimed-https-scheme-uri-redirection">
<section id="section-8.4.1">
          <h4 id="name-claimed-https-scheme-uri-re">
<a href="#section-8.4.1" class="section-number selfRef">8.4.1. </a><a href="#name-claimed-https-scheme-uri-re" class="section-name selfRef">Claimed "https" Scheme URI Redirection</a>
          </h4>
<p id="section-8.4.1-1">Some operating systems allow apps to claim <code>https</code> URIs
(see Section 4.2.2 of <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>)
in the domains they control.  When the browser encounters a
claimed URI, instead of the page being loaded in the browser, the
native app is launched with the URI supplied as a launch parameter.<a href="#section-8.4.1-1" class="pilcrow">¶</a></p>
<p id="section-8.4.1-2">Such URIs can be used as redirect URIs by native apps.  They are
indistinguishable to the authorization server from a regular web-
based client redirect URI.  An example is:<a href="#section-8.4.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4.1-3">
<pre>
https://app.example.com/oauth2redirect/example-provider
</pre><a href="#section-8.4.1-3" class="pilcrow">¶</a>
</div>
<p id="section-8.4.1-4">As the redirect URI alone is not enough to distinguish public native
app clients from confidential web clients, it is REQUIRED in
<a href="#native-app-registration" class="auto internal xref">Section 8.1</a> that the client type be recorded during client
registration to enable the server to determine the client type and
act accordingly.<a href="#section-8.4.1-4" class="pilcrow">¶</a></p>
<p id="section-8.4.1-5">App-claimed <code>https</code> scheme redirect URIs have some advantages
compared to other native app redirect options in that the identity of
the destination app is guaranteed to the authorization server by the
operating system.  For this reason, native apps SHOULD use them over
the other options where possible.<a href="#section-8.4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="loopback-interface-redirection">
<section id="section-8.4.2">
          <h4 id="name-loopback-interface-redirect">
<a href="#section-8.4.2" class="section-number selfRef">8.4.2. </a><a href="#name-loopback-interface-redirect" class="section-name selfRef">Loopback Interface Redirection</a>
          </h4>
<p id="section-8.4.2-1">Native apps that are able to open a port on the loopback network
interface without needing special permissions (typically, those on
desktop operating systems) can use the loopback interface to receive
the OAuth redirect.<a href="#section-8.4.2-1" class="pilcrow">¶</a></p>
<p id="section-8.4.2-2">Loopback redirect URIs use the <code>http</code> scheme and are constructed with
the loopback IP literal and whatever port the client is listening on.<a href="#section-8.4.2-2" class="pilcrow">¶</a></p>
<p id="section-8.4.2-3">That is, <code>http://127.0.0.1:{port}/{path}</code> for IPv4, and
<code>http://[::1]:{port}/{path}</code> for IPv6.  An example redirect using the
IPv4 loopback interface with a randomly assigned port:<a href="#section-8.4.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4.2-4">
<pre>
http://127.0.0.1:51004/oauth2redirect/example-provider
</pre><a href="#section-8.4.2-4" class="pilcrow">¶</a>
</div>
<p id="section-8.4.2-5">An example redirect using the IPv6 loopback interface with a randomly
assigned port:<a href="#section-8.4.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4.2-6">
<pre>
http://[::1]:61023/oauth2redirect/example-provider
</pre><a href="#section-8.4.2-6" class="pilcrow">¶</a>
</div>
<p id="section-8.4.2-7">While redirect URIs using the name <code>localhost</code> (i.e.,
<code>http://localhost:{port}/{path}</code>) function similarly to loopback IP
redirects, the use of <code>localhost</code> is NOT RECOMMENDED.  Specifying a
redirect URI with the loopback IP literal
rather than <code>localhost</code> avoids inadvertently listening on network
interfaces other than the loopback interface.  It is also less
susceptible to client-side firewalls and misconfigured host name
resolution on the user's device.<a href="#section-8.4.2-7" class="pilcrow">¶</a></p>
<p id="section-8.4.2-8">The authorization server MUST allow any port to be specified at the
time of the request for loopback IP redirect URIs, to accommodate
clients that obtain an available ephemeral port from the operating
system at the time of the request.<a href="#section-8.4.2-8" class="pilcrow">¶</a></p>
<p id="section-8.4.2-9">Clients SHOULD NOT assume that the device supports a particular
version of the Internet Protocol.  It is RECOMMENDED that clients
attempt to bind to the loopback interface using both IPv4 and IPv6
and use whichever is available.<a href="#section-8.4.2-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="private-use-uri-scheme">
<section id="section-8.4.3">
          <h4 id="name-private-use-uri-scheme-redi">
<a href="#section-8.4.3" class="section-number selfRef">8.4.3. </a><a href="#name-private-use-uri-scheme-redi" class="section-name selfRef">Private-Use URI Scheme Redirection</a>
          </h4>
<p id="section-8.4.3-1">Many mobile and desktop computing platforms support inter-app
communication via URIs by allowing apps to register private-use URI
schemes (sometimes colloquially referred to as "custom URL schemes")
like <code>com.example.app</code>.  When the browser or another app attempts to
load a URI with a private-use URI scheme, the app that registered it
is launched to handle the request.<a href="#section-8.4.3-1" class="pilcrow">¶</a></p>
<p id="section-8.4.3-2">Many environments that support private-use URI schemes do not provide
a mechanism to claim a scheme and prevent other parties from using
another application's scheme. As such, clients using private-use URI
schemes are vulnerable to potential attacks on their redirect URIs,
so this option should only be used if the previously mentioned more
secure options are not available.<a href="#section-8.4.3-2" class="pilcrow">¶</a></p>
<p id="section-8.4.3-3">To perform an authorization request with a private-use URI
scheme redirect, the native app launches the browser with a standard
authorization request, but one where the redirect URI utilizes a
private-use URI scheme it registered with the operating system.<a href="#section-8.4.3-3" class="pilcrow">¶</a></p>
<p id="section-8.4.3-4">When choosing a URI scheme to associate with the app, apps MUST use a
URI scheme based on a domain name under their control, expressed in
reverse order, as recommended by Section 3.8 of <span>[<a href="#RFC7595" class="cite xref">RFC7595</a>]</span> for
private-use URI schemes.<a href="#section-8.4.3-4" class="pilcrow">¶</a></p>
<p id="section-8.4.3-5">For example, an app that controls the domain name <code>app.example.com</code>
can use <code>com.example.app</code> as their scheme.  Some authorization
servers assign client identifiers based on domain names, for example,
<code>client1234.usercontent.example.net</code>, which can also be used as the
domain name for the scheme when reversed in the same manner.  A
scheme such as <code>myapp</code>, however, would not meet this requirement, as
it is not based on a domain name.<a href="#section-8.4.3-5" class="pilcrow">¶</a></p>
<p id="section-8.4.3-6">When there are multiple apps by the same publisher, care must be
taken so that each scheme is unique within that group.  On platforms
that use app identifiers based on reverse-order domain names, those
identifiers can be reused as the private-use URI scheme for the OAuth
redirect to help avoid this problem.<a href="#section-8.4.3-6" class="pilcrow">¶</a></p>
<p id="section-8.4.3-7">Following the requirements of Section 3.2 of <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>, as there is
no naming authority for private-use URI scheme redirects, only a
single slash (<code>/</code>) appears after the scheme component.  A complete
example of a redirect URI utilizing a private-use URI scheme is:<a href="#section-8.4.3-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4.3-8">
<pre>
com.example.app:/oauth2redirect/example-provider
</pre><a href="#section-8.4.3-8" class="pilcrow">¶</a>
</div>
<p id="section-8.4.3-9">When the authorization server completes the request, it redirects to
the client's redirect URI as it would normally.  As the
redirect URI uses a private-use URI scheme, it results in the
operating system launching the native app, passing in the URI as a
launch parameter.  Then, the native app uses normal processing for
the authorization response.<a href="#section-8.4.3-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations-in-native-apps">
<section id="section-8.5">
        <h3 id="name-security-considerations-in-">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-security-considerations-in-" class="section-name selfRef">Security Considerations in Native Apps</a>
        </h3>
<div id="native-apps-embedded-user-agents">
<section id="section-8.5.1">
          <h4 id="name-embedded-user-agents-in-nat">
<a href="#section-8.5.1" class="section-number selfRef">8.5.1. </a><a href="#name-embedded-user-agents-in-nat" class="section-name selfRef">Embedded User Agents in Native Apps</a>
          </h4>
<p id="section-8.5.1-1">Embedded user agents are a technically possible method for authorizing native
apps.  These embedded user agents are unsafe for use by third parties
to the authorization server by definition, as the app that hosts the
embedded user agent can access the user's full authentication
credentials, not just the OAuth authorization grant that was intended
for the app.<a href="#section-8.5.1-1" class="pilcrow">¶</a></p>
<p id="section-8.5.1-2">In typical web-view-based implementations of embedded user agents,
the host application can record every keystroke entered in the login
form to capture usernames and passwords, automatically submit forms
to bypass user consent, and copy session cookies and use them to
perform authenticated actions as the user.<a href="#section-8.5.1-2" class="pilcrow">¶</a></p>
<p id="section-8.5.1-3">Even when used by trusted apps belonging to the same party as the
authorization server, embedded user agents violate the principle of
least privilege by having access to more powerful credentials than
they need, potentially increasing the attack surface.<a href="#section-8.5.1-3" class="pilcrow">¶</a></p>
<p id="section-8.5.1-4">Encouraging users to enter credentials in an embedded user agent
without the usual address bar and visible certificate validation
features that browsers have makes it impossible for the user to know
if they are signing in to the legitimate site; even when they are, it
trains them that it's OK to enter credentials without validating the
site first.<a href="#section-8.5.1-4" class="pilcrow">¶</a></p>
<p id="section-8.5.1-5">Aside from the security concerns, embedded user agents do not share
the authentication state with other apps or the browser, requiring
the user to log in for every authorization request, which is often
considered an inferior user experience.<a href="#section-8.5.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fake-external-user-agents-in-native-apps">
<section id="section-8.5.2">
          <h4 id="name-fake-external-user-agents-i">
<a href="#section-8.5.2" class="section-number selfRef">8.5.2. </a><a href="#name-fake-external-user-agents-i" class="section-name selfRef">Fake External User-Agents in Native Apps</a>
          </h4>
<p id="section-8.5.2-1">The native app that is initiating the authorization request has a
large degree of control over the user interface and can potentially
present a fake external user agent, that is, an embedded user agent
made to appear as an external user agent.<a href="#section-8.5.2-1" class="pilcrow">¶</a></p>
<p id="section-8.5.2-2">When all good actors are using external user agents, the advantage is
that it is possible for security experts to detect bad actors, as
anyone faking an external user agent is provably bad.  On the other
hand, if good and bad actors alike are using embedded user agents,
bad actors don't need to fake anything, making them harder to detect.
Once a malicious app is detected, it may be possible to use this
knowledge to blacklist the app's signature in malware scanning
software, take removal action (in the case of apps distributed by app
stores) and other steps to reduce the impact and spread of the
malicious app.<a href="#section-8.5.2-2" class="pilcrow">¶</a></p>
<p id="section-8.5.2-3">Authorization servers can also directly protect against fake external
user agents by requiring an authentication factor only available to
true external user agents.<a href="#section-8.5.2-3" class="pilcrow">¶</a></p>
<p id="section-8.5.2-4">Users who are particularly concerned about their security when using
in-app browser tabs may also take the additional step of opening the
request in the full browser from the in-app browser tab and complete
the authorization there, as most implementations of the in-app
browser tab pattern offer such functionality.<a href="#section-8.5.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="malicious-external-user-agents-in-native-apps">
<section id="section-8.5.3">
          <h4 id="name-malicious-external-user-age">
<a href="#section-8.5.3" class="section-number selfRef">8.5.3. </a><a href="#name-malicious-external-user-age" class="section-name selfRef">Malicious External User-Agents in Native Apps</a>
          </h4>
<p id="section-8.5.3-1">If a malicious app is able to configure itself as the default handler
for <code>https</code> scheme URIs in the operating system, it will be able to
intercept authorization requests that use the default browser and
abuse this position of trust for malicious ends such as phishing the
user.<a href="#section-8.5.3-1" class="pilcrow">¶</a></p>
<p id="section-8.5.3-2">This attack is not confined to OAuth; a malicious app configured in
this way would present a general and ongoing risk to the user beyond
OAuth usage by native apps.  Many operating systems mitigate this
issue by requiring an explicit user action to change the default
handler for <code>http</code> and <code>https</code> scheme URIs.<a href="#section-8.5.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="loopback-native-apps">
<section id="section-8.5.4">
          <h4 id="name-loopback-redirect-considera">
<a href="#section-8.5.4" class="section-number selfRef">8.5.4. </a><a href="#name-loopback-redirect-considera" class="section-name selfRef">Loopback Redirect Considerations in Native Apps</a>
          </h4>
<p id="section-8.5.4-1">Loopback interface redirect URIs MAY use the <code>http</code> scheme (i.e., without
TLS).  This is acceptable for loopback
interface redirect URIs as the HTTP request never leaves the device.<a href="#section-8.5.4-1" class="pilcrow">¶</a></p>
<p id="section-8.5.4-2">Clients should open the network port only when starting the
authorization request and close it once the response is returned.<a href="#section-8.5.4-2" class="pilcrow">¶</a></p>
<p id="section-8.5.4-3">Clients should listen on the loopback network interface only, in
order to avoid interference by other network actors.<a href="#section-8.5.4-3" class="pilcrow">¶</a></p>
<p id="section-8.5.4-4">Clients should use loopback IP literals rather than the string <code>localhost</code>
as described in <a href="#loopback-interface-redirection" class="auto internal xref">Section 8.4.2</a>.<a href="#section-8.5.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="browser-based-apps">
<section id="section-9">
      <h2 id="name-browser-based-apps">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-browser-based-apps" class="section-name selfRef">Browser-Based Apps</a>
      </h2>
<p id="section-9-1">Browser-based apps are are clients that run in a web browser, typically
written in JavaScript, also known as "single-page apps". These types of apps
have particular security considerations similar to native apps.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">TODO: Bring in the normative text of the browser-based apps BCP when it is finalized.<a href="#section-9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oauth-2-0-differences">
<section id="section-10">
      <h2 id="name-differences-from-oauth-20">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-differences-from-oauth-20" class="section-name selfRef">Differences from OAuth 2.0</a>
      </h2>
<p id="section-10-1">This draft consolidates the functionality in OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>,
OAuth 2.0 for Native Apps (<span>[<a href="#RFC8252" class="cite xref">RFC8252</a>]</span>),
Proof Key for Code Exchange (<span>[<a href="#RFC7636" class="cite xref">RFC7636</a>]</span>),
OAuth 2.0 for Browser-Based Apps (<span>[<a href="#I-D.ietf-oauth-browser-based-apps" class="cite xref">I-D.ietf-oauth-browser-based-apps</a>]</span>),
OAuth Security Best Current Practice (<span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span>),
and Bearer Token Usage (<span>[<a href="#RFC6750" class="cite xref">RFC6750</a>]</span>).<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">Where a later draft updates or obsoletes functionality found in the original
<span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, that functionality in this draft is updated with the normative
changes described in a later draft, or removed entirely.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">A non-normative list of changes from OAuth 2.0 is listed below:<a href="#section-10-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-4.1">
          <p id="section-10-4.1.1">The authorization code grant is extended with the functionality from PKCE (<span>[<a href="#RFC7636" class="cite xref">RFC7636</a>]</span>)
such that the default method of using the authorization code grant according
to this specification requires the addition of the PKCE parameters<a href="#section-10-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-4.2">
          <p id="section-10-4.2.1">Redirect URIs must be compared using exact string matching
as per Section 4.1.3 of <span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span><a href="#section-10-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-4.3">
          <p id="section-10-4.3.1">The Implicit grant (<code>response_type=token</code>) is omitted from this specification
as per Section 2.1.2 of <span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span><a href="#section-10-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-4.4">
          <p id="section-10-4.4.1">The Resource Owner Password Credentials grant is omitted from this specification
as per Section 2.4 of <span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span><a href="#section-10-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-4.5">
          <p id="section-10-4.5.1">Bearer token usage omits the use of bearer tokens in the query string of URIs
as per Section 4.3.2 of <span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span><a href="#section-10-4.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-4.6">
          <p id="section-10-4.6.1">Refresh tokens for public clients must either be sender-constrained or one-time use
as per Section 4.13.2 of <span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span><a href="#section-10-4.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-4.7">
          <p id="section-10-4.7.1">The token endpoint request containing an authorization code no longer contains
the <code>redirect_uri</code> parameter<a href="#section-10-4.7.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="removal-of-the-oauth-20-implicit-grant">
<section id="section-10.1">
        <h3 id="name-removal-of-the-oauth-20-imp">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-removal-of-the-oauth-20-imp" class="section-name selfRef">Removal of the OAuth 2.0 Implicit grant</a>
        </h3>
<p id="section-10.1-1">The OAuth 2.0 Implicit grant is omitted from OAuth 2.1 as it was deprecated in
<span>[<a href="#I-D.ietf-oauth-security-topics" class="cite xref">I-D.ietf-oauth-security-topics</a>]</span>.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">The intent of removing the Implicit grant is to no longer issue access tokens
in the authorization response, as such tokens are vulnerable to leakage
and injection, and are unable to be sender-constrained to a client.
This behavior was indicated by clients using the <code>response_type=token</code> parameter.
This value for the <code>response_type</code> parameter is no longer defined in OAuth 2.1.<a href="#section-10.1-2" class="pilcrow">¶</a></p>
<p id="section-10.1-3">Removal of <code>response_type=token</code> does not have an effect on other extension
response types returning other artifacts from the authorization endpoint,
for example, <code>response_type=id_token</code> defined by <span>[<a href="#OpenID" class="cite xref">OpenID</a>]</span>.<a href="#section-10.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="redirect-uri-in-token-request">
<section id="section-10.2">
        <h3 id="name-redirect-uri-parameter-in-t">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-redirect-uri-parameter-in-t" class="section-name selfRef">Redirect URI Parameter in Token Request</a>
        </h3>
<p id="section-10.2-1">In OAuth 2.0, the request to the token endpoint in the authorization code flow (section 4.1.3 of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>) contains an optional <code>redirect_uri</code> parameter. The parameter was intended to prevent an authorization code injection attack, and was required if the <code>redirect_uri</code> parameter was sent in the original authorization request. The authorization request only required the <code>redirect_uri</code> parameter if multiple redirect URIs were registered to the specific client. However, in practice, many authorization server implementations required the <code>redirect_uri</code> parameter in the authorization request even if only one was registered, leading the <code>redirect_uri</code> parameter to be required at the token endpoint as well.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2">In OAuth 2.1, authorization code injection is prevented by the <code>code_challenge</code> and <code>code_verifier</code> parameters, making the inclusion of the <code>redirect_uri</code> parameter serve no purpose in the token request. As such, it has been removed.<a href="#section-10.2-2" class="pilcrow">¶</a></p>
<p id="section-10.2-3">For backwards compatibility of an authorization server wishing to support both OAuth 2.0 and OAuth 2.1 clients, the authorization server MUST allow clients to send the <code>redirect_uri</code> parameter in the token request (<a href="#code-token-extension" class="auto internal xref">Section 4.1.3</a>), and MUST enforce the parameter as described in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>. The authorization server can use the <code>client_id</code> in the request to determine whether to enforce this behavior for the specific client that it knows will be using the older OAuth 2.0 behavior.<a href="#section-10.2-3" class="pilcrow">¶</a></p>
<p id="section-10.2-4">A client following only the OAuth 2.1 recommendations will not send the <code>redirect_uri</code> in the token request, and therefore will not be compatible with an authorization server that expects the parameter in the token request.<a href="#section-10.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-11-1">This document does not require any IANA actions.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">All referenced registries are defined by <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> and related documents that this
work is based upon. No changes to those registries are required by this specification.<a href="#section-11-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="BCP195">[BCP195]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS)"</span>, <time datetime="2015" class="refDate">2015</time>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-oauth-security-topics">[I-D.ietf-oauth-security-topics]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Labunets, A.</span>, and <span class="refAuthor">D. Fett</span>, <span class="refTitle">"OAuth 2.0 Security Best Current Practice"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-security-topics-24</span>, <time datetime="2023-10-23" class="refDate">23 October 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics-24">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics-24</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2617">[RFC2617]</dt>
        <dd>
<span class="refAuthor">Franks, J.</span>, <span class="refAuthor">Hallam-Baker, P.</span>, <span class="refAuthor">Hostetler, J.</span>, <span class="refAuthor">Lawrence, S.</span>, <span class="refAuthor">Leach, P.</span>, <span class="refAuthor">Luotonen, A.</span>, and <span class="refAuthor">L. Stewart</span>, <span class="refTitle">"HTTP Authentication: Basic and Digest Access Authentication"</span>, <span class="seriesInfo">RFC 2617</span>, <span class="seriesInfo">DOI 10.17487/RFC2617</span>, <time datetime="1999-06" class="refDate">June 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2617">https://www.rfc-editor.org/info/rfc2617</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time datetime="2003-11" class="refDate">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4949">[RFC4949]</dt>
        <dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4949">https://www.rfc-editor.org/info/rfc4949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5234">[RFC5234]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6750">[RFC6750]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">D. Hardt</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework: Bearer Token Usage"</span>, <span class="seriesInfo">RFC 6750</span>, <span class="seriesInfo">DOI 10.17487/RFC6750</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6750">https://www.rfc-editor.org/info/rfc6750</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7159">[RFC7159]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">RFC 7159</span>, <span class="seriesInfo">DOI 10.17487/RFC7159</span>, <time datetime="2014-03" class="refDate">March 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7159">https://www.rfc-editor.org/info/rfc7159</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7235">[RFC7235]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span> and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Authentication"</span>, <span class="seriesInfo">RFC 7235</span>, <span class="seriesInfo">DOI 10.17487/RFC7235</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7235">https://www.rfc-editor.org/info/rfc7235</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7521">[RFC7521]</dt>
        <dd>
<span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Mortimore, C.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">Y. Goland</span>, <span class="refTitle">"Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants"</span>, <span class="seriesInfo">RFC 7521</span>, <span class="seriesInfo">DOI 10.17487/RFC7521</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7521">https://www.rfc-editor.org/info/rfc7521</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7523">[RFC7523]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Campbell, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants"</span>, <span class="seriesInfo">RFC 7523</span>, <span class="seriesInfo">DOI 10.17487/RFC7523</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7523">https://www.rfc-editor.org/info/rfc7523</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7595">[RFC7595]</dt>
        <dd>
<span class="refAuthor">Thaler, D., Ed.</span>, <span class="refAuthor">Hansen, T.</span>, and <span class="refAuthor">T. Hardie</span>, <span class="refTitle">"Guidelines and Registration Procedures for URI Schemes"</span>, <span class="seriesInfo">BCP 35</span>, <span class="seriesInfo">RFC 7595</span>, <span class="seriesInfo">DOI 10.17487/RFC7595</span>, <time datetime="2015-06" class="refDate">June 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7595">https://www.rfc-editor.org/info/rfc7595</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8252">[RFC8252]</dt>
        <dd>
<span class="refAuthor">Denniss, W.</span> and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 for Native Apps"</span>, <span class="seriesInfo">BCP 212</span>, <span class="seriesInfo">RFC 8252</span>, <span class="seriesInfo">DOI 10.17487/RFC8252</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8252">https://www.rfc-editor.org/info/rfc8252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9111">[RFC9111]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Caching"</span>, <span class="seriesInfo">STD 98</span>, <span class="seriesInfo">RFC 9111</span>, <span class="seriesInfo">DOI 10.17487/RFC9111</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9111">https://www.rfc-editor.org/info/rfc9111</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9207">[RFC9207]</dt>
        <dd>
<span class="refAuthor">Meyer zu Selhausen, K.</span> and <span class="refAuthor">D. Fett</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Issuer Identification"</span>, <span class="seriesInfo">RFC 9207</span>, <span class="seriesInfo">DOI 10.17487/RFC9207</span>, <time datetime="2022-03" class="refDate">March 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9207">https://www.rfc-editor.org/info/rfc9207</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="USASCII">[USASCII]</dt>
        <dd>
<span class="refAuthor">Institute, A. N. S.</span>, <span class="refTitle">"Coded Character Set -- 7-bit American Standard Code for Information Interchange, ANSI X3.4"</span>, <time datetime="1986" class="refDate">1986</time>. </dd>
<dd class="break"></dd>
<dt id="W3C.REC-xml-20081126">[W3C.REC-xml-20081126]</dt>
        <dd>
<span class="refAuthor">Bray, T.</span>, <span class="refAuthor">Paoli, J.</span>, <span class="refAuthor">Sperberg-McQueen, C. M.</span>, <span class="refAuthor">Maler, E.</span>, and <span class="refAuthor">F. Yergeau</span>, <span class="refTitle">"Extensible Markup Language"</span>, <time datetime="2008-11" class="refDate">November 2008</time>, <span>&lt;<a href="https://www.w3.org/TR/REC-xml/REC-xml-20081126.xml">https://www.w3.org/TR/REC-xml/REC-xml-20081126.xml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WHATWG.CORS">[WHATWG.CORS]</dt>
        <dd>
<span class="refAuthor">WHATWG</span>, <span class="refTitle">"Fetch Standard: CORS protocol"</span>, <time datetime="2023-06" class="refDate">June 2023</time>, <span>&lt;<a href="https://fetch.spec.whatwg.org/#http-cors-protocol">https://fetch.spec.whatwg.org/#http-cors-protocol</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WHATWG.URL">[WHATWG.URL]</dt>
      <dd>
<span class="refAuthor">WHATWG</span>, <span class="refTitle">"URL"</span>, <time datetime="2022-05" class="refDate">May 2022</time>, <span>&lt;<a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="CSP-2">[CSP-2]</dt>
        <dd>
<span class="refTitle">"Content Security Policy Level 2"</span>, <time datetime="2016-12" class="refDate">December 2016</time>, <span>&lt;<a href="https://www.w3.org/TR/CSP2">https://www.w3.org/TR/CSP2</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.bradley-oauth-jwt-encoded-state">[I-D.bradley-oauth-jwt-encoded-state]</dt>
        <dd>
<span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Lodderstedt, T.</span>, and <span class="refAuthor">H. Zandbelt</span>, <span class="refTitle">"Encoding claims in the OAuth 2 state parameter using a JWT"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-bradley-oauth-jwt-encoded-state-09</span>, <time datetime="2018-11-04" class="refDate">4 November 2018</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-bradley-oauth-jwt-encoded-state-09">https://datatracker.ietf.org/doc/html/draft-bradley-oauth-jwt-encoded-state-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-oauth-browser-based-apps">[I-D.ietf-oauth-browser-based-apps]</dt>
        <dd>
<span class="refAuthor">Parecki, A.</span>, <span class="refAuthor">Waite, D.</span>, and <span class="refAuthor">P. De Ryck</span>, <span class="refTitle">"OAuth 2.0 for Browser-Based Apps"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-browser-based-apps-15</span>, <time datetime="2023-10-23" class="refDate">23 October 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-browser-based-apps-15">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-browser-based-apps-15</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST800-63">[NIST800-63]</dt>
        <dd>
<span class="refAuthor">Burr, W.</span>, <span class="refAuthor">Dodson, D.</span>, <span class="refAuthor">Newton, E.</span>, <span class="refAuthor">Perlner, R.</span>, <span class="refAuthor">Polk, T.</span>, <span class="refAuthor">Gupta, S.</span>, and <span class="refAuthor">E. Nabbus</span>, <span class="refTitle">"NIST Special Publication 800-63-1, INFORMATION SECURITY"</span>, <time datetime="2011-12" class="refDate">December 2011</time>, <span>&lt;<a href="http://csrc.nist.gov/publications/">http://csrc.nist.gov/publications/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OMAP">[OMAP]</dt>
        <dd>
<span class="refAuthor">Huff, J.</span>, <span class="refAuthor">Schlacht, D.</span>, <span class="refAuthor">Nadalin, A.</span>, <span class="refAuthor">Simmons, J.</span>, <span class="refAuthor">Rosenberg, P.</span>, <span class="refAuthor">Madsen, P.</span>, <span class="refAuthor">Ace, T.</span>, <span class="refAuthor">Rickelton-Abdi, C.</span>, and <span class="refAuthor">B. Boyer</span>, <span class="refTitle">"Online Multimedia Authorization Protocol: An Industry Standard for Authorized Access to Internet Multimedia Resources"</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.svta.org/product/online-multimedia-authorization-protocol/">https://www.svta.org/product/online-multimedia-authorization-protocol/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID">[OpenID]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, <span class="refAuthor">de Medeiros, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0"</span>, <time datetime="2014-11" class="refDate">November 2014</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Discovery">[OpenID.Discovery]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">E. Jay</span>, <span class="refTitle">"OpenID Connect Discovery 1.0 incorporating errata set 1"</span>, <time datetime="2014-11" class="refDate">November 2014</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-discovery-1_0.html">https://openid.net/specs/openid-connect-discovery-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Messages">[OpenID.Messages]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, <span class="refAuthor">de Medeiros, B.</span>, <span class="refAuthor">Mortimore, C.</span>, and <span class="refAuthor">E. Jay</span>, <span class="refTitle">"OpenID Connect Messages 1.0"</span>, <time datetime="2012-06" class="refDate">June 2012</time>, <span>&lt;<a href="http://openid.net/specs/openid-connect-messages-1_0.html">http://openid.net/specs/openid-connect-messages-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="owasp_redir">[owasp_redir]</dt>
        <dd>
<span class="refTitle">"OWASP Cheat Sheet Series - Unvalidated Redirects and Forwards"</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6265">[RFC6265]</dt>
        <dd>
<span class="refAuthor">Barth, A.</span>, <span class="refTitle">"HTTP State Management Mechanism"</span>, <span class="seriesInfo">RFC 6265</span>, <span class="seriesInfo">DOI 10.17487/RFC6265</span>, <time datetime="2011-04" class="refDate">April 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6265">https://www.rfc-editor.org/info/rfc6265</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6819">[RFC6819]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T., Ed.</span>, <span class="refAuthor">McGloin, M.</span>, and <span class="refAuthor">P. Hunt</span>, <span class="refTitle">"OAuth 2.0 Threat Model and Security Considerations"</span>, <span class="seriesInfo">RFC 6819</span>, <span class="seriesInfo">DOI 10.17487/RFC6819</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6819">https://www.rfc-editor.org/info/rfc6819</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7009">[RFC7009]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T., Ed.</span>, <span class="refAuthor">Dronia, S.</span>, and <span class="refAuthor">M. Scurtescu</span>, <span class="refTitle">"OAuth 2.0 Token Revocation"</span>, <span class="seriesInfo">RFC 7009</span>, <span class="seriesInfo">DOI 10.17487/RFC7009</span>, <time datetime="2013-08" class="refDate">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7009">https://www.rfc-editor.org/info/rfc7009</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7591">[RFC7591]</dt>
        <dd>
<span class="refAuthor">Richer, J., Ed.</span>, <span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Machulak, M.</span>, and <span class="refAuthor">P. Hunt</span>, <span class="refTitle">"OAuth 2.0 Dynamic Client Registration Protocol"</span>, <span class="seriesInfo">RFC 7591</span>, <span class="seriesInfo">DOI 10.17487/RFC7591</span>, <time datetime="2015-07" class="refDate">July 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7591">https://www.rfc-editor.org/info/rfc7591</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7592">[RFC7592]</dt>
        <dd>
<span class="refAuthor">Richer, J., Ed.</span>, <span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">M. Machulak</span>, <span class="refTitle">"OAuth 2.0 Dynamic Client Registration Management Protocol"</span>, <span class="seriesInfo">RFC 7592</span>, <span class="seriesInfo">DOI 10.17487/RFC7592</span>, <time datetime="2015-07" class="refDate">July 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7592">https://www.rfc-editor.org/info/rfc7592</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7636">[RFC7636]</dt>
        <dd>
<span class="refAuthor">Sakimura, N., Ed.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Agarwal</span>, <span class="refTitle">"Proof Key for Code Exchange by OAuth Public Clients"</span>, <span class="seriesInfo">RFC 7636</span>, <span class="seriesInfo">DOI 10.17487/RFC7636</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7636">https://www.rfc-editor.org/info/rfc7636</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7662">[RFC7662]</dt>
        <dd>
<span class="refAuthor">Richer, J., Ed.</span>, <span class="refTitle">"OAuth 2.0 Token Introspection"</span>, <span class="seriesInfo">RFC 7662</span>, <span class="seriesInfo">DOI 10.17487/RFC7662</span>, <time datetime="2015-10" class="refDate">October 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7662">https://www.rfc-editor.org/info/rfc7662</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8414">[RFC8414]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8414">https://www.rfc-editor.org/info/rfc8414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8628">[RFC8628]</dt>
        <dd>
<span class="refAuthor">Denniss, W.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"OAuth 2.0 Device Authorization Grant"</span>, <span class="seriesInfo">RFC 8628</span>, <span class="seriesInfo">DOI 10.17487/RFC8628</span>, <time datetime="2019-08" class="refDate">August 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8628">https://www.rfc-editor.org/info/rfc8628</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8705">[RFC8705]</dt>
        <dd>
<span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">T. Lodderstedt</span>, <span class="refTitle">"OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens"</span>, <span class="seriesInfo">RFC 8705</span>, <span class="seriesInfo">DOI 10.17487/RFC8705</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8705">https://www.rfc-editor.org/info/rfc8705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8707">[RFC8707]</dt>
        <dd>
<span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Resource Indicators for OAuth 2.0"</span>, <span class="seriesInfo">RFC 8707</span>, <span class="seriesInfo">DOI 10.17487/RFC8707</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8707">https://www.rfc-editor.org/info/rfc8707</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9068">[RFC9068]</dt>
        <dd>
<span class="refAuthor">Bertocci, V.</span>, <span class="refTitle">"JSON Web Token (JWT) Profile for OAuth 2.0 Access Tokens"</span>, <span class="seriesInfo">RFC 9068</span>, <span class="seriesInfo">DOI 10.17487/RFC9068</span>, <time datetime="2021-10" class="refDate">October 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9068">https://www.rfc-editor.org/info/rfc9068</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9126">[RFC9126]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Tonge, D.</span>, and <span class="refAuthor">F. Skokan</span>, <span class="refTitle">"OAuth 2.0 Pushed Authorization Requests"</span>, <span class="seriesInfo">RFC 9126</span>, <span class="seriesInfo">DOI 10.17487/RFC9126</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9126">https://www.rfc-editor.org/info/rfc9126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9396">[RFC9396]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Richer, J.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"OAuth 2.0 Rich Authorization Requests"</span>, <span class="seriesInfo">RFC 9396</span>, <span class="seriesInfo">DOI 10.17487/RFC9396</span>, <time datetime="2023-05" class="refDate">May 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9396">https://www.rfc-editor.org/info/rfc9396</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9449">[RFC9449]</dt>
        <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">D. Waite</span>, <span class="refTitle">"OAuth 2.0 Demonstrating Proof of Possession (DPoP)"</span>, <span class="seriesInfo">RFC 9449</span>, <span class="seriesInfo">DOI 10.17487/RFC9449</span>, <time datetime="2023-09" class="refDate">September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9449">https://www.rfc-editor.org/info/rfc9449</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="W3C.REC-html401-19991224">[W3C.REC-html401-19991224]</dt>
      <dd>
<span class="refAuthor">Hors, A. L., Ed.</span>, <span class="refAuthor">Raggett, D., Ed.</span>, and <span class="refAuthor">I. Jacobs, Ed.</span>, <span class="refTitle">"HTML 4.01 Specification"</span>, <span class="seriesInfo">W3C REC REC-html401-19991224</span>, <span class="seriesInfo">W3C REC-html401-19991224</span>, <time datetime="1999-12-24" class="refDate">24 December 1999</time>, <span>&lt;<a href="https://www.w3.org/TR/1999/REC-html401-19991224/">https://www.w3.org/TR/1999/REC-html401-19991224/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="augmented-backus-naur-form-abnf-syntax">
<section id="appendix-A">
      <h2 id="name-augmented-backus-naur-form-">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-augmented-backus-naur-form-" class="section-name selfRef">Augmented Backus-Naur Form (ABNF) Syntax</a>
      </h2>
<p id="appendix-A-1">This section provides Augmented Backus-Naur Form (ABNF) syntax
descriptions for the elements defined in this specification using the
notation of <span>[<a href="#RFC5234" class="cite xref">RFC5234</a>]</span>.  The ABNF below is defined in terms of Unicode
code points <span>[<a href="#W3C.REC-xml-20081126" class="cite xref">W3C.REC-xml-20081126</a>]</span>; these characters are typically
encoded in UTF-8.  Elements are presented in the order first defined.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">Some of the definitions that follow use the "URI-reference"
definition from <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">Some of the definitions that follow use these common definitions:<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-4">
<pre>
VSCHAR     = %x20-7E
NQCHAR     = %x21 / %x23-5B / %x5D-7E
NQSCHAR    = %x20-21 / %x23-5B / %x5D-7E
</pre><a href="#appendix-A-4" class="pilcrow">¶</a>
</div>
<div id="clientid-syntax">
<section id="appendix-A.1">
        <h3 id="name-client_id-syntax">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-client_id-syntax" class="section-name selfRef">"client_id" Syntax</a>
        </h3>
<p id="appendix-A.1-1">The <code>client_id</code> element is defined in <a href="#client-secret" class="auto internal xref">Section 2.4.1</a>:<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-2">
<pre>
client-id     = *VSCHAR
</pre><a href="#appendix-A.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="clientsecret-syntax">
<section id="appendix-A.2">
        <h3 id="name-client_secret-syntax">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-client_secret-syntax" class="section-name selfRef">"client_secret" Syntax</a>
        </h3>
<p id="appendix-A.2-1">The <code>client_secret</code> element is defined in <a href="#client-secret" class="auto internal xref">Section 2.4.1</a>:<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-2">
<pre>
client-secret = *VSCHAR
</pre><a href="#appendix-A.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="responsetype-syntax">
<section id="appendix-A.3">
        <h3 id="name-response_type-syntax">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-response_type-syntax" class="section-name selfRef">"response_type" Syntax</a>
        </h3>
<p id="appendix-A.3-1">The <code>response_type</code> element is defined in <a href="#authorization-request" class="auto internal xref">Section 4.1.1</a> and <a href="#new-response-types" class="auto internal xref">Section 6.4</a>:<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3-2">
<pre>
response-type = response-name *( SP response-name )
response-name = 1*response-char
response-char = "_" / DIGIT / ALPHA
</pre><a href="#appendix-A.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="scope-syntax">
<section id="appendix-A.4">
        <h3 id="name-scope-syntax">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-scope-syntax" class="section-name selfRef">"scope" Syntax</a>
        </h3>
<p id="appendix-A.4-1">The <code>scope</code> element is defined in <a href="#access-token-scope" class="auto internal xref">Section 1.4.1</a>:<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4-2">
<pre>
 scope       = scope-token *( SP scope-token )
 scope-token = 1*NQCHAR
</pre><a href="#appendix-A.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="state-syntax">
<section id="appendix-A.5">
        <h3 id="name-state-syntax">
<a href="#appendix-A.5" class="section-number selfRef">A.5. </a><a href="#name-state-syntax" class="section-name selfRef">"state" Syntax</a>
        </h3>
<p id="appendix-A.5-1">The <code>state</code> element is defined in <a href="#authorization-request" class="auto internal xref">Section 4.1.1</a>, <a href="#authorization-response" class="auto internal xref">Section 4.1.2</a>, and <a href="#authorization-code-error-response" class="auto internal xref">Section 4.1.2.1</a>:<a href="#appendix-A.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.5-2">
<pre>
 state      = 1*VSCHAR
</pre><a href="#appendix-A.5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="redirecturi-syntax">
<section id="appendix-A.6">
        <h3 id="name-redirect_uri-syntax">
<a href="#appendix-A.6" class="section-number selfRef">A.6. </a><a href="#name-redirect_uri-syntax" class="section-name selfRef">"redirect_uri" Syntax</a>
        </h3>
<p id="appendix-A.6-1">The <code>redirect_uri</code> element is defined in <a href="#authorization-request" class="auto internal xref">Section 4.1.1</a>, and <a href="#code-token-extension" class="auto internal xref">Section 4.1.3</a>:<a href="#appendix-A.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.6-2">
<pre>
 redirect-uri      = URI-reference
</pre><a href="#appendix-A.6-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="error-syntax">
<section id="appendix-A.7">
        <h3 id="name-error-syntax">
<a href="#appendix-A.7" class="section-number selfRef">A.7. </a><a href="#name-error-syntax" class="section-name selfRef">"error" Syntax</a>
        </h3>
<p id="appendix-A.7-1">The <code>error</code> element is defined in Sections <a href="#authorization-code-error-response" class="auto internal xref">Section 4.1.2.1</a>, <a href="#token-error-response" class="auto internal xref">Section 3.2.4</a>,
7.2, and 8.5:<a href="#appendix-A.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.7-2">
<pre>
 error             = 1*NQSCHAR
</pre><a href="#appendix-A.7-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="error-description-syntax">
<section id="appendix-A.8">
        <h3 id="name-error_description-syntax">
<a href="#appendix-A.8" class="section-number selfRef">A.8. </a><a href="#name-error_description-syntax" class="section-name selfRef">"error_description" Syntax</a>
        </h3>
<p id="appendix-A.8-1">The <code>error_description</code> element is defined in Sections <a href="#authorization-code-error-response" class="auto internal xref">Section 4.1.2.1</a>,
<a href="#token-error-response" class="auto internal xref">Section 3.2.4</a>, and <a href="#error-response" class="auto internal xref">Section 5.3</a>:<a href="#appendix-A.8-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.8-2">
<pre>
 error-description = 1*NQSCHAR
</pre><a href="#appendix-A.8-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="error-uri-syntax">
<section id="appendix-A.9">
        <h3 id="name-error_uri-syntax">
<a href="#appendix-A.9" class="section-number selfRef">A.9. </a><a href="#name-error_uri-syntax" class="section-name selfRef">"error_uri" Syntax</a>
        </h3>
<p id="appendix-A.9-1">The <code>error_uri</code> element is defined in Sections <a href="#authorization-code-error-response" class="auto internal xref">Section 4.1.2.1</a>, <a href="#token-error-response" class="auto internal xref">Section 3.2.4</a>,
and 7.2:<a href="#appendix-A.9-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.9-2">
<pre>
 error-uri         = URI-reference
</pre><a href="#appendix-A.9-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="granttype-syntax">
<section id="appendix-A.10">
        <h3 id="name-grant_type-syntax">
<a href="#appendix-A.10" class="section-number selfRef">A.10. </a><a href="#name-grant_type-syntax" class="section-name selfRef">"grant_type" Syntax</a>
        </h3>
<p id="appendix-A.10-1">The <code>grant_type</code> element is defined in Section <a href="#token-request" class="auto internal xref">Section 3.2.2</a>:<a href="#appendix-A.10-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.10-2">
<pre>
 grant-type = grant-name / URI-reference
 grant-name = 1*name-char
 name-char  = "-" / "." / "_" / DIGIT / ALPHA
</pre><a href="#appendix-A.10-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="code-syntax">
<section id="appendix-A.11">
        <h3 id="name-code-syntax">
<a href="#appendix-A.11" class="section-number selfRef">A.11. </a><a href="#name-code-syntax" class="section-name selfRef">"code" Syntax</a>
        </h3>
<p id="appendix-A.11-1">The <code>code</code> element is defined in <a href="#code-token-extension" class="auto internal xref">Section 4.1.3</a>:<a href="#appendix-A.11-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.11-2">
<pre>
 code       = 1*VSCHAR
</pre><a href="#appendix-A.11-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="accesstoken-syntax">
<section id="appendix-A.12">
        <h3 id="name-access_token-syntax">
<a href="#appendix-A.12" class="section-number selfRef">A.12. </a><a href="#name-access_token-syntax" class="section-name selfRef">"access_token" Syntax</a>
        </h3>
<p id="appendix-A.12-1">The <code>access_token</code> element is defined in <a href="#token-response" class="auto internal xref">Section 3.2.3</a>:<a href="#appendix-A.12-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.12-2">
<pre>
 access-token = 1*VSCHAR
</pre><a href="#appendix-A.12-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="tokentype-syntax">
<section id="appendix-A.13">
        <h3 id="name-token_type-syntax">
<a href="#appendix-A.13" class="section-number selfRef">A.13. </a><a href="#name-token_type-syntax" class="section-name selfRef">"token_type" Syntax</a>
        </h3>
<p id="appendix-A.13-1">The <code>token_type</code> element is defined in <a href="#token-response" class="auto internal xref">Section 3.2.3</a>, and <a href="#defining-access-token-types" class="auto internal xref">Section 6.1</a>:<a href="#appendix-A.13-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.13-2">
<pre>
 token-type = type-name / URI-reference
 type-name  = 1*name-char
 name-char  = "-" / "." / "_" / DIGIT / ALPHA
</pre><a href="#appendix-A.13-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="expiresin-syntax">
<section id="appendix-A.14">
        <h3 id="name-expires_in-syntax">
<a href="#appendix-A.14" class="section-number selfRef">A.14. </a><a href="#name-expires_in-syntax" class="section-name selfRef">"expires_in" Syntax</a>
        </h3>
<p id="appendix-A.14-1">The <code>expires_in</code> element is defined in <a href="#token-response" class="auto internal xref">Section 3.2.3</a>:<a href="#appendix-A.14-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.14-2">
<pre>
 expires-in = 1*DIGIT
</pre><a href="#appendix-A.14-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="refreshtoken-syntax">
<section id="appendix-A.15">
        <h3 id="name-refresh_token-syntax">
<a href="#appendix-A.15" class="section-number selfRef">A.15. </a><a href="#name-refresh_token-syntax" class="section-name selfRef">"refresh_token" Syntax</a>
        </h3>
<p id="appendix-A.15-1">The <code>refresh_token</code> element is defined in <a href="#token-response" class="auto internal xref">Section 3.2.3</a> and <a href="#refreshing-an-access-token" class="auto internal xref">Section 4.3</a>:<a href="#appendix-A.15-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.15-2">
<pre>
 refresh-token = 1*VSCHAR
</pre><a href="#appendix-A.15-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="endpoint-parameter-syntax">
<section id="appendix-A.16">
        <h3 id="name-endpoint-parameter-syntax">
<a href="#appendix-A.16" class="section-number selfRef">A.16. </a><a href="#name-endpoint-parameter-syntax" class="section-name selfRef">Endpoint Parameter Syntax</a>
        </h3>
<p id="appendix-A.16-1">The syntax for new endpoint parameters is defined in <a href="#defining-new-endpoint-parameters" class="auto internal xref">Section 6.2</a>:<a href="#appendix-A.16-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.16-2">
<pre>
 param-name = 1*name-char
 name-char  = "-" / "." / "_" / DIGIT / ALPHA
</pre><a href="#appendix-A.16-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="codeverifier-syntax">
<section id="appendix-A.17">
        <h3 id="name-code_verifier-syntax">
<a href="#appendix-A.17" class="section-number selfRef">A.17. </a><a href="#name-code_verifier-syntax" class="section-name selfRef">"code_verifier" Syntax</a>
        </h3>
<p id="appendix-A.17-1">ABNF for <code>code_verifier</code> is as follows.<a href="#appendix-A.17-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.17-2">
<pre>
code-verifier = 43*128unreserved
unreserved = ALPHA / DIGIT / "-" / "." / "_" / "~"
ALPHA = %x41-5A / %x61-7A
DIGIT = %x30-39
</pre><a href="#appendix-A.17-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="codechallenge-syntax">
<section id="appendix-A.18">
        <h3 id="name-code_challenge-syntax">
<a href="#appendix-A.18" class="section-number selfRef">A.18. </a><a href="#name-code_challenge-syntax" class="section-name selfRef">"code_challenge" Syntax</a>
        </h3>
<p id="appendix-A.18-1">ABNF for <code>code_challenge</code> is as follows.<a href="#appendix-A.18-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.18-2">
<pre>
code-challenge = 43*128unreserved
unreserved = ALPHA / DIGIT / "-" / "." / "_" / "~"
ALPHA = %x41-5A / %x61-7A
DIGIT = %x30-39
</pre><a href="#appendix-A.18-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="application-x-www-form-urlencoded">
<section id="appendix-B">
      <h2 id="name-use-of-application-x-www-fo">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-use-of-application-x-www-fo" class="section-name selfRef">Use of application/x-www-form-urlencoded Media Type</a>
      </h2>
<p id="appendix-B-1">At the time of publication of <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, the
<code>application/x-www-form-urlencoded</code> media type was defined in
Section 17.13.4 of <span>[<a href="#W3C.REC-html401-19991224" class="cite xref">W3C.REC-html401-19991224</a>]</span> but not registered in
the IANA MIME Media Types registry
(<a href="http://www.iana.org/assignments/media-types">http://www.iana.org/assignments/media-types</a>).  Furthermore, that
definition is incomplete, as it does not consider non-US-ASCII
characters.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">To address this shortcoming when generating contents using this media
type, names and values MUST be encoded using the UTF-8 character
encoding scheme <span>[<a href="#RFC3629" class="cite xref">RFC3629</a>]</span> first; the resulting octet sequence then
needs to be further encoded using the escaping rules defined in
<span>[<a href="#W3C.REC-html401-19991224" class="cite xref">W3C.REC-html401-19991224</a>]</span>.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">When parsing data from a content using this media type, the names and
values resulting from reversing the name/value encoding consequently
need to be treated as octet sequences, to be decoded using the UTF-8
character encoding scheme.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<p id="appendix-B-4">For example, the value consisting of the six Unicode code points
(1) U+0020 (SPACE), (2) U+0025 (PERCENT SIGN),
(3) U+0026 (AMPERSAND), (4) U+002B (PLUS SIGN),
(5) U+00A3 (POUND SIGN), and (6) U+20AC (EURO SIGN) would be encoded
into the octet sequence below (using hexadecimal notation):<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-5">
<pre>
20 25 26 2B C2 A3 E2 82 AC
</pre><a href="#appendix-B-5" class="pilcrow">¶</a>
</div>
<p id="appendix-B-6">and then represented in the content as:<a href="#appendix-B-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-7">
<pre>
+%25%26%2B%C2%A3%E2%82%AC
</pre><a href="#appendix-B-7" class="pilcrow">¶</a>
</div>
<p id="appendix-B-8">GitHub discussion: <a href="https://github.com/oauth-wg/oauth-v2-1/issues/128">https://github.com/oauth-wg/oauth-v2-1/issues/128</a><a href="#appendix-B-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="extensions">
<section id="appendix-C">
      <h2 id="name-extensions">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-extensions" class="section-name selfRef">Extensions</a>
      </h2>
<p id="appendix-C-1">Below is a list of well-established extensions at the time of publication:<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.1">
          <p id="appendix-C-2.1.1"><span>[<a href="#RFC9068" class="cite xref">RFC9068</a>]</span>: JSON Web Token (JWT) Profile for OAuth 2.0 Access Tokens<a href="#appendix-C-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.1.2.1">
              <p id="appendix-C-2.1.2.1.1">This specification defines a profile for issuing OAuth access tokens in JSON Web Token (JWT) format.<a href="#appendix-C-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-2.2">
          <p id="appendix-C-2.2.1"><span>[<a href="#RFC8628" class="cite xref">RFC8628</a>]</span>: OAuth 2.0 Device Authorization Grant<a href="#appendix-C-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.2.2.1">
              <p id="appendix-C-2.2.2.1.1">The Device Authorization Grant (formerly known as the Device Flow) is an extension that enables devices with no browser or limited input capability to obtain an access token. This is commonly used by smart TV apps, or devices like hardware video encoders that can stream video to a streaming video service.<a href="#appendix-C-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-2.3">
          <p id="appendix-C-2.3.1"><span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>: Authorization Server Metadata<a href="#appendix-C-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.3.2.1">
              <p id="appendix-C-2.3.2.1.1">Authorization Server Metadata (also known as OAuth Discovery) defines an endpoint clients can use to look up the information needed to interact with a particular OAuth server, such as the location of the authorization and token endpoints and the supported grant types.<a href="#appendix-C-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-2.4">
          <p id="appendix-C-2.4.1"><span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>: Resource Indicators<a href="#appendix-C-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.4.2.1">
              <p id="appendix-C-2.4.2.1.1">Provides a way for the client to explicitly signal to the authorization server where it intends to use the access token it is requesting.<a href="#appendix-C-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-2.5">
          <p id="appendix-C-2.5.1"><span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span>: Dynamic Client Registration<a href="#appendix-C-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.5.2.1">
              <p id="appendix-C-2.5.2.1.1">Dynamic Client Registration provides a mechanism for programmatically registering clients with an authorization server.<a href="#appendix-C-2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-2.6">
          <p id="appendix-C-2.6.1"><span>[<a href="#RFC9449" class="cite xref">RFC9449</a>]</span>: Demonstrating Proof of Possession (DPoP)<a href="#appendix-C-2.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.6.2.1">
              <p id="appendix-C-2.6.2.1.1">DPoP describes a mechanism of binding tokens to the clients they were issued to, and providing proof of that binding in an HTTP header when making requests.<a href="#appendix-C-2.6.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-2.7">
          <p id="appendix-C-2.7.1"><span>[<a href="#RFC8705" class="cite xref">RFC8705</a>]</span>: Mutual TLS<a href="#appendix-C-2.7.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.7.2.1">
              <p id="appendix-C-2.7.2.1.1">Mutual TLS describes a mechanism of binding tokens to the clients they were issued to, as well as a client authentication mechanism, via TLS certificate authentication.<a href="#appendix-C-2.7.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-2.8">
          <p id="appendix-C-2.8.1"><span>[<a href="#RFC7662" class="cite xref">RFC7662</a>]</span>: Token Introspection<a href="#appendix-C-2.8.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.8.2.1">
              <p id="appendix-C-2.8.2.1.1">The Token Introspection extension defines a mechanism for resource servers to obtain information about access tokens.<a href="#appendix-C-2.8.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-2.9">
          <p id="appendix-C-2.9.1"><span>[<a href="#RFC7009" class="cite xref">RFC7009</a>]</span>: Token Revocation<a href="#appendix-C-2.9.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.9.2.1">
              <p id="appendix-C-2.9.2.1.1">The Token Revocation extension defines a mechanism for clients to indicate to the authorization server that an access token is no longer needed.<a href="#appendix-C-2.9.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-2.10">
          <p id="appendix-C-2.10.1"><span>[<a href="#RFC9126" class="cite xref">RFC9126</a>]</span>: Pushed Authorization Requests<a href="#appendix-C-2.10.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.10.2.1">
              <p id="appendix-C-2.10.2.1.1">The Pushed Authorization Requests extension describes a technique of initiating an OAuth flow from the back channel, providing better security and more flexibility for building complex authorization requests.<a href="#appendix-C-2.10.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-2.11">
          <p id="appendix-C-2.11.1"><span>[<a href="#RFC9207" class="cite xref">RFC9207</a>]</span>: Authorization Server Issuer Identification<a href="#appendix-C-2.11.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.11.2.1">
              <p id="appendix-C-2.11.2.1.1">The <code>iss</code> parameter in the authorization response indicates the identity of the authorization server to prevent mix-up attacks in the client.<a href="#appendix-C-2.11.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-2.12">
          <p id="appendix-C-2.12.1"><span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span>: Rich Authorization Requests<a href="#appendix-C-2.12.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.12.2.1">
              <p id="appendix-C-2.12.2.1.1">Rich Authorization Requests specifies a new parameter <code>authorization_details</code> that is used to carry fine-grained authorization data in the OAuth authorization request.<a href="#appendix-C-2.12.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ul>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-D">
      <h2 id="name-acknowledgements">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-D-1">This specification is the work of the OAuth Working Group, and its starting point was based on the contents of the following specifications: OAuth 2.0 Authorization Framework (RFC 6749), OAuth 2.0 for Native Apps (RFC 8252), OAuth Security Best Current Practice, and OAuth 2.0 for Browser-Based Apps. The editors would like to thank everyone involved in the creation of those specifications upon which this is built.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">The editors would also like to thank the following individuals for their ideas, feedback, corrections, and wording that helped shape this version of the specification: Vittorio Bertocci, Michael Jones, Justin Richer, Daniel Fett, Brian Campbell, Joseph Heenan, Roberto Polli, Andrii Deinega, Falko, Michael Peck, Bob Hamburg, Deng Chao, and Karsten Meyer zu Selhausen.<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<p id="appendix-D-3">Discussions around this specification have also occurred at the OAuth Security Workshop in 2021 and 2022. The authors thank the organizers of the workshop (Guido Schmitz, Steinar Noem, and Daniel Fett) for hosting an event that's conducive to collaboration and community input.<a href="#appendix-D-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-E">
      <h2 id="name-document-history">
<a href="#appendix-E" class="section-number selfRef">Appendix E. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-E-1">[[ To be removed from the final specification ]]<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<p id="appendix-E-2">-10<a href="#appendix-E-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-3.1">
          <p id="appendix-E-3.1.1">Clarify that the client id is an opaque string<a href="#appendix-E-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-3.2">
          <p id="appendix-E-3.2.1">Extensions may define additional error codes on a resource request<a href="#appendix-E-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-3.3">
          <p id="appendix-E-3.3.1">Improved formatting for error field definitions<a href="#appendix-E-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-3.4">
          <p id="appendix-E-3.4.1">Moved and expanded "scope" definition to introduction section<a href="#appendix-E-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-3.5">
          <p id="appendix-E-3.5.1">Split access token section into structure and request<a href="#appendix-E-3.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-3.6">
          <p id="appendix-E-3.6.1">Renamed b64token to token68 for consistency with RFC7235<a href="#appendix-E-3.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-3.7">
          <p id="appendix-E-3.7.1">Restored content from old appendix B about application/x-www-form-urlencoded<a href="#appendix-E-3.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-3.8">
          <p id="appendix-E-3.8.1">Clarified that clients must not parse access tokens<a href="#appendix-E-3.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-3.9">
          <p id="appendix-E-3.9.1">Expanded text around when <code>redirect_uri</code> parameter is required in the authorization request<a href="#appendix-E-3.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-3.10">
          <p id="appendix-E-3.10.1">Changed "permissions" to "privileges" in refresh token section for consistency<a href="#appendix-E-3.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-3.11">
          <p id="appendix-E-3.11.1">Consolidated authorization code flow security considerations<a href="#appendix-E-3.11.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-3.12">
          <p id="appendix-E-3.12.1">Clarified authorization code reuse - an authorization code can only obtain an access token once<a href="#appendix-E-3.12.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-E-4">-09<a href="#appendix-E-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-5.1">
          <p id="appendix-E-5.1.1">AS MUST NOT support CORS requests at authorization endpoint<a href="#appendix-E-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-5.2">
          <p id="appendix-E-5.2.1">more detail on asymmetric client authentication<a href="#appendix-E-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-5.3">
          <p id="appendix-E-5.3.1">sync CSRF description from security BCP<a href="#appendix-E-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-5.4">
          <p id="appendix-E-5.4.1">update and move sender-constrained access tokens section<a href="#appendix-E-5.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-5.5">
          <p id="appendix-E-5.5.1">sync client impersonating resource owner with security BCP<a href="#appendix-E-5.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-5.6">
          <p id="appendix-E-5.6.1">add reference to authorization request from redirect URI registration section<a href="#appendix-E-5.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-5.7">
          <p id="appendix-E-5.7.1">sync refresh rotation section from security BCP<a href="#appendix-E-5.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-5.8">
          <p id="appendix-E-5.8.1">sync redirect URI matching text from security BCP<a href="#appendix-E-5.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-5.9">
          <p id="appendix-E-5.9.1">updated references to RAR (RFC9396)<a href="#appendix-E-5.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-5.10">
          <p id="appendix-E-5.10.1">clarifications on URIs<a href="#appendix-E-5.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-5.11">
          <p id="appendix-E-5.11.1">removed redirect_uri from the token request<a href="#appendix-E-5.11.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-5.12">
          <p id="appendix-E-5.12.1">expanded security considerations around code_verifier<a href="#appendix-E-5.12.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-5.13">
          <p id="appendix-E-5.13.1">revised introduction section<a href="#appendix-E-5.13.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-E-6">-08<a href="#appendix-E-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-7.1">
          <p id="appendix-E-7.1.1">Updated acknowledgments<a href="#appendix-E-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-7.2">
          <p id="appendix-E-7.2.1">Swap "by a trusted party" with "by an outside party" in client ID definition<a href="#appendix-E-7.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-7.3">
          <p id="appendix-E-7.3.1">Replaced "verify the identity of the resource owner" with "authenticate"<a href="#appendix-E-7.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-7.4">
          <p id="appendix-E-7.4.1">Clarified refresh token rotation to match RFC6819<a href="#appendix-E-7.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-7.5">
          <p id="appendix-E-7.5.1">Added appendix to hold application/x-www-form-urlencoded examples<a href="#appendix-E-7.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-7.6">
          <p id="appendix-E-7.6.1">Fixed references to entries in appendix<a href="#appendix-E-7.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-7.7">
          <p id="appendix-E-7.7.1">Incorporated new "Phishing via AS" section from Security BCP<a href="#appendix-E-7.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-7.8">
          <p id="appendix-E-7.8.1">Rephrase description of the motivation for client authentication<a href="#appendix-E-7.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-7.9">
          <p id="appendix-E-7.9.1">Moved "scope" parameter in token request into specific grant types to match OAuth 2.0<a href="#appendix-E-7.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-7.10">
          <p id="appendix-E-7.10.1">Updated Clickjacking and Open Redirection description from the latest version of the Security BCP<a href="#appendix-E-7.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-7.11">
          <p id="appendix-E-7.11.1">Moved normative requirements out of authorization code security considerations section<a href="#appendix-E-7.11.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-7.12">
          <p id="appendix-E-7.12.1">Security considerations clarifications, and removed a duplicate section<a href="#appendix-E-7.12.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-E-8">-07<a href="#appendix-E-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-9.1">
          <p id="appendix-E-9.1.1">Removed "third party" from abstract<a href="#appendix-E-9.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-9.2">
          <p id="appendix-E-9.2.1">Added MFA and passwordless as additional motiviations in introduction<a href="#appendix-E-9.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-9.3">
          <p id="appendix-E-9.3.1">Mention PAR as one way redirect URI registration can happen<a href="#appendix-E-9.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-9.4">
          <p id="appendix-E-9.4.1">Added a reference to requiring CORS headers on the token endpoint<a href="#appendix-E-9.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-9.5">
          <p id="appendix-E-9.5.1">Updated reference to OMAP extension<a href="#appendix-E-9.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-9.6">
          <p id="appendix-E-9.6.1">Fixed numbering in sequence diagram<a href="#appendix-E-9.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-E-10">-06<a href="#appendix-E-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-11.1">
          <p id="appendix-E-11.1.1">Removed "credentialed client" term<a href="#appendix-E-11.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-11.2">
          <p id="appendix-E-11.2.1">Simplified definition of "confidential" and "public" clients<a href="#appendix-E-11.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-11.3">
          <p id="appendix-E-11.3.1">Incorporated the <code>iss</code> response parameter referencing RFC9207<a href="#appendix-E-11.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-11.4">
          <p id="appendix-E-11.4.1">Added section on access token validation by the RS<a href="#appendix-E-11.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-11.5">
          <p id="appendix-E-11.5.1">Removed requirement for authorization servers to support all 3 redirect methods for native apps<a href="#appendix-E-11.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-11.6">
          <p id="appendix-E-11.6.1">Fixes for some references<a href="#appendix-E-11.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-11.7">
          <p id="appendix-E-11.7.1">Updates HTTP references to RFC 9110<a href="#appendix-E-11.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-11.8">
          <p id="appendix-E-11.8.1">Clarifies "authorization grant" term<a href="#appendix-E-11.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-11.9">
          <p id="appendix-E-11.9.1">Clarifies client credential grant usage<a href="#appendix-E-11.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-11.10">
          <p id="appendix-E-11.10.1">Clean up authorization code diagram<a href="#appendix-E-11.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-11.11">
          <p id="appendix-E-11.11.1">Updated reference for application/x-www-form-urlencoded and removed outdated note about it not being in the IANA registry<a href="#appendix-E-11.11.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-E-12">-05<a href="#appendix-E-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-13.1">
          <p id="appendix-E-13.1.1">Added a section about the removal of the implicit flow<a href="#appendix-E-13.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-13.2">
          <p id="appendix-E-13.2.1">Moved many normative requirements from security considerations into the appropriate inline sections<a href="#appendix-E-13.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-13.3">
          <p id="appendix-E-13.3.1">Reorganized and consolidated TLS language<a href="#appendix-E-13.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-13.4">
          <p id="appendix-E-13.4.1">Require TLS on redirect URIs except for localhost/custom URL scheme<a href="#appendix-E-13.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-13.5">
          <p id="appendix-E-13.5.1">Updated refresh token guidance to match security BCP<a href="#appendix-E-13.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-E-14">-04<a href="#appendix-E-14" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-15.1">
          <p id="appendix-E-15.1.1">Added explicit mention of not sending access tokens in URI query strings<a href="#appendix-E-15.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-15.2">
          <p id="appendix-E-15.2.1">Clarifications on definition of client types<a href="#appendix-E-15.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-15.3">
          <p id="appendix-E-15.3.1">Consolidated text around loopback vs localhost<a href="#appendix-E-15.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-15.4">
          <p id="appendix-E-15.4.1">Editorial clarifications throughout the document<a href="#appendix-E-15.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-E-16">-03<a href="#appendix-E-16" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-17.1">
          <p id="appendix-E-17.1.1">refactoring to collect all the grant types under the same top-level header in section 4<a href="#appendix-E-17.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-17.2">
          <p id="appendix-E-17.2.1">Better split normative and security consideration text into the appropriate places, both moving text that was really security considerations out of the main part of the document, as well as pulling normative requirements from the security considerations sections into the appropriate part of the main document<a href="#appendix-E-17.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-17.3">
          <p id="appendix-E-17.3.1">Incorporated many of the published errata on RFC6749<a href="#appendix-E-17.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-17.4">
          <p id="appendix-E-17.4.1">Updated references to various RFCs<a href="#appendix-E-17.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-17.5">
          <p id="appendix-E-17.5.1">Editorial clarifications throughout the document<a href="#appendix-E-17.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-E-18">-02<a href="#appendix-E-18" class="pilcrow">¶</a></p>
<p id="appendix-E-19">-01<a href="#appendix-E-19" class="pilcrow">¶</a></p>
<p id="appendix-E-20">-00<a href="#appendix-E-20" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-21.1">
          <p id="appendix-E-21.1.1">initial revision<a href="#appendix-E-21.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dick Hardt</span></div>
<div dir="auto" class="left"><span class="org">Hellō</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dick.hardt@gmail.com" class="email">dick.hardt@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Aaron Parecki</span></div>
<div dir="auto" class="left"><span class="org">Okta</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:aaron@parecki.com" class="email">aaron@parecki.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://aaronparecki.com" class="url">https://aaronparecki.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Torsten Lodderstedt</span></div>
<div dir="auto" class="left"><span class="org">yes.com</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:torsten@lodderstedt.net" class="email">torsten@lodderstedt.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
